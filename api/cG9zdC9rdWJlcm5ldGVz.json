{"title":"在windows上创建kubernetes集群","date":"2019-05-22T08:59:56.000Z","slug":"kubernetes","tags":["hyperV, minikube, kubernetes, windows10"],"updated":"2019-06-05T03:36:11.577Z","content":"<h1 id=\"环境\">环境<a href=\"post/kubernetes#环境\"></a></h1><blockquote>\n<p>Windows 10 Pro 1903<br><a href=\"https://github.com/kubernetes/minikube\" target=\"_blank\" rel=\"noopener\">Minikube</a><br>代理环境（127.0.0.1:1080）</p>\n</blockquote>\n<h1 id=\"准备工作\">准备工作<a href=\"post/kubernetes#准备工作\"></a></h1><h2 id=\"下载minikube\">下载minikube<a href=\"post/kubernetes#下载minikube\"></a></h2><p><a href=\"https://github.com/kubernetes/minikube/releases/tag/v1.1.0\" target=\"_blank\" rel=\"noopener\">Release</a><br>下载最新的版本，保存到F:\\k8s文件夹中，并重命名为<code>mikikube</code></p>\n<p>在小娜哪里搜索env，选择<code>编辑系统环境变量</code>,在path节点中增加<code>F:\\k8s</code>；增加新的环境变量<code>MINIKUBE_HOME</code>值为<code>F:\\\\k8s</code>(注意是双斜杠)</p>\n<p>打开命令提示行，推荐<a href=\"https://github.com/microsoft/terminal\" target=\"_blank\" rel=\"noopener\">terminal</a></p>\n<p>对minikube进行配置:</p>\n<p>使用hyperv创建<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">minikube config <span class=\"built_in\">set</span> vm-driver hyperv</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>如果使用linux真机可以指定vm-driver为none，这样就不需要配置交换机</li>\n</ul>\n<p>hyperV的交换机<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">minikube config <span class=\"built_in\">set</span> hyperv-virtual-switch <span class=\"string\">\"Default Switch\"</span></span><br></pre></td></tr></table></figure></p>\n<p> 有空格需要用双引号包起来</p>\n<h2 id=\"创建集群\">创建集群<a href=\"post/kubernetes#创建集群\"></a></h2><p>开始创建集群</p>\n <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">minikube start --profile k8s-master --image-mirror-country cn --memory 1024 --cpus 2 --registry-mirror https://*******.mirror.aliyuncs.com</span><br></pre></td></tr></table></figure>\n<p> 带参数–image-mirror-country cn，设置成cn就贴心的将镜像拉取送google改到了杭州aliyun<br> –registry-mirror的镜像地址则会直接给docker</p>\n<p> 可能会失败好几遍，每次失败就<figure class=\"highlight plain\"><figcaption><span>delete```然后重新创建就可以了</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> </span><br><span class=\"line\"> 最后成功内容如下</span><br><span class=\"line\"> </span><br><span class=\"line\"> ```bash</span><br><span class=\"line\"> * minikube v1.1.0 on windows (amd64)</span><br><span class=\"line\">* checking main repository and mirrors for images</span><br><span class=\"line\">* using image repository registry.cn-hangzhou.aliyuncs.com/google_containers</span><br><span class=\"line\">* Creating hyperv VM (CPUs=2, Memory=2048MB, Disk=20000MB) ...</span><br><span class=\"line\">* Configuring environment for Kubernetes v1.14.2 on Docker 18.09.6</span><br><span class=\"line\">* Pulling images ...</span><br><span class=\"line\">* Launching Kubernetes ...</span><br><span class=\"line\">* Verifying: apiserver proxy etcd scheduler controller dns</span><br><span class=\"line\">* Done! kubectl is now configured to use &quot;minikube&quot;</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"控制台\">控制台<a href=\"post/kubernetes#控制台\"></a></h1> <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">minikube dashboard</span><br></pre></td></tr></table></figure>\n","prev":{"title":"k8s的环境搭建","slug":"kubernetes-for-debian"},"next":{"title":"canpian-11","slug":"canpian-11"},"link":"http://ojdev.github.io/post/kubernetes/","toc":[{"title":"环境","id":"环境","index":"1"},{"title":"准备工作","id":"准备工作","index":"2","children":[{"title":"下载minikube","id":"下载minikube","index":"2.1"},{"title":"创建集群","id":"创建集群","index":"2.2"}]},{"title":"控制台","id":"控制台","index":"3"}]}