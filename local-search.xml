<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>我常用的工具</title>
    <link href="/2021/12/30/tools.html"/>
    <url>/2021/12/30/tools.html</url>
    
    <content type="html"><![CDATA[<p><code>更新日期：2021-12-30 15:35:02</code></p><h1 id="项目管理"><a href="#项目管理" class="headerlink" title="项目管理"></a>项目管理</h1><h1 id="Azure-DevOps"><a href="#Azure-DevOps" class="headerlink" title="Azure DevOps"></a>Azure DevOps</h1><p><a href="https://docs.microsoft.com/zh-cn/azure/devops/?view=azure-devops">Azure DevOps 文档</a></p><h1 id="Net开发"><a href="#Net开发" class="headerlink" title=".Net开发"></a>.Net开发</h1><h2 id="设计模式"><a href="#设计模式" class="headerlink" title="设计模式"></a>设计模式</h2><p><a href="https://docs.microsoft.com/zh-cn/dotnet/architecture/microservices/">.NET 微服务：适用于容器化 .NET 应用程序的体系结构</a></p><p><a href="https://docs.microsoft.com/zh-cn/azure/architecture/patterns/cqrs">CQRS 模式是什么？</a></p><p><a href="https://docs.microsoft.com/zh-cn/dotnet/architecture/microservices/microservice-ddd-cqrs-patterns/">使用 DDD 和 CQRS 模式降低微服务中的业务复杂性</a></p><p><a href="https://github.com/dotnet-architecture/eShopOnContainers">微软的微服务架构示例</a></p><p><a href="https://docs.microsoft.com/zh-cn/azure/architecture/microservices/">微软微服务体系</a></p><p><a href="https://docs.microsoft.com/zh-cn/dotnet/architecture/microservices/microservice-ddd-cqrs-patterns/microservice-application-layer-web-api-design">设计微服务应用层和 Web API</a></p><p><a href="https://docs.microsoft.com/zh-cn/dotnet/architecture/microservices/microservice-ddd-cqrs-patterns/microservice-application-layer-implementation-web-api">使用 Web API 实现微服务应用层</a></p><p><a href="https://docs.microsoft.com/zh-cn/azure/architecture/guide/architecture-styles/event-driven">事件驱动的架构样式</a></p><p><a href="https://docs.microsoft.com/zh-cn/dotnet/architecture/microservices/microservice-ddd-cqrs-patterns/domain-events-design-implementation">域事件：设计和实现</a></p><p><a href="https://docs.microsoft.com/zh-cn/adaptive-cards/">自适应卡片</a></p><p><a href="https://adaptivecards.io/designer/">自适应卡片设计器</a></p><p><a href="https://www.infoq.cn/article/g6bk78djx_wukxps0kxm">当 DDD 遇上 DCI（Data, Context, Interactive）架构模式</a></p><h2 id="net-core-开发"><a href="#net-core-开发" class="headerlink" title=".net core 开发"></a>.net core 开发</h2><p><a href="https://docs.hangfire.io/en/latest/index.html">hangfire</a></p><p><a href="https://identityserver4.readthedocs.io/en/latest/">identityserver4</a></p><p><a href="https://github.com/jbogard/MediatR/wiki">MediatR</a></p><p><a href="https://www.elastic.co/guide/en/elasticsearch/client/net-api/6.x/index.html">ElasticSearch.net API</a></p><p><a href="https://www.rabbitmq.com/dotnet.html">Rabbitmq.Net API</a></p><p><a href="https://docs.automapper.org/en/stable/Getting-started.html">AutoMapper</a></p><p><a href="https://ocelot.readthedocs.io/en/latest/introduction/gettingstarted.html">Ocelot</a></p><p><a href="https://miniprofiler.com/">miniprofiler</a></p><p><a href="https://docs.microsoft.com/zh-cn/aspnet/core/fundamentals/host/hosted-services?view=aspnetcore-6.0&viewFallbackFrom=aspnetcore-2.1&tabs=visual-studio#queued-background-tasks">在 ASP.NET Core 中使用托管服务实现后台任务</a></p><p><a href="https://docs.microsoft.com/zh-cn/dotnet/standard/collections/thread-safe/how-to-create-an-object-pool">使用 ConcurrentBag 创建目标池</a></p><h2 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h2><p><a href="https://help.aliyun.com/document_detail/99880.html">链路追踪</a></p><p><a href="https://docs.docker.com/get-started/">Docker</a></p><p><a href="https://kubernetes.io/zh/docs/home/">K8s</a></p><p><a href="https://git-scm.com/book/zh/v2/%E8%B5%B7%E6%AD%A5-%E5%85%B3%E4%BA%8E%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6">git-scm</a></p><p><a href="https://docs.microsoft.com/zh-cn/azure/devops/repos/git/gitworkflow?view=azure-devops">Azure Repos Git 教程</a></p><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p><a href="https://benchmarkdotnet.org/">性能测试</a></p><p><a href="https://xunit.net/">xUnit单元测试</a></p><p><a href="https://www.cnblogs.com/selimsong/p/9306221.html">xUnit单元测试案例</a></p><p><a href="https://github.com/Moq/moq4/wiki/Quickstart">Moq</a></p><p><a href="https://github.com/MisterJames/GenFu">GenFu模拟数据生成</a></p><p><a href="https://playwright.dev/dotnet/docs/intro">微软开源的Web测试和自动化</a></p><h1 id="Visual-Code-插件"><a href="#Visual-Code-插件" class="headerlink" title="Visual Code 插件"></a>Visual Code 插件</h1><h2 id="Markmap"><a href="#Markmap" class="headerlink" title="Markmap"></a>Markmap</h2><p><a href="https://marketplace.visualstudio.com/items?itemName=gera2ld.markmap-vscode">Markmap</a></p><p><a href="https://github.com/gera2ld/markmap-vscode">markmap-vscode</a> 是一个将Markdown转换为思维导图的工具。</p><h1 id="设计工具"><a href="#设计工具" class="headerlink" title="设计工具"></a>设计工具</h1><h2 id="slidev-用markdown做ppt"><a href="#slidev-用markdown做ppt" class="headerlink" title="slidev 用markdown做ppt"></a>slidev 用markdown做ppt</h2><p><a href="https://sli.dev/">slidev</a></p><h2 id="mingrammer-com"><a href="#mingrammer-com" class="headerlink" title="mingrammer.com"></a>mingrammer.com</h2><p><a href="https://github.com/mingrammer/diagrams">https://github.com/mingrammer/diagrams</a></p><p>在Python代码中绘制云系统架构图。用来对新的系统架构设计进行原型设计或者描述现有的系统体系结构。</p><h1 id="机器学习"><a href="#机器学习" class="headerlink" title="机器学习"></a>机器学习</h1><p><a href="https://docs.microsoft.com/zh-cn/dotnet/machine-learning/tutorials/">Microsoft ML.NET 教程</a></p><h1 id="游戏-amp-媒体"><a href="#游戏-amp-媒体" class="headerlink" title="游戏&amp;媒体"></a>游戏&amp;媒体</h1><p><a href="https://dos.zczc.cz/">在线DOS游戏</a></p><p><a href="https://github.com/nilaoda/BBDown">一款命令行式哔哩哔哩下载器</a></p><p><a href="https://github.com/xingshaocheng/architect-awesome">后端架构师技术图谱</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>开发日常</title>
    <link href="/2021/10/16/DevelopmentDaily.html"/>
    <url>/2021/10/16/DevelopmentDaily.html</url>
    
    <content type="html"><![CDATA[<p>业务方，产品，开发的互相认知总是不一样的。</p><p>0月15日 周一<br>开发：有需求可以提前说，这样能提前准备开发这边的排期。<br>产品：好的<br>0月19日 周五<br>产品：这个需求业务方已经提了两个月了，今天来催了，问怎么还没上线。<br>开发：开需求会了吗？<br>产品：今天下午开，这周要上线的。<br>……需求评审中……<br>预计工时40个小时，开发只有一个人可供排期</p><p>0月22日 周一<br>产品X：业务方需求提了两个月了，怎么还没上线，你们开发为什么没有产出？</p><hr><p>产品：这个很着急，业务方提了三个月了，天天问什么时候上线<br>开发：什么时候能评需求<br>产品：下周吧，下周能做完吧？<br>开发：下周不是才评需求吗？<br>产品：嗯下周评完就能做吧。<br>开发：嗯，评完就可以开工了。<br>产品To总监：下周上线</p><p>第二周周四评审<br>产品：这次的改动比较大，之前业务方验收后上线了，但是他们用了几天感觉不想要这样了，所以这次整个改一下，改动不大，就是几个调整<br>开发：涉及到哪些？<br>产品：涉及到业务线1里的一部分，和业务线2里的一部分，还有业务线3和4里的一部分，主要是修改业务线5，然后加了一个业务线6，顺便把业务线7里的数据在业务线1234里都展示一下，历史数据也要处理，并且这次的修改只针对A公司，其他的公司不能看到这些变更，很简单，就是针对A公司进行一下定制。<br>开发：业务方的预期上线时间是什么时候？<br>产品：最晚下周一。<br>开发：现在开发这边全占满了，没有人能现在处理。<br>产品：但是xxx说了，这个是这周必须要的。</p><hr><p>产品：帮我拉个数据<br>业务方：帮我拉个数据<br>产品：帮我来个数据，之前的那个就行，再加两个字段<br>业务方：帮我拉个数据，我要这个，这个，这个，这个，还有这个，给我放到一张表里，<br>    开发：这列数据我们没有，公司没给我们<br>    业务方：但是我们需要这个啊<br>    开发：你们可以提供给我们，然后我们给你放进去<br>    业务方：不行，这列数据挺敏感的不能给你们</p><hr><p>09:30<br>业务方：给我改个数据<br>开发：这个数据改完后会导致统计不准的<br>业务方：为啥？<br>开发：报表是已经出来的了，那部分是不能动的，XXX老师要看的。<br>业务方：哦，知道了，没问题，改吧。</p><p>10:00<br>业务方ToXXX老师：咱们开发的系统报表根本不能用，数据都对不上。</p><hr><p>XXX：我是xxx门店的，我有个合同的收款数填错了要改一下<br>开发：谁让你找我们改的？<br>XXX：你们不是后台吗？<br>开发：我们是开发，不是后台，有问题找你的中心总<br>XXX：哦，好。</p><p>XXXToXXX老师：咱们开发的系统不能用，填的数据都不对。</p><hr><p>中午<br>产品：我这有个表，你看一下咱们这上面的东西都有什么<br>开发：这个是要做什么的<br>产品：xxx那边要接数据，看一下咱们有什么，他们有什么对一下。<br>开发：好</p><p>下午<br>产品1：数据对接好了吗？能接过来吗？<br>开发：解释中……<br>产品1：这个公司那边很着急，已经两个月了，天天提，昨天有把我们骂了一顿问为什么还没接。<br>开发：是啊，为啥这么久了还没接啊？这块的产品谁跟的啊<br>产品1：这块是我跟的<br>开发：需求和设计呢？<br>产品1：这块还没出来呢，这个什么时候能接进来？<br>开发：我要直接接什么啊<br>产品1：我知道，这块的需求设计还没出来的，但是咱们什么时候能上线？<br>开发：我要看到具体需求后才能知道要做什么啊，数据能接，但是接到什么场景下我要知道啊。<br>产品1：那行我知道了<br>5分钟后<br>产品2：xxx那边的数据为啥接不了？<br>开发：谁说接不了？<br>产品2：刚才不是说接不了吗？<br>开发：没有啊，我说的是我要看到具体需求后才能知道要做什么啊，数据能接，但是接到什么场景下我要知道啊。<br>产品2：那我知道了<br>5分钟后<br>产品领导：xxx的数据为啥接不了，公司那边很着急，接不了你要给个理由啊。<br>开发：我没说接不了啊，我说的是我要看到具体需求后才能知道要做什么啊，数据能接，但是接到什么场景下我要知道啊。<br>产品领导：那这周能上吗？<br>开发：不一定，抓紧给我需求让我知道往哪接，接了后要干什么<br>产品领导：行，那我知道了<br>5分钟后<br>开发领导：xxx的数据怎么接不了？有什么问题吗？<br>开发：没需求<br>开发领导：需求不是早定了吗？<br>开发：刚才说还没出来呢。<br>开发领导：那你知道要做什么吗？<br>开发：产品也没说，就让我看了下能接哪些数据，也没说接到哪也没说接了要做什么。<br>开发领导：……</p><hr><p>假期中<br>业务方A：给我拉个数据<br>开发：我不在家，晚上才能回去，回去给你拉<br>业务方A：大概什么时候能回来？很着急<br>开发：不一定，我在外面很远<br>业务方A：那好<br>5分钟后<br>产品：给我拉个数据<br>开发：你这个怎么和业务方A要的一样，我在外面，晚上才能回去。<br>产品：就是那个<br>开发：他刚给我打的电话，我在外面，晚上才能回去<br>产品：……<br>5分钟后<br>产品领导：xxx给业务方A拉个数据<br>开发：我不在家，晚上才能回去<br>5分钟后<br>开发领导：业务方A要的啥<br>开发：解释数据<br>开发领导：你现在给拉一下<br>开发：我不在家，晚上才能回去，你也可以给他拉一下。<br>下午5点<br>业务方A：你什么时候回来<br>开发：如果快的话9点左右吧<br>5分钟后<br>产品：业务方A的数据给他拉了吗<br>开发：我还没到呢<br>开发：开发领导，你先帮他拉一下<br>开发领导：<br>9点半<br>开发：业务方A，我到了，给你数据。</p><hr><p>产品：我找你确认个事，就是咱们的业务1不满足A公司的需求，他们很多数据不填，要把这个地方改一下，可以吗？<br>开发：这个不行，咱们主打的就是数据真实性，这么模糊的填写，连买的东西是什么都看不出来，没法作业啊，而且，A公司的他们一共才10几个人，总不能为了这10几个人，让其他6000多人不用作业啊。<br>产品：他们这个数据拿不到，虽然有能拿到的，但是你只要把这个地方的限制去掉，然后把这4项删除，然后他们没有这两项，其他的都没变，业务1里的业务点1和3和4都不变，还有业务2里的2，3，5，6，7的能力放进来，然后再把数据源上加一个限制就行了，并且，业务1的后续关联的业务4业务5业务6业务7也这个也都要，但就是里面的内容跟这些不一样。<br>开发：不行，这个限制会导致业务1和业务2都不能用的，你这样的话是一个独立的业务，而且你这个定义和内容完全跟这两块业务没关系啊，完全就是个新业务，就按照新功能设计，这样能做到数据隔离，不影响现在的作业系统，而且开发周期也会快。<br>产品：哦，那我明白了，我去设计一个新的产品。<br>一周后<br>产品：我找你确认个事，我不那么做了，【指页面中业务1，业务2，业务3的后面】我就在这加个选项卡好加吧？别的都不动。<br>开发：那好加，那你这个选项卡里放什么啊？<br>产品：就是那天说的那个，因为他们这个数据拿不到，有能拿到的，但是你只要把业务1这个地方的限制去掉，然后把这4项删除，然后他们没有这两项，其他的我都不变，业务1里的业务点1和3和4都不变，我还要，还有业务2里的2，3，5，6，7的能力放进来，然后再把数据源上加一个限制就行了,限制不加也行，虽然他们现在也是这么用的，并且，业务1的后续关联的业务4业务5业务6业务7也这个也都要，但就是里面的内容跟这些不一样，这样是不是就简单了？<br>开发：那你这个东西放哪呢？<br>产品：就放这个啊，你再加个选项卡就行了，很简单的。<br>开发：对，但是你这不还是一个新的业务吗，跟业务1和业务2都不一样。<br>产品：对，但是我就要个选项卡给它放这就行了。<br>开发：你没明白，你这个选项卡叫什么，它不在业务1里，也不在业务2里，并且跟这俩的内容和限制条件也不一样，后续的流程也不不一样，我总要有个操作和数据存放的地方吧？<br>产品：你说底层实现啊<br>开发：就算不说底层的，你这个地方和其他的哪都不挨着，既不是业务1也不是业务2啊<br>产品：我以为放个选项卡就行了呢，你的意思还是要设计一套新的是吧。<br>开发：对啊，在不影响我业务1和业务2的使用的情况下，无法兼容你的这套东西，所以这肯定是一个新的产品。<br>产品：啊，这样啊，你这么说我就明白了。</p><p>开发2：这个产品不是带着设计聘过来的吗？<br>开发：设计呢？</p><hr><p>开发1：国内有哪个岛适合养老<br>开发2：我想回家放羊</p>]]></content>
    
    
    
    <tags>
      
      <tag>开发</tag>
      
      <tag>日常</tag>
      
      <tag>产品</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>给Hexo Theme Fluid 主题增加相册功能</title>
    <link href="/2021/08/01/Hexo-Theme-Fluid-Add-Gallery.html"/>
    <url>/2021/08/01/Hexo-Theme-Fluid-Add-Gallery.html</url>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>Fluid主题中与图集功能，但是直接用来做相册效果并不大好，不知道是不是我的用法的问题，使用了图集的相册页面fancybox会失效，但是hexo也没有相册插件，很多都是直接的相册主题，当然，主打轻盈的hexo用来做相册，也许违背了它的初衷。随后在Fluid的文档中发现了hexo 5的新功能，<a href="https://hexo.fluid-dev.com/posts/hexo-injector/">注入器</a></p><h1 id="注入器"><a href="#注入器" class="headerlink" title="注入器"></a>注入器</h1><p>Hexo 注入器是 Hexo 5 版本加入的一项新功能，注入器可以将静态代码片段注入生成的HTML 的 <head> 和 <body> 中。这部分不做过多的介绍了。</p><p>有了这个功能，便可以在不破坏原主题的情况下增加功能，而且以后即使更换主题也不受影响。</p><h2 id="scripts"><a href="#scripts" class="headerlink" title="scripts"></a>scripts</h2><p>在根目录下创建一个<code>scripts</code>文件夹，该文件夹与<code>source</code>和<code>themes</code>处于同一层级，然后在<code>scripts</code>目录下创建一个<code>injector.js</code>文件，其中编辑其内容为:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs javascript">hexo.extend.injector.register(<span class="hljs-string">&#x27;head_end&#x27;</span>, <br><span class="hljs-string">`</span><br><span class="hljs-string">&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css&quot;&gt;</span><br><span class="hljs-string">&lt;link rel=&quot;stylesheet&quot; href=&quot;/assets/justifiedGallery.min.css&quot; /&gt;</span><br><span class="hljs-string">`</span>,<br><span class="hljs-string">&#x27;gallery&#x27;</span>)<br>hexo.extend.injector.register(<span class="hljs-string">&#x27;body_end&#x27;</span>, <br><span class="hljs-string">`</span><br><span class="hljs-string">  &lt;script src=&quot;https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="hljs-string">  &lt;script src=&quot;/assets/jquery.justifiedGallery.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="hljs-string">  &lt;script src=&quot;/assets/gallery.js&quot;&gt;&lt;/script&gt;</span><br><span class="hljs-string">`</span>,<br><span class="hljs-string">&#x27;gallery&#x27;</span>)<br></code></pre></td></tr></table></figure><p>这里的<code>/assets/</code>路径是我在<code>source</code>文件夹下创建的，里面用来放一些css文件和js文件。</p><p>最后一个参数<code>&#39;gallery&#39;</code>表示的是用在那个布局下，可以任意写，这个布局体现在<code>index.md</code>中的<code>layout:</code>,例如:</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs markdown">---<br>title: 相册<br>date: 2021-07-29 15:52:59<br><span class="hljs-section">layout: gallery</span><br><span class="hljs-section">---</span><br></code></pre></td></tr></table></figure><p>这段代码的意思是在<code>&lt;/head&gt;</code>前面插入两个css文件的引用和在<code>&lt;/body&gt;</code>前面插入三个js文件的引用，其中<a href="https://miromannino.github.io/Justified-Gallery/">justifiedGallery</a>是自动生成瀑布流的插件，下载下来后都放到<code>/source/assets</code>下，接下来编辑<code>gallery.js</code></p><h2 id="gallery-js"><a href="#gallery-js" class="headerlink" title="gallery.js"></a>gallery.js</h2><p>理想状态是自动读取目录下的图片，然后生成相册，后来发现那样有些麻烦，我的风格就是用最简单的方式快捷实现需求并且容易维护，所以采用了一些常见的使用json的方式来实现，这个文件中就是找到主题中的<code>&lt;article class=&quot;page-content&quot;&gt;</code>部分，然后使用js插入从json中读出来的照片，输出成a标签和图片表情，并支持fancybox图集的形式，然后调用前面引用的<code>justifiedGallery</code>来生成瀑布流。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs javascript">(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>    el = $(<span class="hljs-string">&quot;article.page-content&quot;</span>);<br>    <span class="hljs-keyword">if</span> (el !== <span class="hljs-literal">undefined</span>) &#123;<br>        el.innerHTML = <span class="hljs-string">&#x27;&#x27;</span>;<br>        fetch(<span class="hljs-string">&#x27;data.json&#x27;</span>)<br>            .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.json())<br>            .then(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> &#123;<br>                galleryContent = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&quot;div&quot;</span>);<br>                galleryContent.id = <span class="hljs-string">&quot;gallery-content&quot;</span>;<br>                galleryContent.class = <span class="hljs-string">&quot;justified-gallery&quot;</span>;<br>                <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">renderGallery</span>(<span class="hljs-params">node</span>) </span>&#123;<br>                    <span class="hljs-keyword">if</span> (node.contents !== <span class="hljs-literal">undefined</span> &amp;&amp; node.contents.length &gt; <span class="hljs-number">0</span>) &#123;<br>                        node.contents.forEach(<span class="hljs-function"><span class="hljs-params">sd</span> =&gt;</span> &#123;<br>                            imgUrl = node.name + <span class="hljs-string">&#x27;/&#x27;</span> + sd.name;<br>                            imgThumbUrl = node.name + <span class="hljs-string">&#x27;/thumbnails/thumb_&#x27;</span> + sd.name;<br>                            galleryContent.innerHTML += <span class="hljs-string">`</span><br><span class="hljs-string">                                &lt;a  href=&quot;`</span>+ imgUrl + <span class="hljs-string">`&quot; data-fancybox=&quot;images&quot;&gt;</span><br><span class="hljs-string">                                    &lt;img src=&quot;`</span>+ imgThumbUrl + <span class="hljs-string">`&quot;&gt;</span><br><span class="hljs-string">                                &lt;/a&gt;</span><br><span class="hljs-string">                            `</span>;<br>                        &#125;);<br>                    &#125;<br>                &#125;<br>                data.forEach(<span class="hljs-function"><span class="hljs-params">d</span> =&gt;</span> renderGallery(d) );<br>                el.append(galleryContent);<br>                $(<span class="hljs-string">&#x27;#gallery-content&#x27;</span>).justifiedGallery(&#123; <span class="hljs-attr">rowHeight</span>: <span class="hljs-number">150</span>, <span class="hljs-attr">margins</span>: <span class="hljs-number">5</span> &#125;);<br>            &#125;);<br>    &#125;<br>&#125;)();<br><br><br></code></pre></td></tr></table></figure><h1 id="相册的用法"><a href="#相册的用法" class="headerlink" title="相册的用法"></a>相册的用法</h1><h2 id="创建相册页面"><a href="#创建相册页面" class="headerlink" title="创建相册页面"></a>创建相册页面</h2><p>上面的准备工作基本上就做完了，接下来就是使用了，我们先创建一个<code>hexo new page gallery</code>,然后手动增加一行<code>layout: gallery</code>就是下面这个样子。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs markdown">---<br>title: 相册<br>date: 2021-07-29 15:52:59<br><span class="hljs-section">layout: gallery</span><br><span class="hljs-section">---</span><br></code></pre></td></tr></table></figure><h2 id="添加相册缩略图"><a href="#添加相册缩略图" class="headerlink" title="添加相册缩略图"></a>添加相册缩略图</h2><p>然后我们在gallery下创建一个文件夹比如<code>harbin</code>然后将我们分类的照片都放进去，因为我使用的是github，而且，照片都是原图，一个页面中直接显示会特别的慢，于是我就自己创建缩略图，这是需要用到<code>apt install imagemagick</code>，然后再<code>harbin</code>文件夹中创建一个文件<code>convert_thumb.sh</code>填入如下内容：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span><br>for i in *.jpg<br>do<br>    echo &quot;生成缩略图 $i ...&quot;<br>    convert -thumbnail 480 $i ./thumbnails/thumb_$i<br>done<br></code></pre></td></tr></table></figure><p>每当harbin中新增图片的时候就执行一下它，就自动在<code>thumbnails</code>下创建了<code>thumb_</code>开头的缩略图了。</p><h2 id="生成data-json"><a href="#生成data-json" class="headerlink" title="生成data.json"></a>生成data.json</h2><p>我想到了<code>tree</code>正好新版本的有<code>tree -J</code> 可以直接生成<code>data.json</code>,在<code>gallery</code>文件夹下执行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">tree 图片文件夹/ -I &#x27;*.sh&#x27; -J &gt; data.json<br></code></pre></td></tr></table></figure><p>我们得到了data.json文件，还需要稍微编辑一下，其实也可以直接用的，作为那种分类相册，我这里就直接编辑成单个相册的，所以去掉外层的没用信息，去掉非图片的内容，想下面这样的结构：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json">[<br>  &#123;<br>    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;directory&quot;</span>,<br>    <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;harbin&quot;</span>,<br>    <span class="hljs-attr">&quot;contents&quot;</span>: [<br>      ...<br>    ]<br>  &#125;<br>]<br></code></pre></td></tr></table></figure><p>我还去掉了缩略图文件的部分，因为也用不上。</p><h1 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h1><p>至此，发布后就可以使用了，默认展示瀑布流是用的缩略图，单击打开的fancybox使用的是原图，注入器这样还可以有更多的玩法的，并且，由于懒的原因，我也没有更加的细化，以后可能会将这个改造单页面中的分类相册的形式。</p>]]></content>
    
    
    
    <tags>
      
      <tag>Hexo</tag>
      
      <tag>主题</tag>
      
      <tag>相册</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>powershell7的美化</title>
    <link href="/2021/05/28/powershell7%E7%9A%84%E7%BE%8E%E5%8C%96.html"/>
    <url>/2021/05/28/powershell7%E7%9A%84%E7%BE%8E%E5%8C%96.html</url>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p><code>Powershell</code>已经升级到7了，目前看上去很好用了，<code>windows10</code>到今天已经原生支持了<code>openssh</code>，而且，很多的linux中的命令也可以直接在<code>powershell</code>中使用，这样免去了我单独安装子系统的的情况，<code>wsl2</code>不知道为什么，在我家的电脑上会出现丢失系统的问题，这就导致了我维护集群的配置文件和kubeconfig丢失的问题，后来想到，反正有堡垒机，不如都放上去，使用<code>windows terminal</code>直接将选项卡配置成ssh，自动登录也就都解决了，但是不可否认的是，<code>powershell</code>虽然不是太好用，但是比命令提示行强大是肯定的，无非就是一个习惯的问题，坚持了几天，也就习惯了，但是丑是没办法的，所以有了这个美化过程，很容易的。</p><h1 id="安装Powershell-7"><a href="#安装Powershell-7" class="headerlink" title="安装Powershell 7"></a>安装Powershell 7</h1><p><a href="https://github.com/PowerShell/PowerShell">Powershell7 Github</a> 根据自己的喜好进行选择，我选择了msi的安装包，大概在14还是15年的时候接触过<a href="https://chocolatey.org/">Chocolatey</a>，当时角色终于在windows上也有程序包管理器了，但结果是，不好用，后来也没在关注过，这两年发现很多的地方都在推荐，其实可以尝试以下。</p><h1 id="开始美化"><a href="#开始美化" class="headerlink" title="开始美化"></a>开始美化</h1><p>一般来讲，操作步骤大同小异，我写这一篇也是因为换了新的电脑后找不到步骤了，有一个步骤一直报错，但是还想不起来怎么处理了，所以查找后找到了，也就顺手记录一下。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">set-executionpolicy</span> remotesigned<br><span class="hljs-built_in">Install-Module</span> posh<span class="hljs-literal">-git</span> <span class="hljs-literal">-Scope</span> CurrentUser<br><span class="hljs-built_in">Install-Module</span> <span class="hljs-built_in">oh</span><span class="hljs-literal">-my</span><span class="hljs-literal">-posh</span> <span class="hljs-literal">-Scope</span> CurrentUser<br><span class="hljs-built_in">Install-Module</span> <span class="hljs-literal">-Name</span> PSReadLine <span class="hljs-literal">-Scope</span> CurrentUser <span class="hljs-literal">-Force</span> <span class="hljs-literal">-SkipPublisherCheck</span> <span class="hljs-comment"># 这个是自动提示的，看个人选择，一般用不上，因为自动提示后面总是会带上.exe扩展名，并且会在后面自动加一个空格，总是，我觉得不好用</span><br></code></pre></td></tr></table></figure><p>然后为了达到每次一次打开都是设置好的美化效果，所以需要把配置写道个人配置文件中</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-keyword">if</span> (!(<span class="hljs-built_in">Test-Path</span> <span class="hljs-literal">-Path</span> <span class="hljs-variable">$PROFILE</span> )) &#123; <span class="hljs-built_in">New-Item</span> <span class="hljs-literal">-Type</span> File <span class="hljs-literal">-Path</span> <span class="hljs-variable">$PROFILE</span> <span class="hljs-literal">-Force</span> &#125; notepad <span class="hljs-variable">$PROFILE</span><br></code></pre></td></tr></table></figure><p>执行后会打开一个记事本，将下面内容写入到记事本中保存。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs notepad">Install-Module posh-git<br>Install-Module oh-my-posh<br>Set-PoshPrompt Paradox<br></code></pre></td></tr></table></figure><p>查看所有配色方式的命令是<code>Get-PoshThemes</code></p><p>很多教程上将<code>Set-PoshPrompt Paradox</code>写成了<code>Set-Theme Paradox</code>，是因为老版本的是这么设置的，很多时候报错也是在这里。</p><p>如果不需要自动检查更新可以只写一样</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs notepad">Set-PoshPrompt Paradox<br></code></pre></td></tr></table></figure><p>这样，每次打开的时候会检查更新，就不会卡。</p><h1 id="设置字体"><a href="#设置字体" class="headerlink" title="设置字体"></a>设置字体</h1><p>上面的步骤就美化完成了，只不过看起来还是很难看，所以需要安装字体,根据<a href="https://ohmyposh.dev/docs/fonts">fonts</a>页面上的两种字体，自己选择一下就可以了，默认推荐的<code>MesloLGM NF</code>效果也不错，然后安装完字体后，默认的设置比较麻烦，所以我都是使用<code>terminal</code>的设置里找到<code>powershell</code>，然后外观中直接选字体。</p><p>在<code>terminal</code>的配置中，应该是这样的</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;fontFace&quot;</span>: <span class="hljs-string">&quot;MesloLGM NF&quot;</span>,<br>    <span class="hljs-attr">&quot;guid&quot;</span>: <span class="hljs-string">&quot;&#123;574e775e-4f2a-5b96-ac1e-a2962a402336&#125;&quot;</span>,<br>    <span class="hljs-attr">&quot;hidden&quot;</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;PowerShell&quot;</span>,<br>    <span class="hljs-attr">&quot;source&quot;</span>: <span class="hljs-string">&quot;Windows.Terminal.PowershellCore&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul><li><a href="https://ohmyposh.dev/docs/">ohmyposh</a></li><li><a href="https://ohmyposh.dev/docs/fonts">fonts</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>知识储备</category>
      
    </categories>
    
    
    <tags>
      
      <tag>pwsh</tag>
      
      <tag>powershell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>沈阳的生活开始了</title>
    <link href="/2021/05/26/%E6%B2%88%E9%98%B3%E7%9A%84%E7%94%9F%E6%B4%BB%E5%BC%80%E5%A7%8B%E4%BA%86.html"/>
    <url>/2021/05/26/%E6%B2%88%E9%98%B3%E7%9A%84%E7%94%9F%E6%B4%BB%E5%BC%80%E5%A7%8B%E4%BA%86.html</url>
    
    <content type="html"><![CDATA[<p>充分的体会到了什么叫落后，传统，思想陈旧，效率低下，异想天开。</p><p>先了解一下ENVI的用法，在了解Python的用法，然后再开展其他的，经过了四天，网线拉过来了。终于把电脑买回来了，显示器是借来的，还没买回来。</p><p>还好我的手机卡是无限流量的。</p><p>看起来，也不是个长远的打算。</p>]]></content>
    
    
    <categories>
      
      <category>收集</category>
      
    </categories>
    
    
    <tags>
      
      <tag>沈阳</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>关于在Windows中使用Terminal连接SSH登录远程机器中的docker容器中使用kubectl管理集群的那些事</title>
    <link href="/2021/01/13/%E5%9C%A8docker%E4%B8%AD%E4%BD%BF%E7%94%A8kubectl.html"/>
    <url>/2021/01/13/%E5%9C%A8docker%E4%B8%AD%E4%BD%BF%E7%94%A8kubectl.html</url>
    
    <content type="html"><![CDATA[<p>不知道为什么我的<code>Windows 10</code>安装了<code>wsl2</code>后，会莫名其妙的失踪，各种检查都没问题，我怀疑可能处在<code>软raid</code>的问题上，但是不的又不影响。但是这又影响到了我日常的工作，所以我就想，在<code>nas</code>上用<code>docker</code>部署一个<code>kubectl</code>，然后通过远程访问，这样不用在本地安装任何东西了。</p><p>经过将近一天的实验，终于搞定了，用W<code>indows Terminal</code>作为终端，远程通过<code>ssh</code>连接到<code>nas</code>运行<code>docker exec</code>进入容器的终端，中间经历了如何安装<code>bash-completion</code>的过程，最后几乎完美。</p><p>镜像选用<a href="https://hub.docker.com/_/bash">https://hub.docker.com/_/bash</a>,13.6MB十分小巧。</p><p><code>kubectl</code>直接<a href="https://kubernetes.io/zh/docs/tasks/tools/install-kubectl/">https://kubernetes.io/zh/docs/tasks/tools/install-kubectl/</a>下载到<code>nas</code>的一个路径中例如我放在了<code>/nas/opt/kubectl/</code>下面。</p><h1 id="docker-compose-yaml的内容"><a href="#docker-compose-yaml的内容" class="headerlink" title="docker-compose.yaml的内容"></a>docker-compose.yaml的内容</h1><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">version:</span> <span class="hljs-string">&quot;3.3&quot;</span><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">kubectltest:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">bash:5.1.4</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">kubectltest</span><br>    <span class="hljs-attr">user:</span> <span class="hljs-number">0</span><span class="hljs-string">:0</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">KUBECONFIG=/.kube/config</span><br>    <span class="hljs-attr">command:</span> [<span class="hljs-string">&quot;bash&quot;</span>, <span class="hljs-string">&quot;-c&quot;</span>, <span class="hljs-string">&quot;apk add bash-completion &amp;&amp; echo &#x27;source /usr/share/bash-completion/bash_completion&#x27;&gt; ~/.bashrc &amp;&amp; mkdir /etc/bash_completion.d &amp;&amp; kubectl completion bash &gt;/etc/bash_completion.d/kubectl &amp;&amp; tail -f /dev/null&quot;</span>]<br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/nas/opt/kubectl/config/test:/.kube</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/nas/opt/kubectl/kubectl:/usr/local/bin/kubectl</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">deploy:</span><br>      <span class="hljs-attr">resources:</span><br>        <span class="hljs-attr">limits:</span><br>          <span class="hljs-attr">cpus:</span> <span class="hljs-string">&#x27;0.1&#x27;</span><br>          <span class="hljs-attr">memory:</span> <span class="hljs-string">32M</span><br>  <span class="hljs-attr">kubectlpre:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">bash:5.1.4</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">kubectlpre</span><br>    <span class="hljs-attr">user:</span> <span class="hljs-number">0</span><span class="hljs-string">:0</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">KUBECONFIG=/.kube/config</span><br>    <span class="hljs-attr">command:</span> [<span class="hljs-string">&quot;bash&quot;</span>, <span class="hljs-string">&quot;-c&quot;</span>, <span class="hljs-string">&quot;apk add bash-completion &amp;&amp; echo &#x27;source /usr/share/bash-completion/bash_completion&#x27;&gt; ~/.bashrc &amp;&amp; mkdir /etc/bash_completion.d &amp;&amp; kubectl completion bash &gt;/etc/bash_completion.d/kubectl &amp;&amp; tail -f /dev/null&quot;</span>]<br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/nas/opt/kubectl/config/pre:/.kube</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/nas/opt/kubectl/kubectl:/usr/local/bin/kubectl</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">deploy:</span><br>      <span class="hljs-attr">resources:</span><br>        <span class="hljs-attr">limits:</span><br>          <span class="hljs-attr">cpus:</span> <span class="hljs-string">&#x27;0.1&#x27;</span><br>          <span class="hljs-attr">memory:</span> <span class="hljs-string">32M</span><br></code></pre></td></tr></table></figure><p><code>bash</code>的镜像里竟然直接带了<code>apk</code>的包管理器这是我没想到的，真的小巧灵活好用，上面command里:</p><ol><li>装bash-completion</li><li>把source /usr/share/bash-completion/bash_completion写入到 ~/.bashrc，每次登陆后就可以直接使用kubectl自动提示</li><li>创建目录 mkdir /etc/bash_completion.d 用来存放自动提示文件</li><li>kubectl completion bash &gt;/etc/bash_completion.d/kubectl 写入自动提示</li><li>tail -f /dev/null 保持容器运行</li></ol><p><code>/nas/opt/kubectl/config/pre</code>存放的是<code>config</code>文件,我平时要管理多个集群，所以我这里又多个目录。</p><h1 id="Windows-Terminal-配置"><a href="#Windows-Terminal-配置" class="headerlink" title="Windows Terminal 配置"></a>Windows Terminal 配置</h1><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;guid&quot;</span>: <span class="hljs-string">&quot;&#123;58ad8b0c-3ef8-5f4d-bc6f-13e4c00f2534&#125;&quot;</span>,<br>    <span class="hljs-attr">&quot;hidden&quot;</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;测试环境&quot;</span>,<br>    <span class="hljs-attr">&quot;commandline&quot;</span>: <span class="hljs-string">&quot;ssh -t root@192.168.0.250 \&quot;/bin/docker exec -it kubectltest bash\&quot;&quot;</span>,<br>    <span class="hljs-attr">&quot;icon&quot;</span>: <span class="hljs-string">&quot;ms-appx:///ProfileIcons/&#123;61c54bbd-c2c6-5271-96e7-009a87ff44bf&#125;.png&quot;</span>,<br>    <span class="hljs-attr">&quot;colorScheme&quot;</span>: <span class="hljs-string">&quot;Vintage&quot;</span><br>&#125;,<br>&#123;<br>    <span class="hljs-attr">&quot;guid&quot;</span>: <span class="hljs-string">&quot;&#123;58ad8b0c-3ef8-5f4d-bc6f-13e4c00f2535&#125;&quot;</span>,<br>    <span class="hljs-attr">&quot;hidden&quot;</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;预发布环境&quot;</span>,<br>    <span class="hljs-attr">&quot;commandline&quot;</span>: <span class="hljs-string">&quot;ssh -t root@192.168.0.250 \&quot;/bin/docker exec -it kubectlpre bash\&quot;&quot;</span>,<br>    <span class="hljs-attr">&quot;icon&quot;</span>: <span class="hljs-string">&quot;ms-appx:///ProfileIcons/&#123;61c54bbd-c2c6-5271-96e7-009a87ff44bf&#125;.png&quot;</span>,<br>    <span class="hljs-attr">&quot;colorScheme&quot;</span>: <span class="hljs-string">&quot;One Half Light&quot;</span><br>&#125;,<br></code></pre></td></tr></table></figure><p>重点在哪个<code>ssh -t</code>，不然会进不去，这样就完成了一个在本地打开终端直接进入到<code>nas</code>里的<code>docker</code>容器中进行<code>kubectl</code>管理集群的套娃操作。</p><h1 id="最后总结"><a href="#最后总结" class="headerlink" title="最后总结"></a>最后总结</h1><ol><li>远程连接的时候<code>ssh</code>的<code>-t</code>参数是<code>tty</code>的意思，不加这个参数后面的<code>docker exec -it</code>会报<code>the input device is not a TTY</code>错，进不去的。</li><li><code>docker-compose.yml</code>中的<code>command</code>节点中多条命令用<code>&amp;&amp;</code>分隔，如果是<code>&amp;</code>分隔，或造成命令并行执行，前一个还没结束，后一个就执行完了。</li></ol><h1 id="遗憾"><a href="#遗憾" class="headerlink" title="遗憾"></a>遗憾</h1><p>如果能用<code>webshell</code>直接使用<code>docker exec</code>就更好了，即节省了本地空间，又可以给组内的人一起使用。找到了一个<code>docker-exec-web-control</code>项目，是3年前的了，跑起来后并不能用。</p>]]></content>
    
    
    <categories>
      
      <category>DevOps</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Docker</tag>
      
      <tag>kubectl</tag>
      
      <tag>远程管理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>家庭服务管理：NAS</title>
    <link href="/2021/01/07/nas.html"/>
    <url>/2021/01/07/nas.html</url>
    
    <content type="html"><![CDATA[<h1 id="1-一个NAS都应该能做什么"><a href="#1-一个NAS都应该能做什么" class="headerlink" title="1 一个NAS都应该能做什么"></a>1 一个NAS都应该能做什么</h1><p>我是一个经历了家庭互联网从无到有的人，小的时候家里有个电视就算是富裕家庭了，一般的家庭还仅限于有个收音机；后来逐渐的，电视，彩色电视，电话，录像机，那个时候还有一种叫录像厅的地方呢，又租录像带的地方，5毛钱一周；然后出现了VCD，DVD，大哥大，BB机，掌中宝娱乐的东西越来越丰富。</p><p>之后我到外面上高中，那是2002年，那个时候已经有网吧了，但是电脑还不是普通家庭可以承受的。</p><p>等到我上了大学的时候，就到了2005年，彼时，小灵通还有一席之地，网吧遍地开花，上网一个电话，车接车送，包夜5元还送面包和可乐。但是学校里有笔记本的同学依然是少数，很多时候大家还是用U盘和MP3，MP4来互相拷贝东西，移动硬盘由于造价比较高，并不普及，而且，120G的都算是大容量存储了。</p><p>等毕业后，移动硬盘算是比较普及的，但是依然不大，320G和500G的都算大容量了，因为那个年代，资源的体积也是很小的。</p><p>逐渐的，很多东西变成了消费品，手机的普及，家庭宽带的普及，3G的出现和4G的升级，互联网才开始完全平民化，我个人来讲，3G的出现时一个转折点，4G的出现让很多想法得以实现。资源的质量也越来越高，以前的120p的资源，到后来的480，然后进化到720p，1080p;后来之间开始普及的2k，4k，蓝光等。存储空间也开始越来越便宜，从1T的hdd到现在消费级别的1T的ssd。</p><p>手机，电视，电脑，这是家庭的网络基础互联装备，以前一个硬盘到处插不觉得麻烦，现在建个网路共享我都觉得不方便，所以逐渐的，开始了NAS的路线。</p><p>NAS所需的功能，和是否需要NAS都是看个人和家庭的需求是否有必要，否则就是吃灰的产品。那么一个NAS，对我来讲需要以下的功能。</p><h2 id="1-1-流媒体"><a href="#1-1-流媒体" class="headerlink" title="1.1 流媒体"></a>1.1 流媒体</h2><p>彼时靠文件夹来分辨是什么电影，什么电视剧等等，资源混在一起，或者分成不同目录，甚至不同的硬盘装不同的东西，但是看的时候依然麻烦，而且目前网页观看也成为了大家容易接收的方式，以前电脑必装的千千静听，realplayer,xmplaoer,potplayer等等播放器，如今也变的鲜少有人问津。所以，流媒体服务就成为了一个比较基础的功能，应该能够做到，海报，简介，自动下载字幕，播放，分类这些基础的功能，下面是能够满足这几项条件的推荐。</p><ul><li>Jellyfin</li></ul><p>免费，开源，.Net Core，有TV端，Android端，网页端，PC端，而且，都免费，但是有点小缺点，就是硬解，遇到不支持的格式的就会强制硬解，而且使用服务端硬解，而不会使用本地硬解。</p><ul><li>Emby</li></ul><p>Jellyfin就是从这分家的，因为Emby有收费订阅，TV端就需要订阅，其他的几乎一样。据说硬解能力比Jellyfin强。</p><ul><li>Plex</li></ul><p>这是个很强的产品，大部分都推荐的，但是，订阅后体检更好。TV，手机端都需要订阅后才能用，这个好像是本地硬解，不占用服务器资源，只用了一次，所以不是很确定。</p><ul><li>elfilm</li></ul><p><a href="http://getelfilm.com/">http://getelfilm.com/</a></p><h2 id="1-2-下载"><a href="#1-2-下载" class="headerlink" title="1.2 下载"></a>1.2 下载</h2><ul><li>qBittorrent</li></ul><p>同时满足了BT下载和挂PT的需求，以前一直都是使用aria2的，但是aria2下载BT和PT需要单独的配置，不能一个端直接满足，所以，最后还是使用了这个。</p><ul><li>aria2</li></ul><p>老牌下载工具</p><h2 id="1-3-Home-Assistant"><a href="#1-3-Home-Assistant" class="headerlink" title="1.3 Home Assistant"></a>1.3 Home Assistant</h2><p>基础的家庭物联网工具，我是比较早接触智能家居设备的，这也导致了我家的产品比较割裂，空气净化器是，空调是格力的，扫地机是小米的，电视是乐视的，可视猫眼是叮咚，门锁是美的，有了HomeAssistant后，可以将其中一部分整合到上面。</p><h2 id="1-4-旁路网关"><a href="#1-4-旁路网关" class="headerlink" title="1.4 旁路网关"></a>1.4 旁路网关</h2><p>流畅的网络体验。</p><h2 id="1-5-文件共享"><a href="#1-5-文件共享" class="headerlink" title="1.5 文件共享"></a>1.5 文件共享</h2><p>Linux下比较流行的就是SMB，但是现在看来，好像并不是常用的了。</p><h2 id="1-6-可扩展性"><a href="#1-6-可扩展性" class="headerlink" title="1.6 可扩展性"></a>1.6 可扩展性</h2><h3 id="1-6-1-Docker"><a href="#1-6-1-Docker" class="headerlink" title="1.6.1 Docker"></a>1.6.1 Docker</h3><h4 id="1-6-1-1-Home-Assistant"><a href="#1-6-1-1-Home-Assistant" class="headerlink" title="1.6.1.1 Home Assistant"></a>1.6.1.1 Home Assistant</h4><p>家庭物联网</p><h4 id="1-6-1-2-qBittorrent"><a href="#1-6-1-2-qBittorrent" class="headerlink" title="1.6.1.2 qBittorrent"></a>1.6.1.2 qBittorrent</h4><p>既满足bt又能满足pt</p><h4 id="1-6-1-3-Jellyfin"><a href="#1-6-1-3-Jellyfin" class="headerlink" title="1.6.1.3 Jellyfin"></a>1.6.1.3 Jellyfin</h4><p>多端免费的媒体管理，自动刮削，硬解。</p><h4 id="1-6-1-4-签到"><a href="#1-6-1-4-签到" class="headerlink" title="1.6.1.4 签到"></a>1.6.1.4 签到</h4><p>免去了每天手动签到的麻烦过程，但是gthub actions可以替代。</p><h4 id="1-6-1-5-百度云"><a href="#1-6-1-5-百度云" class="headerlink" title="1.6.1.5 百度云"></a>1.6.1.5 百度云</h4><h3 id="1-6-2-虚拟机"><a href="#1-6-2-虚拟机" class="headerlink" title="1.6.2 虚拟机"></a>1.6.2 虚拟机</h3><h4 id="1-6-2-1-windows"><a href="#1-6-2-1-windows" class="headerlink" title="1.6.2.1 windows"></a>1.6.2.1 windows</h4><p>挂游戏，一般来说我来玩传奇的时候会挂机。</p><h4 id="1-6-2-2-linux"><a href="#1-6-2-2-linux" class="headerlink" title="1.6.2.2 linux"></a>1.6.2.2 linux</h4><p>我用来ssh，远程管理k8s。其实nas本身就是Linux。</p><h2 id="1-7-云"><a href="#1-7-云" class="headerlink" title="1.7 云"></a>1.7 云</h2><ul><li>Nextcloud</li></ul><h2 id="1-8-ZeroTier"><a href="#1-8-ZeroTier" class="headerlink" title="1.8 ZeroTier"></a>1.8 ZeroTier</h2><ul><li>异地访问</li><li>VPN直连</li></ul><h2 id="frpc"><a href="#frpc" class="headerlink" title="frpc"></a>frpc</h2><ul><li>内网穿透</li></ul><h2 id="1-9-选用什么系统？"><a href="#1-9-选用什么系统？" class="headerlink" title="1.9 选用什么系统？"></a>1.9 选用什么系统？</h2><h3 id="1-9-1-群晖"><a href="#1-9-1-群晖" class="headerlink" title="1.9.1 群晖"></a>1.9.1 群晖</h3><h4 id="1-9-1-1-黑群晖"><a href="#1-9-1-1-黑群晖" class="headerlink" title="1.9.1.1 黑群晖"></a>1.9.1.1 黑群晖</h4><p>内网穿透、稳定的应用（也不一定）、同步、备份。<br>虽然免费，但是升级什么的比较麻烦。</p><h4 id="1-9-1-2-白群晖"><a href="#1-9-1-2-白群晖" class="headerlink" title="1.9.1.2 白群晖"></a>1.9.1.2 白群晖</h4><p>内网穿透、稳定的应用（也不一定）、同步、备份、稳定、可升级、贵。</p><p>我觉得性价比不高。</p><h3 id="1-9-2-ProxmoxVE（推荐★★★★★）"><a href="#1-9-2-ProxmoxVE（推荐★★★★★）" class="headerlink" title="1.9.2 ProxmoxVE（推荐★★★★★）"></a>1.9.2 ProxmoxVE（推荐★★★★★）</h3><p>其本质上是一个Debian系统，用起来熟悉。</p><h4 id="1-9-2-1-zfs存储"><a href="#1-9-2-1-zfs存储" class="headerlink" title="1.9.2.1 zfs存储"></a>1.9.2.1 zfs存储</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">ls -l /dev/disk/by-id/<br>total 0<br>lrwxrwxrwx 1 root root  9 Dec 30 10:29 ata-SCWW_SSD_16G_0000000000000 -&gt; ../../sda<br>lrwxrwxrwx 1 root root 10 Dec 30 10:29 ata-SCWW_SSD_16G_0000000000000-part1 -&gt; ../../sda1<br>lrwxrwxrwx 1 root root 10 Dec 30 10:29 ata-SCWW_SSD_16G_0000000000000-part2 -&gt; ../../sda2<br>lrwxrwxrwx 1 root root 10 Dec 30 10:29 ata-SCWW_SSD_16G_0000000000000-part3 -&gt; ../../sda3<br>lrwxrwxrwx 1 root root  9 Dec 30 10:29 ata-ST99999999-******-****** -&gt; ../../sdc<br>lrwxrwxrwx 1 root root  9 Dec 30 10:29 ata-TOSHIBA_******_****** -&gt; ../../sdb<br><br><span class="hljs-comment">#raid-0</span><br>zpool create -f -o ashift=12 nas /dev/disk/by-id/ata-ST99999999-******-****** /dev/disk/by-id/ata-TOSHIBA_******_******<br><br><span class="hljs-comment"># 加新硬盘</span><br>zpool attach nas /dev/disk/by-id/ata-ST88888888-******-******<br></code></pre></td></tr></table></figure><p>上面完成后会在根目录下生成一个nas文件夹，就是存储池的空间了。</p><p>软raid<br>创建存储池<br>做为目录</p><h4 id="1-9-2-2-软路由"><a href="#1-9-2-2-软路由" class="headerlink" title="1.9.2.2 软路由"></a>1.9.2.2 软路由</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">qm importdisk 100 /nas/20201229-Ipv4P-Mini-x86-64-generic-squashfs-combined-efi.img nas-local<br></code></pre></td></tr></table></figure><h4 id="1-9-2-3-lxc"><a href="#1-9-2-3-lxc" class="headerlink" title="1.9.2.3 lxc"></a>1.9.2.3 lxc</h4><p>做软路由<br>虚拟机</p><h3 id="1-9-3-FreeNAS（推荐★★★）"><a href="#1-9-3-FreeNAS（推荐★★★）" class="headerlink" title="1.9.3 FreeNAS（推荐★★★）"></a>1.9.3 FreeNAS（推荐★★★）</h3><p>免费</p><h3 id="1-9-4-OMV（OpenMediaVault）"><a href="#1-9-4-OMV（OpenMediaVault）" class="headerlink" title="1.9.4 OMV（OpenMediaVault）"></a>1.9.4 OMV（OpenMediaVault）</h3><p>免费、功能过于基础。</p><h3 id="1-9-5-Windows-Server（推荐★★★★）"><a href="#1-9-5-Windows-Server（推荐★★★★）" class="headerlink" title="1.9.5 Windows Server（推荐★★★★）"></a>1.9.5 Windows Server（推荐★★★★）</h3><p>免费，这点可能很多人不知道，Windows Server Core是有免费版本的。只是没有桌面环境，但是已经Windows Server了，桌面环境除了浪费空间和资源外，真的就没什么用了。</p><p>HyperV可以直接使用<a href="https://www.microsoft.com/zh-cn/windows-server/windows-admin-center">Windows Admin Center</a>可以直接进行管理，也可以使用Windows10 的hyper-V远程管理。</p><p>硬件直通对硬件本身要求较高，但是一般也够用了。</p><p>用起来操作很熟悉。</p><h3 id="1-9-6-Ubuntu-Server"><a href="#1-9-6-Ubuntu-Server" class="headerlink" title="1.9.6 Ubuntu Server"></a>1.9.6 Ubuntu Server</h3><h3 id="1-9-7-UNRAID"><a href="#1-9-7-UNRAID" class="headerlink" title="1.9.7 UNRAID"></a>1.9.7 UNRAID</h3><p>据说硬件直通性能非常好，但是收费，虽然有破解版。</p><h3 id="1-9-8-ESXI"><a href="#1-9-8-ESXI" class="headerlink" title="1.9.8 ESXI"></a>1.9.8 ESXI</h3><p>老牌。</p><h2 id="1-10-硬件上最好有什么？"><a href="#1-10-硬件上最好有什么？" class="headerlink" title="1.10 硬件上最好有什么？"></a>1.10 硬件上最好有什么？</h2><h3 id="1-10-1-网卡"><a href="#1-10-1-网卡" class="headerlink" title="1.10.1 网卡"></a>1.10.1 网卡</h3><ul><li>千兆</li><li>万兆<h3 id="1-10-2-Raid卡"><a href="#1-10-2-Raid卡" class="headerlink" title="1.10.2 Raid卡"></a>1.10.2 Raid卡</h3></li><li>多硬盘，也可以用软raid<h3 id="1-10-3-热插拔"><a href="#1-10-3-热插拔" class="headerlink" title="1.10.3 热插拔"></a>1.10.3 热插拔</h3></li><li>多盘位<h3 id="1-10-4-USB3"><a href="#1-10-4-USB3" class="headerlink" title="1.10.4 USB3"></a>1.10.4 USB3</h3></li><li>打印机<h3 id="1-10-5-DC电源"><a href="#1-10-5-DC电源" class="headerlink" title="1.10.5 DC电源"></a>1.10.5 DC电源</h3></li><li>静音<h3 id="1-10-6-1-N块硬盘"><a href="#1-10-6-1-N块硬盘" class="headerlink" title="1.10.6 1+N块硬盘"></a>1.10.6 1+N块硬盘</h3></li><li>组RAID</li></ul><h1 id="2-NAS服务管理"><a href="#2-NAS服务管理" class="headerlink" title="2 NAS服务管理"></a>2 NAS服务管理</h1><h2 id="2-1-Jellyfin"><a href="#2-1-Jellyfin" class="headerlink" title="2.1 Jellyfin"></a>2.1 Jellyfin</h2><h3 id="2-1-1-电影多版本管理"><a href="#2-1-1-电影多版本管理" class="headerlink" title="2.1.1 电影多版本管理"></a>2.1.1 电影多版本管理</h3><p>以<code>Wonder Woman 1984</code>这部电影为例，我的电影都是放在<code>/nas/movies</code>里的,所以目录结构是这样的:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">movies/<br>└── Wonder.Woman.1984.2020<br>    ├── Wonder.Woman.1984.2020 - 1080P.mkv<br>    ├── Wonder.Woman.1984.2020 - 1080P.china.srt<br>    └── Wonder.Woman.1984.2020 - 2160p.mp4<br>    └── Wonder.Woman.1984.2020 - 8k.mp4<br>    └── Wonder.Woman.1984.2020 - 不是导演剪辑版.mp4<br>    └── Wonder.Woman.1984.2020 - 山寨版.mp4<br></code></pre></td></tr></table></figure><p>根据<code>jellyfin</code>文档显示，当多个不同格式的版本合并起来的时候，需要让文件名与文件夹名保持一直然后再后面加<code>&#123;空格&#125;&#123;连字符&#125;&#123;空格&#125;&#123;版本标签&#125;</code>的形式，这样jellyfin就可以进行识别，在电影的界面中就可以进行版本的切换选择，在这一点上不如plex方便了。 其中标签是可以自定义的，连字符不支持<code>.</code>和空格。</p><p>** 官方的文档中推荐的文件夹名是<code>Wonder.Woman.1984 (2020)</code> ，但是实际使用中我发现<code>Wonder.Woman.1984.2020</code>也是可以的，在文件管理上，名字中带有空格对我来讲会不大习惯，所以可以根据自己习惯选择对名称的管理。</p><h4 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h4><ul><li><a href="https://jellyfin.org/docs/general/server/media/movies.html">https://jellyfin.org/docs/general/server/media/movies.html</a></li></ul><h3 id="2-1-2-字幕中的方块"><a href="#2-1-2-字幕中的方块" class="headerlink" title="2.1.2 字幕中的方块"></a>2.1.2 字幕中的方块</h3><p>一般的解决方式都是在字幕中进行设置，这种方式是使用转码烧录的形式，对cpu和内存都会进行消耗，对于性能比较低的nas来说，压力很大，比如我的j1900矿渣。目前有一个简单的解决办法，升级到<code>&gt;Jellyfin 10.7.0</code>的版本，目前还是<code>rc</code>版，这个版本支持加载自定义的字体了<code>控制台&gt;播放&gt;备用字体文件路径</code>，就解决了。</p><h2 id="2-2-docker-compose"><a href="#2-2-docker-compose" class="headerlink" title="2.2 docker-compose"></a>2.2 docker-compose</h2><h3 id="2-2-1-安装docker"><a href="#2-2-1-安装docker" class="headerlink" title="2.2 1 安装docker"></a>2.2 1 安装docker</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">apt update<br>apt install apt-transport-https<br>apt upgrade -y<br>curl -fsSL https://download.docker.com/linux/debian/gpg | apt-key add -<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;deb [arch=amd64] https://download.docker.com/linux/debian <span class="hljs-subst">$(lsb_release -cs)</span> stable&quot;</span> &gt; /etc/apt/sources.list.d/docker.list<br></code></pre></td></tr></table></figure><h4 id="参考链接-1"><a href="#参考链接-1" class="headerlink" title="参考链接"></a>参考链接</h4><ul><li><a href="https://docs.docker.com/engine/install/debian/">https://docs.docker.com/engine/install/debian/</a><h3 id="2-2-2-安装docker-compose"><a href="#2-2-2-安装docker-compose" class="headerlink" title="2.2 2 安装docker-compose"></a>2.2 2 安装docker-compose</h3></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">apt install docker-ce docker-compose<br></code></pre></td></tr></table></figure><h3 id="2-2-3-前期准备"><a href="#2-2-3-前期准备" class="headerlink" title="2.2 3 前期准备"></a>2.2 3 前期准备</h3><p>创建子网隔离，非必须。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker network create --subnet 10.10.10.0/24 pve-subnet<br></code></pre></td></tr></table></figure><p>该处的<code>pve-subnet</code>对应下面<code>docker-compose.yml</code>文件中<code>networks</code>节点下的<code>name</code>,可以忽略，<code>docker-compose</code>会自动建立。</p><h3 id="2-2-4-为什么使用docker-compose"><a href="#2-2-4-为什么使用docker-compose" class="headerlink" title="2.2 4 为什么使用docker-compose"></a>2.2 4 为什么使用docker-compose</h3><p>docker虽然部署与管理变的容易，但是当遇到版本升级的时候就需要重新使用命令行进行一次部署，然而很多时候我都懒得进行本分，目前工作中使用的是k8s，在家用nas上我觉得实在是没必要，于是比较传统的<code>docker-compose</code>就是一个很好的解决方案。<br>每当有版本升级的时候只要修改<code>docker-compose.yml</code>文件中对应的镜像标签，然后重新docker-compose up -d就自动进行拉取部署升级，不会影响其他未修改配置的镜像，就方便很多了。</p><h2 id="2-3-Home-Assistant"><a href="#2-3-Home-Assistant" class="headerlink" title="2.3 Home Assistant"></a>2.3 Home Assistant</h2><h3 id="2-3-1-调用本地图片"><a href="#2-3-1-调用本地图片" class="headerlink" title="2.3.1 调用本地图片"></a>2.3.1 调用本地图片</h3><p>在<code>configuration.yaml</code>文件的位置建立一个<code>www</code>文件夹，将要引用的文件放进去，在配置文件中使用<code>/local</code>对应的就是<code>www</code>文件夹中的文件，例如</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash"> blueprints<br>│   └── automation<br>│       └── homeassistant<br>│           ├── motion_light.yaml<br>│           └── notify_leaving_zone.yaml<br>├── configuration.yaml<br>├── deps<br>├── groups.yaml<br>├── home-assistant.log<br>├── home-assistant_v2.db<br>├── scenes.yaml<br>├── scripts.yaml<br>├── secrets.yaml<br>├── tts<br>└── www<br>    └── floorplan.png<br></code></pre></td></tr></table></figure><p>如果要在配置中调用<code>www/floorplan.png</code>则对应的配置文件为:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">type:</span> <span class="hljs-string">picture-elements</span><br><span class="hljs-attr">image:</span> <span class="hljs-string">/local/floorplan.png</span><br><span class="hljs-attr">elements:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">state-badge</span><br>    <span class="hljs-attr">entity:</span> <span class="hljs-string">binary_sensor.updater</span><br>    <span class="hljs-attr">style:</span><br>      <span class="hljs-attr">top:</span> <span class="hljs-number">65</span><span class="hljs-string">%</span><br>      <span class="hljs-attr">left:</span> <span class="hljs-number">38</span><span class="hljs-string">%</span><br></code></pre></td></tr></table></figure><h3 id="2-3-2-水位流量采集"><a href="#2-3-2-水位流量采集" class="headerlink" title="2.3.2 水位流量采集"></a>2.3.2 水位流量采集</h3><p>我在天气好的时候会出去钓鱼，但是松花江如果在汛期的时候涨水，有些地方就去不了了，为了不耽误时间，我发现松辽水利网每天8点会发布一次当前的水位流量，所以我进行了采集，这样出门前看一下水位和流速来判断可以去哪个地方钓鱼，避免白跑一趟。</p><p>在<code>configuration.yaml</code>下面加入下面的内容，就可以在面板中加载进来了。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">sensor:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">platform:</span> <span class="hljs-string">scrape</span><br>    <span class="hljs-attr">resource:</span> <span class="hljs-string">http://www.slwr.gov.cn/swjgzfw/sssq.asp</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">slwr</span> <span class="hljs-string">shuiwei</span><br>    <span class="hljs-attr">select:</span> <span class="hljs-string">&#x27;script&#x27;</span><br>    <span class="hljs-attr">index:</span> <span class="hljs-number">1</span><br>    <span class="hljs-attr">scan_interval:</span> <span class="hljs-number">3600</span><br>    <span class="hljs-attr">value_template:</span> <span class="hljs-string">&gt;-</span><br><span class="hljs-string">      &#123;&#123; (value | replace (&quot;cvt(&quot;,&quot;&quot;) | replace (&quot;);&quot;,&quot;&quot;) | replace (&quot;&#x27;&quot;,&quot;&quot;) ) &#125;&#125;</span><br><span class="hljs-string"></span>  <span class="hljs-bullet">-</span> <span class="hljs-attr">platform:</span> <span class="hljs-string">scrape</span><br>    <span class="hljs-attr">resource:</span> <span class="hljs-string">http://www.slwr.gov.cn/swjgzfw/sssq.asp</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">slwr</span> <span class="hljs-string">liuliang</span><br>    <span class="hljs-attr">select:</span> <span class="hljs-string">&#x27;font&#x27;</span><br>    <span class="hljs-attr">index:</span> <span class="hljs-number">8</span><br>    <span class="hljs-attr">scan_interval:</span> <span class="hljs-number">3600</span><br></code></pre></td></tr></table></figure><h3 id="2-3-3-小米扫地机器人"><a href="#2-3-3-小米扫地机器人" class="headerlink" title="2.3.3 小米扫地机器人"></a>2.3.3 小米扫地机器人</h3><p>第一二代的小米扫地机，使用的是<code>Token</code>的方式加入的，目前有一个简单的工具<a href="https://github.com/PiotrMachowski/Xiaomi-cloud-tokens-extractor">https://github.com/PiotrMachowski/Xiaomi-cloud-tokens-extractor</a> 运行后输入账号密码就可以获取到局域网中的<code>IP</code>和<code>Token</code>、<code>设备Id</code>，我们这里使用<code>IP</code>和<code>Token</code>就够了。<br>获取到信息后，在<code>configuration.yaml</code>下面加入下面的内容，就可以在面板中加载进来了。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">vacuum:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">platform:</span> <span class="hljs-string">xiaomi_miio</span><br>    <span class="hljs-attr">host:</span> <span class="hljs-number">192.168</span><span class="hljs-number">.0</span><span class="hljs-number">.69</span><br>    <span class="hljs-attr">token:</span> <span class="hljs-string">**********************************</span><br></code></pre></td></tr></table></figure><h3 id="2-3-4-格力宁韵空调"><a href="#2-3-4-格力宁韵空调" class="headerlink" title="2.3.4 格力宁韵空调"></a>2.3.4 格力宁韵空调</h3><p><a href="https://github.com/RobHofmann/HomeAssistant-GreeClimateComponent">https://github.com/RobHofmann/HomeAssistant-GreeClimateComponent</a><br>下载最新版本解压后如下</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-string">|   climate.yaml</span><br><span class="hljs-string">|   configuration.yaml</span><br><span class="hljs-string">|   info.md</span><br><span class="hljs-string">|   LICENSE</span><br><span class="hljs-string">|   README.md</span><br><span class="hljs-string">|</span><br>+---.github<br><span class="hljs-string">|   \---ISSUE_TEMPLATE</span><br><span class="hljs-string">|           bug_report.md</span><br><span class="hljs-string">|           feature_request.md</span><br><span class="hljs-string">|</span><br>\---custom_components<br>    \---gree<br>            climate.py<br>            manifest.json<br>            __init__.py<br></code></pre></td></tr></table></figure><p>如果<code>configuration.yaml</code>同级目录下没有<code>custom_components</code>则直接复制进去，如果已经存在，则复制下面的<code>gree</code>到<code>custom_components</code>下，然后在复制<code>climate.yaml</code>到<code>configuration.yaml</code>同级目录,之后编辑``configuration.yaml<code>同级目录加入一行</code>climate: !include climate.yaml`。</p><p>使用<code>格力+</code>接入空调，这样就能在路由器中看到空调的<code>IP</code>和<code>MAC</code>，下面会用到，虽然我是在苏宁购买的，但是苏宁的app实在是不好用，于是下载了<code>格力+</code>，在添加设备的时候直接选择<code>宁韵</code>，然后重置空调的<code>wifi</code>，就可以连接了，如果连不上，那么修改<code>wifi</code>里的<code>2.4G</code>的<code>无线模式</code>为<code>11gb</code>开头的模式。</p><p>之后编辑<code>climate.yaml</code>中的内容：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">platform:</span> <span class="hljs-string">gree</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">起一个名字，例如ningyun_ac</span><br>  <span class="hljs-attr">host:</span> <span class="hljs-string">空调的IP地址</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">7000</span><br>  <span class="hljs-attr">mac:</span> <span class="hljs-string">&#x27;空调的MAC地址，可以是-分隔，也可以是:分隔&#x27;</span><br>  <span class="hljs-attr">target_temp_step:</span> <span class="hljs-number">1</span><br>  <span class="hljs-attr">lights:</span> <span class="hljs-string">input_boolean.first_ac_lights</span><br>  <span class="hljs-attr">health:</span> <span class="hljs-string">input_boolean.first_ac_health</span><br>  <span class="hljs-attr">sleep:</span> <span class="hljs-string">input_boolean.first_ac_sleep</span><br>  <span class="hljs-attr">powersave:</span> <span class="hljs-string">input_boolean.first_ac_powersave</span><br></code></pre></td></tr></table></figure><h3 id="2-3-x-lovelace"><a href="#2-3-x-lovelace" class="headerlink" title="2.3.x lovelace"></a>2.3.x lovelace</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">title:</span> <span class="hljs-string">保利·上城</span><br><span class="hljs-attr">views:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">panel:</span> <span class="hljs-literal">false</span><br>    <span class="hljs-attr">title:</span> <span class="hljs-string">Home</span><br>    <span class="hljs-attr">icon:</span> <span class="hljs-string">&#x27;hass:home-assistant&#x27;</span><br>    <span class="hljs-attr">badges:</span> []<br>    <span class="hljs-attr">cards:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">vertical-stack</span><br>        <span class="hljs-attr">cards:</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">&#x27;custom:weather-card&#x27;</span><br>            <span class="hljs-attr">entity:</span> <span class="hljs-string">weather.bao_li_shang_cheng</span><br>            <span class="hljs-attr">number_of_forecasts:</span> <span class="hljs-string">&#x27;5&#x27;</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">horizontal-stack</span><br>            <span class="hljs-attr">cards:</span><br>              <span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">entity</span><br>                <span class="hljs-attr">entity:</span> <span class="hljs-string">sensor.slwr_shuiwei</span><br>                <span class="hljs-attr">name:</span> <span class="hljs-string">水位</span><br>                <span class="hljs-attr">unit:</span> <span class="hljs-string">米</span><br>              <span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">entity</span><br>                <span class="hljs-attr">entity:</span> <span class="hljs-string">sensor.slwr_liuliang</span><br>                <span class="hljs-attr">name:</span> <span class="hljs-string">流量</span><br>                <span class="hljs-attr">unit:</span> <span class="hljs-string">立方米</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">picture-elements</span><br>        <span class="hljs-attr">elements:</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">state-icon</span><br>            <span class="hljs-attr">entity:</span> <span class="hljs-string">vacuum.xiaomi_vacuum_cleaner</span><br>            <span class="hljs-attr">style:</span><br>              <span class="hljs-attr">top:</span> <span class="hljs-number">65</span><span class="hljs-string">%</span><br>              <span class="hljs-attr">left:</span> <span class="hljs-number">35</span><span class="hljs-string">%</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">state-icon</span><br>            <span class="hljs-attr">entity:</span> <span class="hljs-string">climate.ningyun_ac</span><br>            <span class="hljs-attr">style:</span><br>              <span class="hljs-attr">top:</span> <span class="hljs-number">8</span><span class="hljs-string">%</span><br>              <span class="hljs-attr">left:</span> <span class="hljs-number">35</span><span class="hljs-string">%</span><br>        <span class="hljs-attr">image:</span> <span class="hljs-string">/local/floorplan.png</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">vertical-stack</span><br>        <span class="hljs-attr">cards:</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">thermostat</span><br>            <span class="hljs-attr">entity:</span> <span class="hljs-string">climate.ningyun_ac</span><br>            <span class="hljs-attr">name:</span> <span class="hljs-string">格力宁韵</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">picture-glance</span><br>            <span class="hljs-attr">image:</span> <span class="hljs-string">/local/img/vacuum.png</span><br>            <span class="hljs-attr">entities:</span><br>              <span class="hljs-bullet">-</span> <span class="hljs-attr">entity:</span> <span class="hljs-string">vacuum.xiaomi_vacuum_cleaner</span><br>            <span class="hljs-attr">tap_action:</span><br>              <span class="hljs-attr">action:</span> <span class="hljs-string">more-info</span><br>            <span class="hljs-attr">hold_action:</span><br>              <span class="hljs-attr">action:</span> <span class="hljs-string">none</span><br>            <span class="hljs-attr">title:</span> <span class="hljs-string">小米</span><br>            <span class="hljs-attr">entity:</span> <span class="hljs-string">vacuum.xiaomi_vacuum_cleaner</span><br></code></pre></td></tr></table></figure><h2 id="2-4-syncthing"><a href="#2-4-syncthing" class="headerlink" title="2.4 syncthing"></a>2.4 syncthing</h2><p>资源占用小，内网发现，全球发现，内网穿透。</p><p>要注意的是从其他设备同步过来的文件夹，默认情况下会出现在<code>/config</code>下，</p><h2 id="2-5-frp"><a href="#2-5-frp" class="headerlink" title="2.5 frp"></a>2.5 frp</h2><p>如今我遭遇了无法在家的问题，但是手机里的资料还是要同步回家里的NAS，尝试了ngrok、autossh等方案之后，最后还是选定了老牌的frp，之前也用过，但是不知道是版本的问题还是配置的问题，会导致我的网络卡死，这次重新尝试后发现，很稳定，资源的消耗也变小了，在vps上使用nginx绑定泛域名到frps，然后再用frps绑定泛域名，之后直接使用子域名访问各个服务。</p><h3 id="2-5-1-服务端nginx配置-etc-nginx-conf-d-nas-conf"><a href="#2-5-1-服务端nginx配置-etc-nginx-conf-d-nas-conf" class="headerlink" title="2.5.1 服务端nginx配置/etc/nginx/conf.d/nas.conf"></a>2.5.1 服务端nginx配置<code>/etc/nginx/conf.d/nas.conf</code></h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs ini">server &#123;<br>    listen 80<span class="hljs-comment">;</span><br>    server_name *.phub.ml<span class="hljs-comment">;</span><br>    return 301 https://$host$request_uri<span class="hljs-comment">;</span><br>&#125;<br><br>server &#123;<br><span class="hljs-comment">#    listen [::]:443 ssl ipv6only=on; # managed by Certbot</span><br>    listen 443 ssl http2<span class="hljs-comment">; # managed by Certbot</span><br>    server_name *.nas.com<span class="hljs-comment">;</span><br><br>    ssl_certificate /etc/letsencrypt/live/nas.com/fullchain.pem<span class="hljs-comment">; # managed by Certbot</span><br>    ssl_certificate_key /etc/letsencrypt/live/nas.com/privkey.pem<span class="hljs-comment">; # managed by Certbot</span><br>    include /etc/letsencrypt/options-ssl-nginx.conf<span class="hljs-comment">; # managed by Certbot</span><br><br>    client_max_body_size 500m<span class="hljs-comment">;</span><br>    client_body_buffer_size 256k<span class="hljs-comment">;</span><br>    client_header_timeout 3m<span class="hljs-comment">;</span><br>    client_body_timeout 3m<span class="hljs-comment">;</span><br>    send_timeout 3m<span class="hljs-comment">;</span><br>    proxy_connect_timeout 300s<span class="hljs-comment">;</span><br>    proxy_read_timeout 300s<span class="hljs-comment">;</span><br>    proxy_send_timeout 300s<span class="hljs-comment">;</span><br>    proxy_buffer_size 64k<span class="hljs-comment">;</span><br>    proxy_buffers 4 32k<span class="hljs-comment">;</span><br>    proxy_busy_buffers_size 64k<span class="hljs-comment">;</span><br>    proxy_temp_file_write_size 64k<span class="hljs-comment">;</span><br>    proxy_ignore_client_abort on<span class="hljs-comment">;</span><br>    gzip on<span class="hljs-comment">;</span><br>    gzip_min_length 1k<span class="hljs-comment">;</span><br>    gzip_buffers 4 16k<span class="hljs-comment">;</span><br>    <span class="hljs-comment">#gzip_http_version 1.0;</span><br>    gzip_comp_level 5<span class="hljs-comment">;</span><br>    gzip_types text/plain application/x-javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png<span class="hljs-comment">;</span><br>    gzip_vary off<span class="hljs-comment">;</span><br>    gzip_disable &quot;MSIE <span class="hljs-section">[1-6]</span>\.&quot;<span class="hljs-comment">;</span><br>    location /api/websocket &#123;<br>       proxy_pass http://127.0.0.1:27001/api/websocket<span class="hljs-comment">;</span><br>        proxy_read_timeout 60s<span class="hljs-comment">;</span><br>        proxy_set_header Host $host<span class="hljs-comment">;</span><br>        proxy_set_header X-Real_IP $remote_addr<span class="hljs-comment">;</span><br>        proxy_set_header X-Forwarded-for $remote_addr<span class="hljs-comment">;</span><br>        proxy_http_version 1.1<span class="hljs-comment">;</span><br>        proxy_set_header Upgrade $http_upgrade<span class="hljs-comment">;</span><br>        proxy_set_header Connection &#x27;Upgrade&#x27;<span class="hljs-comment">;</span><br>    &#125;<br>    location / &#123;<br>        proxy_pass http://127.0.0.1:27001<span class="hljs-comment">;</span><br>        proxy_set_header Host $host<span class="hljs-comment">;</span><br>        proxy_redirect off<span class="hljs-comment">;</span><br>        proxy_buffering off<span class="hljs-comment">;</span><br>        proxy_http_version 1.1<span class="hljs-comment">;</span><br>        proxy_ssl_server_name on<span class="hljs-comment">;</span><br>        proxy_set_header X-Real-IP $remote_addr<span class="hljs-comment">;</span><br>        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for<span class="hljs-comment">;</span><br>        proxy_set_header X-Forwarded-Proto $scheme<span class="hljs-comment">;</span><br>        proxy_set_header Upgrade $http_upgrade<span class="hljs-comment">;</span><br>        proxy_set_header Connection &quot;upgrade&quot;<span class="hljs-comment">;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-5-2-服务端的frps配置-etc-frp-frps-ini"><a href="#2-5-2-服务端的frps配置-etc-frp-frps-ini" class="headerlink" title="2.5.2 服务端的frps配置/etc/frp/frps.ini"></a>2.5.2 服务端的frps配置<code>/etc/frp/frps.ini</code></h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[common]</span><br><span class="hljs-attr">bind_addr</span> = <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span><br><span class="hljs-attr">bind_port</span> = <span class="hljs-number">7557</span><br><span class="hljs-attr">bind_udp_port</span> = <span class="hljs-number">5775</span><br><span class="hljs-attr">token</span> = ***************************<br><span class="hljs-attr">vhost_http_port</span> = <span class="hljs-number">27001</span><br><span class="hljs-attr">vhost_https_port</span> = <span class="hljs-number">5443</span><br><span class="hljs-attr">tcp_mux</span> = <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><h3 id="2-5-3-客户端的frpc配置frpc-ini"><a href="#2-5-3-客户端的frpc配置frpc-ini" class="headerlink" title="2.5.3 客户端的frpc配置frpc.ini"></a>2.5.3 客户端的frpc配置<code>frpc.ini</code></h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[common]</span><br><span class="hljs-attr">server_addr</span> = <span class="hljs-number">000.000</span>.<span class="hljs-number">000.000</span><br><span class="hljs-attr">server_port</span> = <span class="hljs-number">7557</span><br><span class="hljs-attr">tcp_mux</span>     = <span class="hljs-literal">true</span><br><span class="hljs-attr">token</span>       = *******************<br><br><span class="hljs-section">[ssh]</span><br><span class="hljs-attr">type</span> = tcp<br><span class="hljs-attr">local_port</span> = <span class="hljs-number">22</span><br><span class="hljs-attr">remote_port</span> = <span class="hljs-number">20002</span><br><br><span class="hljs-section">[qBittorent]</span><br><span class="hljs-attr">type</span> = http<br><span class="hljs-attr">local_port</span> = <span class="hljs-number">8008</span><br><span class="hljs-attr">custom_domains</span> = bt.nas.com<br><br><span class="hljs-section">[syncthing]</span><br><span class="hljs-attr">type</span> = http<br><span class="hljs-attr">local_port</span> = <span class="hljs-number">8384</span><br><span class="hljs-attr">custom_domains</span> = sync.nas.com<br><br><span class="hljs-section">[images]</span><br><span class="hljs-attr">type</span> = http<br><span class="hljs-attr">local_port</span> = <span class="hljs-number">8698</span><br><span class="hljs-attr">custom_domains</span> = images.nas.com<br><br><span class="hljs-section">[openwrt]</span><br><span class="hljs-attr">type</span> = http<br><span class="hljs-attr">local_ip</span> = <span class="hljs-number">192.168</span>.<span class="hljs-number">0.253</span><br><span class="hljs-attr">local_port</span> = <span class="hljs-number">80</span><br><span class="hljs-attr">custom_domains</span> = gw.nas.com<br><br><span class="hljs-section">[movies]</span><br><span class="hljs-attr">type</span> = http<br><span class="hljs-attr">local_port</span> = <span class="hljs-number">8096</span><br><span class="hljs-attr">custom_domains</span> = movies.nas.com<br></code></pre></td></tr></table></figure><h3 id="2-5-4-重点内容"><a href="#2-5-4-重点内容" class="headerlink" title="2.5.4 重点内容"></a>2.5.4 重点内容</h3><ul><li>nginx中的<code>proxy_pass http://127.0.0.1:27001</code>对应到frps.ini中的<code>vhost_https_port = 5443</code></li><li>frps.ini中的<code>bind_port = 7557</code>对应到客户端中的<code>server_port = 7557</code></li><li>frpc中会出现<code>[E] [control.go:158] [c4426f709c4d9725] work connection closed before response StartWorkConn message: EOF</code>的错误信息，目前没找到解决办法，但是还没发现耽误使用的情况</li></ul><h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><h3 id="linux下rename命令进行批量重命名"><a href="#linux下rename命令进行批量重命名" class="headerlink" title="linux下rename命令进行批量重命名"></a>linux下rename命令进行批量重命名</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">rename <span class="hljs-string">&#x27;s///g&#x27;</span> *.mp4<br>例如<br>rename <span class="hljs-string">&#x27;s/cowboy\.bebop\.//g&#x27;</span> *.mkv<br>将cowboy.bebop替换为空，也就是删掉<br></code></pre></td></tr></table></figure><p>其中<code>s</code>为开始，第一个<code>/</code>后面写要查找的字符串,第二个<code>/</code>进行分隔，第三个<code>/</code>前面写替换的字符串，然后<code>g</code>结尾</p><p>特殊字符用<code>\</code>进行转义，包括<code>空格</code>和<code>[]&#123;&#125;().\</code>~!@#$%^&amp;*_+-=;:’”&lt;&gt;,?`之类的，总之就是会影响正则的都要进行转义</p><h3 id="docker-compose-yml"><a href="#docker-compose-yml" class="headerlink" title="docker-compose.yml"></a>docker-compose.yml</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">&quot;3.3&quot;</span><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">qbittorrent:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">ghcr.io/linuxserver/qbittorrent:amd64-latest</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">qbittorrent</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PUID=1000</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PGID=1000</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">TZ=Asia/Shanghai</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">UMASK_SET=022</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">WEBUI_PORT=8008</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/nas/opt/qbittorrent/config:/config</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/nas:/downloads</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">6969</span><span class="hljs-string">:6969</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">6969</span><span class="hljs-string">:6969/udp</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">8008</span><span class="hljs-string">:8008</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">deploy:</span><br>      <span class="hljs-attr">resources:</span><br>        <span class="hljs-attr">limits:</span><br>          <span class="hljs-attr">cpus:</span> <span class="hljs-string">&#x27;0.5&#x27;</span><br>          <span class="hljs-attr">memory:</span> <span class="hljs-string">200M</span><br>  <span class="hljs-attr">home-assistant:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">homeassistant/home-assistant:2020.12.1</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">home-assistant</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PUID=1000</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PGID=1000</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">TZ=Asia/Shanghai</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/etc/localtime:/etc/localtime:ro</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/nas/opt/home-assistant/config:/config</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">network_mode:</span> <span class="hljs-string">&#x27;host&#x27;</span><br>    <span class="hljs-attr">deploy:</span><br>      <span class="hljs-attr">resources:</span><br>        <span class="hljs-attr">limits:</span><br>          <span class="hljs-attr">cpus:</span> <span class="hljs-string">&#x27;0.5&#x27;</span><br>          <span class="hljs-attr">memory:</span> <span class="hljs-string">200M</span><br>  <span class="hljs-attr">syncthing:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">ghcr.io/linuxserver/syncthing</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">syncthing</span><br>    <span class="hljs-attr">hostname:</span> <span class="hljs-string">syncthing</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PUID=1000</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PGID=1000</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">TZ=Asia/Shanghai</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/nas/syncthing:/config</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">8384</span><span class="hljs-string">:8384</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">22000</span><span class="hljs-string">:22000</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">21027</span><span class="hljs-string">:21027/udp</span><br>    <span class="hljs-attr">deploy:</span><br>      <span class="hljs-attr">resources:</span><br>        <span class="hljs-attr">limits:</span><br>          <span class="hljs-attr">cpus:</span> <span class="hljs-string">&#x27;0.5&#x27;</span><br>          <span class="hljs-attr">memory:</span> <span class="hljs-string">256M</span><br><span class="hljs-attr">networks:</span><br>  <span class="hljs-attr">default:</span><br>    <span class="hljs-attr">external:</span><br>      <span class="hljs-attr">name:</span> <span class="hljs-string">pve-subnet</span><br></code></pre></td></tr></table></figure><p>启动<code>start.sh</code>文件里，直接使用<code>bash start.sh</code>启动。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker-compose --compatibility -f docker-compose.yml up -d<br></code></pre></td></tr></table></figure><p>停止了<code>stop.sh</code>文件里，直接使用<code>bash stop.sh</code>停止。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker-compose --compatibility down<br></code></pre></td></tr></table></figure><p>增加<code>--compatibility</code>参数是因为docker不是swam的模式的情况下，<code>deploy</code>节点下对资源的限制是不起作用的。</p>]]></content>
    
    
    <categories>
      
      <category>家庭服务</category>
      
    </categories>
    
    
    <tags>
      
      <tag>NAS</tag>
      
      <tag>Jellyfin</tag>
      
      <tag>Proxmox VE</tag>
      
      <tag>PVE</tag>
      
      <tag>docker</tag>
      
      <tag>docker-compose</tag>
      
      <tag>homeassistan</tag>
      
      <tag>小米</tag>
      
      <tag>格力</tag>
      
      <tag>qBittorrent</tag>
      
      <tag>松花江</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>架构蓝皮书(基础版)</title>
    <link href="/2019/07/16/Architecture.html"/>
    <url>/2019/07/16/Architecture.html</url>
    
    <content type="html"><![CDATA[<p>组织架构</p><p>DevOps</p><p>K8S</p><p>Docker</p><p>Git</p><h1 id="工欲善其事，必先利其器"><a href="#工欲善其事，必先利其器" class="headerlink" title="工欲善其事，必先利其器"></a>工欲善其事，必先利其器</h1><h2 id="云"><a href="#云" class="headerlink" title="云"></a>云</h2><p>首先，当一个团队开始的时候需要有装备，硬件装备是桌椅板凳电脑网络，开发过程中需要测试环境，代码管理工具等。此时，一个局域网内的私有云就够了。但是考虑到外出和在家办公的场景，那么<a href="https://www.aliyun.com/">Aliyun</a>、Google云等这类的线上云是一个更好的选择，而且，再做CI/CD的时候会更方便一些。然而弊端就是需要额外的支出。</p><p>代码管理工具，一般是<a href="https://github.com/">GitHub</a>，<a href="https://about.gitlab.com/">GitLab</a>，<a href="https://azure.microsoft.com/zh-cn/services/devops/">Azure DevOps</a>，这里推荐Azure DevOps。</p><h2 id="敏捷"><a href="#敏捷" class="headerlink" title="敏捷"></a>敏捷</h2><p>一个团队，再项目进程中需要一个合理的管理，节点日期，任务管理分配，时间计算等，一个有效率的团队不应该是一个大的团队，即使有了大的团队，也应该根据不同的场景进行拆分，目前看来，一个敏捷团队再3人以上，7人一下应该是比较合理的，7人以上应该也没问题，但是个人感觉，效率可能会有个折扣。</p><p>敏捷团队要做什么？按照以往的文章与成书中描述，是透明，检验，适应。</p><h3 id="透明"><a href="#透明" class="headerlink" title="透明"></a>透明</h3><p>透明是指在开发环节中保持高度的可见性，所有的成员都应该知道和理解进度和要做的内容。</p><h3 id="检验"><a href="#检验" class="headerlink" title="检验"></a>检验</h3><p>开发过程中要做到足够的检验，用以确保开发过程中能够及时的发现重大偏差以及错误。</p><h3 id="适应"><a href="#适应" class="headerlink" title="适应"></a>适应</h3><p>在上面的检验中发现了重大的偏差以及错误，那么应该即使的调整并纠正，来检查偏差以及错误带来的损失。</p><h3 id="敏捷怎么做"><a href="#敏捷怎么做" class="headerlink" title="敏捷怎么做"></a>敏捷怎么做</h3><p>敏捷中有3个角色，分别是PO（产品负责人），SM（敏捷大师），Dev（开发人员）。</p><h4 id="产品负责人"><a href="#产品负责人" class="headerlink" title="产品负责人"></a>产品负责人</h4><h4 id="开发团队"><a href="#开发团队" class="headerlink" title="开发团队"></a>开发团队</h4><h4 id="敏捷大师"><a href="#敏捷大师" class="headerlink" title="敏捷大师"></a>敏捷大师</h4><h4 id="误区"><a href="#误区" class="headerlink" title="误区"></a>误区</h4><p>敏捷模式不是万能的，而且不应该为了敏捷而敏捷，在开发过程中，应该根据团队自身情况对敏捷进行调整，例如由PO担任SM的角色也是可以的。</p><h2 id="微服务"><a href="#微服务" class="headerlink" title="微服务"></a>微服务</h2><p>微服务，将业务划分为最小单位，彼此独立，充分的解耦，语言无关性，一个最小化的服务可以是任意的语言进行开发，采用http或者rpc在服务之间进行交互。部署简单，对某一个服务进行升级的时候不会影响整个环境，甚至在某些集群中可以做到无感切换。</p><p>敏捷是最适合微服务开发的一种模式。</p><h1 id="Azure-DevOps"><a href="#Azure-DevOps" class="headerlink" title="Azure DevOps"></a>Azure DevOps</h1><p><a href="https://azure.microsoft.com/zh-cn/services/devops/">Azure DevOps</a>免费提供线上的版本，好处是一直使用到最新的版本，但是没有足够的本地化，当然也免去了多余的费用。</p><p>另外，<a href="https://azure.microsoft.com/zh-cn/services/devops/">Azure DevOps</a>还提供了<a href="https://go.microsoft.com/fwlink/?LinkId=2041267&clcid=0x804">本地服务器版本</a>,下载后直接在本地的服务器安装就可以使用了。</p><blockquote><p>它能做什么</p><ol><li>它提供了交互较好的板管理，并且很大程度上可以进行自定义</li><li>它有完整的长篇故事，积压工作项，任务，bug的管理</li><li>并且仓储支持Git以及VSTS自身的仓储管理</li><li>而且可以安装很多插件</li><li>还有WebHook可以有一系列的事件触发</li><li>可以接入很多第三方服务</li></ol></blockquote><p>对于使用Visual Studio进行开发的团队，Azure DevOps是一个不二选择。</p><h1 id="DDD"><a href="#DDD" class="headerlink" title="DDD"></a>DDD</h1><p>DDD,被称作为领域驱动设计，做了这么久，其实最大的难点在于聚合根的设计上，总是会出现不恰当的存在。</p><h1 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h1><h1 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h1><h1 id="CQRS"><a href="#CQRS" class="headerlink" title="CQRS"></a>CQRS</h1><h2 id="EventSource"><a href="#EventSource" class="headerlink" title="EventSource"></a>EventSource</h2><h1 id="Net-Core"><a href="#Net-Core" class="headerlink" title=".Net Core"></a>.Net Core</h1><h2 id="健康检查"><a href="#健康检查" class="headerlink" title="健康检查"></a>健康检查</h2><p>.Net Core默认已经支持了健康检查，只要在代码中开启功能就可以了</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> IServiceProvider <span class="hljs-title">ConfigureServices</span>(<span class="hljs-params">IServiceCollection services</span>)</span>&#123;<br>    ...<br>    services.AddHealthChecks();<br>    ...<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Configure</span>(<span class="hljs-params">IApplicationBuilder app</span>)</span> &#123;<br>    ...<br>    app.UseHealthChecks(<span class="hljs-string">&quot;/hc&quot;</span>, <span class="hljs-keyword">new</span> HealthCheckOptions<br>    &#123;<br>        ResultStatusCodes =<br>        &#123;<br>            [<span class="hljs-meta">Microsoft.Extensions.Diagnostics.HealthChecks.HealthStatus.Healthy</span>] = StatusCodes.Status200OK,<br>            [<span class="hljs-meta">Microsoft.Extensions.Diagnostics.HealthChecks.HealthStatus.Degraded</span>] = StatusCodes.Status200OK,<br>            [<span class="hljs-meta">Microsoft.Extensions.Diagnostics.HealthChecks.HealthStatus.Unhealthy</span>] = StatusCodes.Status503ServiceUnavailable<br>        &#125;<br>    &#125;);<br>    <span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span>    ...</span><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="CQRS-1"><a href="#CQRS-1" class="headerlink" title="CQRS"></a>CQRS</h2><h2 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h2><h2 id="多版本API"><a href="#多版本API" class="headerlink" title="多版本API"></a>多版本API</h2><h2 id="Swagger"><a href="#Swagger" class="headerlink" title="Swagger"></a>Swagger</h2><h2 id="消息队列"><a href="#消息队列" class="headerlink" title="消息队列"></a>消息队列</h2><h3 id="消息中心"><a href="#消息中心" class="headerlink" title="消息中心"></a>消息中心</h3><h2 id="Gateway"><a href="#Gateway" class="headerlink" title="Gateway"></a>Gateway</h2><h1 id="集群"><a href="#集群" class="headerlink" title="集群"></a>集群</h1><h2 id="Docker-Swarm"><a href="#Docker-Swarm" class="headerlink" title="Docker Swarm"></a>Docker Swarm</h2><h2 id="kubernetes"><a href="#kubernetes" class="headerlink" title="kubernetes"></a>kubernetes</h2><h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><p><a href="https://github.com/ojdev/NetCoreTemplate">一个框架</a> 它不一定是对的，但是它有参考价值。</p>]]></content>
    
    
    <categories>
      
      <category>DevOps</category>
      
    </categories>
    
    
    <tags>
      
      <tag>架构</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>windows-terminal</title>
    <link href="/2019/06/25/windows-terminal.html"/>
    <url>/2019/06/25/windows-terminal.html</url>
    
    <content type="html"><![CDATA[<h2 id="windows-terminal"><a href="#windows-terminal" class="headerlink" title="windows-terminal"></a>windows-terminal</h2><p>windows-terminal发布了，虽然只是预览版，目前还是很简单的部分功能，从windows商店中直接搜windows-terminal就能安装，前提是windows10已经升级1903.</p><h2 id="1903-中的-wsl"><a href="#1903-中的-wsl" class="headerlink" title="1903 中的 wsl"></a>1903 中的 wsl</h2><p>经过一个下午的摸索，大致了解了一些简单的用法，推荐安装wsl版的debian或者ubuntu，开启linux子系统后在windows商店中搜索ubuntu或者debian安装就可以了。安装完成后启动一下，推荐debian，小巧，一共73m，ubuntu18要200多m。</p><p>wsl终端体验也很好，cmd中使用ssh登录经常会出现乱行的问题，wsl中则没有这个现象，而且，目前的wsl中很多操作可以对windows本身进行修改。缺什么也可以指直接使用linux的方式安装，而写windows的秋季更新中的wsl 2.0docker可以与windows中的互通。</p><p>这样一来也免了安装cygwin或者chocolatey了。</p><p>新版的vscode好像也只是直接使用wsl来进行控制台操作了，不过目前好像还是预览版中的功能。</p><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>因为目前没有配置界面，所有的设置都是一个json文档，所以这里稍微的解释一下配置方法。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;globals&quot;</span> : <br>    &#123;<br>        <span class="hljs-attr">&quot;alwaysShowTabs&quot;</span> : <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">&quot;defaultProfile&quot;</span> : <span class="hljs-string">&quot;&#123;c6eaf9f4-32a7-5fdc-b5cf-066e8a4b1e40&#125;&quot;</span>, <span class="hljs-comment">//profiles节点中的guid，表示默认打开那个命令行</span><br>        <span class="hljs-attr">&quot;initialCols&quot;</span> : <span class="hljs-number">120</span>,<br>        <span class="hljs-attr">&quot;initialRows&quot;</span> : <span class="hljs-number">30</span>,<br>        <span class="hljs-attr">&quot;keybindings&quot;</span> : <br>        [<br>            <span class="hljs-comment">//这部分是快捷键</span><br>        ],<br>        <span class="hljs-attr">&quot;requestedTheme&quot;</span> : <span class="hljs-string">&quot;system&quot;</span>,<br>        <span class="hljs-attr">&quot;showTabsInTitlebar&quot;</span> : <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">&quot;showTerminalTitleInTitlebar&quot;</span> : <span class="hljs-literal">true</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;profiles&quot;</span> : <br>    [<br>        &#123;<br>            <span class="hljs-attr">&quot;acrylicOpacity&quot;</span> : <span class="hljs-number">0.5</span>, <span class="hljs-comment">//毛玻璃效果的透明度，推荐0.75</span><br>            <span class="hljs-attr">&quot;background&quot;</span> : <span class="hljs-string">&quot;#012456&quot;</span>,<br>            <span class="hljs-attr">&quot;closeOnExit&quot;</span> : <span class="hljs-literal">true</span>,<br>            <span class="hljs-attr">&quot;colorScheme&quot;</span> : <span class="hljs-string">&quot;Campbell&quot;</span>, <span class="hljs-comment">//对应schemes节点中的配色方案，默认这个算是好看的，其他的还是难看了点</span><br>            <span class="hljs-attr">&quot;commandline&quot;</span> : <span class="hljs-string">&quot;powershell.exe&quot;</span>,<br>            <span class="hljs-attr">&quot;cursorColor&quot;</span> : <span class="hljs-string">&quot;#FFFFFF&quot;</span>,<br>            <span class="hljs-attr">&quot;cursorShape&quot;</span> : <span class="hljs-string">&quot;bar&quot;</span>,<br>            <span class="hljs-attr">&quot;fontFace&quot;</span> : <span class="hljs-string">&quot;Consolas&quot;</span>,<br>            <span class="hljs-attr">&quot;fontSize&quot;</span> : <span class="hljs-number">10</span>,<br>            <span class="hljs-attr">&quot;guid&quot;</span> : <span class="hljs-string">&quot;&#123;61c54bbd-c2c6-5271-96e7-009a87ff44bf&#125;&quot;</span>, <span class="hljs-comment">//id用来做标识</span><br>            <span class="hljs-attr">&quot;historySize&quot;</span> : <span class="hljs-number">9001</span>,<br>            <span class="hljs-attr">&quot;icon&quot;</span> : <span class="hljs-string">&quot;ms-appx:///ProfileIcons/&#123;61c54bbd-c2c6-5271-96e7-009a87ff44bf&#125;.png&quot;</span>, <span class="hljs-comment">//图标这中间的id不需要与guid对应。</span><br>            <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;Windows PowerShell&quot;</span>, <span class="hljs-comment">//显示的名字</span><br>            <span class="hljs-attr">&quot;padding&quot;</span> : <span class="hljs-string">&quot;0, 0, 0, 0&quot;</span>,<br>            <span class="hljs-attr">&quot;snapOnInput&quot;</span> : <span class="hljs-literal">true</span>,<br>            <span class="hljs-attr">&quot;startingDirectory&quot;</span> : <span class="hljs-string">&quot;%USERPROFILE%&quot;</span>,  <span class="hljs-comment">//默认打开命令行窗口定位到的路径</span><br>            <span class="hljs-attr">&quot;useAcrylic&quot;</span> : <span class="hljs-literal">true</span>  <span class="hljs-comment">//是否打开毛玻璃效果</span><br>        &#125;,<br>        &#123;<br>            <span class="hljs-attr">&quot;acrylicOpacity&quot;</span> : <span class="hljs-number">0.75</span>,<br>            <span class="hljs-attr">&quot;closeOnExit&quot;</span> : <span class="hljs-literal">true</span>,<br>            <span class="hljs-attr">&quot;colorScheme&quot;</span> : <span class="hljs-string">&quot;Campbell&quot;</span>,<br>            <span class="hljs-attr">&quot;commandline&quot;</span> : <span class="hljs-string">&quot;cmd.exe&quot;</span>,<br>            <span class="hljs-attr">&quot;cursorColor&quot;</span> : <span class="hljs-string">&quot;#FFFFFF&quot;</span>,<br>            <span class="hljs-attr">&quot;cursorShape&quot;</span> : <span class="hljs-string">&quot;bar&quot;</span>,<br>            <span class="hljs-attr">&quot;fontFace&quot;</span> : <span class="hljs-string">&quot;Consolas&quot;</span>,<br>            <span class="hljs-attr">&quot;fontSize&quot;</span> : <span class="hljs-number">10</span>,<br>            <span class="hljs-attr">&quot;guid&quot;</span> : <span class="hljs-string">&quot;&#123;0caa0dad-35be-5f56-a8ff-afceeeaa6101&#125;&quot;</span>,<br>            <span class="hljs-attr">&quot;historySize&quot;</span> : <span class="hljs-number">9001</span>,<br>            <span class="hljs-attr">&quot;icon&quot;</span> : <span class="hljs-string">&quot;ms-appx:///ProfileIcons/&#123;0caa0dad-35be-5f56-a8ff-afceeeaa6101&#125;.png&quot;</span>,<br>            <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;cmd&quot;</span>,<br>            <span class="hljs-attr">&quot;padding&quot;</span> : <span class="hljs-string">&quot;0, 0, 0, 0&quot;</span>,<br>            <span class="hljs-attr">&quot;snapOnInput&quot;</span> : <span class="hljs-literal">true</span>,<br>            <span class="hljs-attr">&quot;startingDirectory&quot;</span> : <span class="hljs-string">&quot;%USERPROFILE%&quot;</span>,<br>            <span class="hljs-attr">&quot;useAcrylic&quot;</span> : <span class="hljs-literal">true</span><br>        &#125;,<br>        &#123;<br>            <span class="hljs-attr">&quot;acrylicOpacity&quot;</span> : <span class="hljs-number">0.75</span>,<br>            <span class="hljs-attr">&quot;closeOnExit&quot;</span> : <span class="hljs-literal">true</span>,<br>            <span class="hljs-attr">&quot;colorScheme&quot;</span> : <span class="hljs-string">&quot;One Half Dark&quot;</span>,<br>            <span class="hljs-attr">&quot;commandline&quot;</span> : <span class="hljs-string">&quot;wsl.exe -d Debian&quot;</span>,<br>            <span class="hljs-attr">&quot;cursorColor&quot;</span> : <span class="hljs-string">&quot;#FFFFFF&quot;</span>,<br>            <span class="hljs-attr">&quot;cursorShape&quot;</span> : <span class="hljs-string">&quot;bar&quot;</span>,<br>            <span class="hljs-attr">&quot;fontFace&quot;</span> : <span class="hljs-string">&quot;Consolas&quot;</span>,<br>            <span class="hljs-attr">&quot;fontSize&quot;</span> : <span class="hljs-number">10</span>,<br>            <span class="hljs-attr">&quot;guid&quot;</span> : <span class="hljs-string">&quot;&#123;c6eaf9f4-32a7-5fdc-b5cf-066e8a4b1e40&#125;&quot;</span>,<br>            <span class="hljs-attr">&quot;historySize&quot;</span> : <span class="hljs-number">9001</span>,<br>            <span class="hljs-attr">&quot;icon&quot;</span> : <span class="hljs-string">&quot;ms-appx:///ProfileIcons/&#123;9acb9455-ca41-5af7-950f-6bca1bc9722f&#125;.png&quot;</span>,<br>            <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;Debian&quot;</span>,<br>            <span class="hljs-attr">&quot;padding&quot;</span> : <span class="hljs-string">&quot;0, 0, 0, 0&quot;</span>,<br>            <span class="hljs-attr">&quot;snapOnInput&quot;</span> : <span class="hljs-literal">true</span>,<br>            <span class="hljs-attr">&quot;startingDirectory&quot;</span> : <span class="hljs-string">&quot;%USERPROFILE%&quot;</span>,<br>            <span class="hljs-attr">&quot;useAcrylic&quot;</span> : <span class="hljs-literal">true</span><br>        &#125;,<br>        &#123;<br>            <span class="hljs-attr">&quot;acrylicOpacity&quot;</span> : <span class="hljs-number">0.75</span>,<br>            <span class="hljs-attr">&quot;closeOnExit&quot;</span> : <span class="hljs-literal">true</span>,<br>            <span class="hljs-attr">&quot;colorScheme&quot;</span> : <span class="hljs-string">&quot;Campbell&quot;</span>,<br>            <span class="hljs-attr">&quot;commandline&quot;</span> : <span class="hljs-string">&quot;wsl.exe -d Debian -u root&quot;</span>,  <span class="hljs-comment">//用root用户的形式启动wsl</span><br>            <span class="hljs-attr">&quot;cursorColor&quot;</span> : <span class="hljs-string">&quot;#FFFFFF&quot;</span>,<br>            <span class="hljs-attr">&quot;cursorShape&quot;</span> : <span class="hljs-string">&quot;bar&quot;</span>,<br>            <span class="hljs-attr">&quot;fontFace&quot;</span> : <span class="hljs-string">&quot;Consolas&quot;</span>,<br>            <span class="hljs-attr">&quot;fontSize&quot;</span> : <span class="hljs-number">10</span>,<br>            <span class="hljs-attr">&quot;guid&quot;</span> : <span class="hljs-string">&quot;&#123;c6eaf9f4-32a7-5fdc-b5cf-066e8a4b1e41&#125;&quot;</span>,<br>            <span class="hljs-attr">&quot;historySize&quot;</span> : <span class="hljs-number">9001</span>,<br>            <span class="hljs-attr">&quot;icon&quot;</span> : <span class="hljs-string">&quot;ms-appx:///ProfileIcons/&#123;9acb9455-ca41-5af7-950f-6bca1bc9722f&#125;.png&quot;</span>,<br>            <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;Debian(root)&quot;</span>,<br>            <span class="hljs-attr">&quot;padding&quot;</span> : <span class="hljs-string">&quot;0, 0, 0, 0&quot;</span>,<br>            <span class="hljs-attr">&quot;snapOnInput&quot;</span> : <span class="hljs-literal">true</span>,<br>            <span class="hljs-attr">&quot;startingDirectory&quot;</span> : <span class="hljs-string">&quot;%USERPROFILE%&quot;</span>,<br>            <span class="hljs-attr">&quot;useAcrylic&quot;</span> : <span class="hljs-literal">true</span><br>        &#125;,<br>        &#123;<br>            <span class="hljs-comment">//这个条目是我自己添加的</span><br>            <span class="hljs-attr">&quot;acrylicOpacity&quot;</span> : <span class="hljs-number">0.75</span>,<br>            <span class="hljs-attr">&quot;closeOnExit&quot;</span> : <span class="hljs-literal">true</span>,<br>            <span class="hljs-attr">&quot;colorScheme&quot;</span> : <span class="hljs-string">&quot;Campbell&quot;</span>,<br>            <span class="hljs-attr">&quot;commandline&quot;</span> : <span class="hljs-string">&quot;wsl.exe -d Debian -u root -e ssh root@***.***.***.***&quot;</span>,  <span class="hljs-comment">//启动一个ssh，如果在wsl中已经做了免密登录，则会直接进入ssh中</span><br>            <span class="hljs-attr">&quot;cursorColor&quot;</span> : <span class="hljs-string">&quot;#FFFFFF&quot;</span>,<br>            <span class="hljs-attr">&quot;cursorShape&quot;</span> : <span class="hljs-string">&quot;bar&quot;</span>,<br>            <span class="hljs-attr">&quot;fontFace&quot;</span> : <span class="hljs-string">&quot;Consolas&quot;</span>,<br>            <span class="hljs-attr">&quot;fontSize&quot;</span> : <span class="hljs-number">10</span>,<br>            <span class="hljs-attr">&quot;guid&quot;</span> : <span class="hljs-string">&quot;&#123;c6eaf9f4-32a7-5fdc-b5cf-066e8a4b1e42&#125;&quot;</span>,<span class="hljs-comment">//id修改一下，随便改一下就可以，只要满足guid规则。</span><br>            <span class="hljs-attr">&quot;historySize&quot;</span> : <span class="hljs-number">9001</span>,<br>            <span class="hljs-attr">&quot;icon&quot;</span> : <span class="hljs-string">&quot;ms-appx:///ProfileIcons/&#123;9acb9455-ca41-5af7-950f-6bca1bc9722f&#125;.png&quot;</span>,<br>            <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;ssh(root)&quot;</span>,<br>            <span class="hljs-attr">&quot;padding&quot;</span> : <span class="hljs-string">&quot;0, 0, 0, 0&quot;</span>,<br>            <span class="hljs-attr">&quot;snapOnInput&quot;</span> : <span class="hljs-literal">true</span>,<br>            <span class="hljs-attr">&quot;startingDirectory&quot;</span> : <span class="hljs-string">&quot;%USERPROFILE%&quot;</span>,<br>            <span class="hljs-attr">&quot;useAcrylic&quot;</span> : <span class="hljs-literal">true</span><br>        &#125;<br>    ],<br>    <span class="hljs-attr">&quot;schemes&quot;</span> : <br>    [<br>        &#123;<br>            <span class="hljs-attr">&quot;background&quot;</span> : <span class="hljs-string">&quot;#0C0C0C&quot;</span>,<br>            <span class="hljs-attr">&quot;black&quot;</span> : <span class="hljs-string">&quot;#0C0C0C&quot;</span>,<br>            <span class="hljs-attr">&quot;blue&quot;</span> : <span class="hljs-string">&quot;#0037DA&quot;</span>,<br>            <span class="hljs-attr">&quot;brightBlack&quot;</span> : <span class="hljs-string">&quot;#767676&quot;</span>,<br>            <span class="hljs-attr">&quot;brightBlue&quot;</span> : <span class="hljs-string">&quot;#3B78FF&quot;</span>,<br>            <span class="hljs-attr">&quot;brightCyan&quot;</span> : <span class="hljs-string">&quot;#61D6D6&quot;</span>,<br>            <span class="hljs-attr">&quot;brightGreen&quot;</span> : <span class="hljs-string">&quot;#16C60C&quot;</span>,<br>            <span class="hljs-attr">&quot;brightPurple&quot;</span> : <span class="hljs-string">&quot;#B4009E&quot;</span>,<br>            <span class="hljs-attr">&quot;brightRed&quot;</span> : <span class="hljs-string">&quot;#E74856&quot;</span>,<br>            <span class="hljs-attr">&quot;brightWhite&quot;</span> : <span class="hljs-string">&quot;#F2F2F2&quot;</span>,<br>            <span class="hljs-attr">&quot;brightYellow&quot;</span> : <span class="hljs-string">&quot;#F9F1A5&quot;</span>,<br>            <span class="hljs-attr">&quot;cyan&quot;</span> : <span class="hljs-string">&quot;#3A96DD&quot;</span>,<br>            <span class="hljs-attr">&quot;foreground&quot;</span> : <span class="hljs-string">&quot;#F2F2F2&quot;</span>,<br>            <span class="hljs-attr">&quot;green&quot;</span> : <span class="hljs-string">&quot;#13A10E&quot;</span>,<br>            <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;Campbell&quot;</span>,<br>            <span class="hljs-attr">&quot;purple&quot;</span> : <span class="hljs-string">&quot;#881798&quot;</span>,<br>            <span class="hljs-attr">&quot;red&quot;</span> : <span class="hljs-string">&quot;#C50F1F&quot;</span>,<br>            <span class="hljs-attr">&quot;white&quot;</span> : <span class="hljs-string">&quot;#CCCCCC&quot;</span>,<br>            <span class="hljs-attr">&quot;yellow&quot;</span> : <span class="hljs-string">&quot;#C19C00&quot;</span><br>        &#125;,<br>        <span class="hljs-comment">//其他配色方案</span><br>    ]<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>收集</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows-terminal</tag>
      
      <tag>wsl</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>在AzureDevops中集成SonarQube</title>
    <link href="/2019/06/12/SonarQube.html"/>
    <url>/2019/06/12/SonarQube.html</url>
    
    <content type="html"><![CDATA[<p><a href="http://www.sonarqube.org/">SonarQube</a>是管理代码质量的一个平台，有商业版也可以本地部署。</p><h2 id="部署SonarQube"><a href="#部署SonarQube" class="headerlink" title="部署SonarQube"></a>部署SonarQube</h2><blockquote><p><a href="http://www.sonarqube.org/">SonarQube</a>需要Jdk的支持；</p><p>ElasticSearch是可选的；</p><p>数据库使用jdbc；</p></blockquote><p>本内容使用Docker进行部署</p><h2 id="docker-compose-yaml"><a href="#docker-compose-yaml" class="headerlink" title="docker-compose.yaml"></a>docker-compose.yaml</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">&quot;3&quot;</span><br><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">CodeQuality.SonarQube:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">sonarqube:lts</span>  <span class="hljs-comment">##新版，7.x只能对master分支进行分析，需要商业授权</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">codequality-sonarqube</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">SONARQUBE_JDBC_USERNAME=$&#123;DB_POSTGRESQL_USER&#125;</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">SONARQUBE_JDBC_PASSWORD=$&#123;DB_POSTGRESQL_PASS&#125;</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">SONARQUBE_JDBC_URL=jdbc:postgresql://$&#123;DB_POSTGRESQL_URL_AND_PORT&#125;/sonar</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;2303:9000&quot;</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;2302:9002&quot;</span>    <br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;/etc/timezone:/etc/timezone&quot;</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;/etc/localtime:/etc/localtime&quot;</span>          <br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br></code></pre></td></tr></table></figure><p>这里使用了pgsql。</p><p>部署完成后要进行配置，用admin进行登录，点击右上角头像，选择我的账户-&gt;安全</p><p>在令牌下输入一个令牌名选择”生成”,复制生成的令牌。<br><img src="/images/2019/06/12/1.png"></p><h2 id="AzureDevops"><a href="#AzureDevops" class="headerlink" title="AzureDevops"></a>AzureDevops</h2><p>在AzureDevops中安装<a href="https://marketplace.visualstudio.com/items?itemName=SonarSource.sonarqube">SonarQube</a></p><p>进入azure devops中，进入项目，进入到设置中的服务连接，新建服务连接中找到SonarQube服务连接，输入任意的名称，Server Url输入http://[部署的地址]:2303,Token输入刚刚生成的令牌，保存即可。<br><img src="/images/2019/06/12/2.png"><br>以.net core生成PR审阅的时候顺便做代码质量检测举例，其他的项目有些麻烦。</p><ol><li>在生成定义中添加任务<code>Prepare Analysis Configuration</code></li><li>在<code>SonarQube Server Endpoint</code>中选择我们刚刚创建的服务连接</li><li>ProjectKey中填入一个名字，推荐使用<code>$(Build.Repository.Name)</code>用仓储的名字</li><li>Project Name可以留空</li><li>Project Version写一个版本号，推荐使用<code>PR$(Build.BuildNumber)</code><br>以上推荐做成任务组。</li></ol><p>继续添加.net core生成过程，Restore、Build、Test、项目路径要选择成解决方案文件。</p><p>然后添加任务<code>Run Code Analysis</code></p><p>添加任务<code>Publish Quality Gate Result</code></p><p>这样，在每次PR生成的时候就会自动去做代码质量检测，商业版授权，会将检测中的不合理内容直接更新到PR中，非商业代理则需要登录SonarQube去查看。</p><p>一下是实际的应用</p><h2 id="定义任务组"><a href="#定义任务组" class="headerlink" title="定义任务组"></a>定义任务组</h2><p><img src="/images/2019/06/12/3.png"><br><img src="/images/2019/06/12/4.png"></p><h2 id="实际应用"><a href="#实际应用" class="headerlink" title="实际应用"></a>实际应用</h2><p><img src="/images/2019/06/12/5.png"><br><img src="/images/2019/06/12/6.png"></p>]]></content>
    
    
    <categories>
      
      <category>DevOps</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DevOps</tag>
      
      <tag>Azure DevOps</tag>
      
      <tag>SonarQube</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>k8s的环境搭建</title>
    <link href="/2019/06/03/kubernetes-for-debian.html"/>
    <url>/2019/06/03/kubernetes-for-debian.html</url>
    
    <content type="html"><![CDATA[<p>依然是模拟环境，使用windows10的hyperV。</p><p>在虚拟机中安装debian9，只要核心的那种，开openssh的。</p><p>更新debian</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">apt update<br>apt upgrade -y<br></code></pre></td></tr></table></figure><h2 id="开启root的ssh登录"><a href="#开启root的ssh登录" class="headerlink" title="开启root的ssh登录"></a>开启root的ssh登录</h2><p>修改<code>/etc/ssh/sshd_config</code>中的 <code>PermitRootLogin</code>为<code>PermitRootLogin yes</code>，保存<br>然后重启<code>/etc/init.d/ssh restart</code><br>非必须</p><h2 id="关闭交换内存"><a href="#关闭交换内存" class="headerlink" title="关闭交换内存"></a>关闭交换内存</h2><blockquote><p>kubernetes 的想法是将实例紧密包装到尽可能接近100％。 所有的部署应该与 CPU 和内存限制固定在一起。 所以如果调度程序发送一个 pod 到一台机器，它不应该使用交换，设计者不想交换，因为它会减慢速度，所以关闭 swap 主要是为了性能考虑。当然为了一些节省资源的场景，比如运行容器数量较多，可添加 kubelet 参数 –fail-swap-on=false 来解决。</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">swapoff -a <br>nano /etc/fstab<br></code></pre></td></tr></table></figure><p>找到swap was on /dev/sda3 during installation<br>把下面的/dev开头的注释掉</p><p>或者在init的时候使用参数<code>kubeadm init --ignore-preflight-errors Swap</code></p><h2 id="然后安装k8s的aliyun源"><a href="#然后安装k8s的aliyun源" class="headerlink" title="然后安装k8s的aliyun源"></a>然后安装<a href="https://opsx.alibaba.com/mirror?lang=zh-CN">k8s的aliyun源</a></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">apt-get update &amp;&amp; apt-get install -y apt-transport-https<br>curl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | apt-key add - <br>cat &lt;&lt;EOF &gt;/etc/apt/sources.list.d/kubernetes.list<br>deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main<br>EOF  <br>apt-get update<br>apt-get install -y kubelet kubeadm kubectl<br>apt-mark hold kubelet kubeadm kubectl<br></code></pre></td></tr></table></figure><h2 id="添加docker源"><a href="#添加docker源" class="headerlink" title="添加docker源"></a>添加docker源</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">curl -fsSL https://download.docker.com/linux/debian/gpg | apt-key add -<br><br>cat &lt;&lt;EOF&gt;/etc/apt/sources.list.d/docker.list<br>deb [arch=amd64] https://download.docker.com/linux/debian stretch stable<br>EOF<br>apt update<br>apt install -y docker-ce<br></code></pre></td></tr></table></figure><h2 id="添加docker的aliyun镜像源参考"><a href="#添加docker的aliyun镜像源参考" class="headerlink" title="添加docker的aliyun镜像源参考"></a>添加docker的aliyun镜像源<a href="https://kubernetes.io/docs/setup/cri/">参考</a></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat &lt;&lt;EOF&gt;/etc/docker/daemon.json<br>&#123;<br>  &quot;registry-mirrors&quot;: [&quot;https://********.mirror.aliyuncs.com&quot;],<br>  &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;],<br>  &quot;log-driver&quot;: &quot;json-file&quot;,<br>  &quot;log-opts&quot;: &#123;<br>    &quot;max-size&quot;: &quot;100m&quot;<br>  &#125;,<br>  &quot;storage-driver&quot;: &quot;overlay2&quot;<br>&#125;<br>EOF<br>mkdir -p /etc/systemd/system/docker.service.d<br>systemctl daemon-reload<br>systemctl restart docker<br>systemctl enable docker<br></code></pre></td></tr></table></figure><p>重启系统，让所有配置生效。</p><h2 id="开始集群初始化"><a href="#开始集群初始化" class="headerlink" title="开始集群初始化"></a>开始集群初始化</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubeadm init --image-repository registry.cn-hangzhou.aliyuncs.com/google_containers<br></code></pre></td></tr></table></figure><p><code>--image-repository</code>指定拉取镜像的地址，避免从google无法访问的情况<br>成功后的内容</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs shell">Your Kubernetes control-plane has initialized successfully!<br><br>To start using your cluster, you need to run the following as a regular user:<br><br>  mkdir -p $HOME/.kube<br>  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config<br>  sudo chown $(id -u):$(id -g) $HOME/.kube/config<br><br>You should now deploy a pod network to the cluster.<br>Run &quot;kubectl apply -f [podnetwork].yaml&quot; with one of the options listed at:<br>  https://kubernetes.io/docs/concepts/cluster-administration/addons/<br><br>Then you can join any number of worker nodes by running the following on each as root:<br><br>kubeadm join 172.17.183.236:6443 --token 4xr9ys.yxaxewry4xarkghy \<br>    --discovery-token-ca-cert-hash sha256:3a73933bfd0fb5e2fe2e045292a395d55c652e9e8a141111335b1710350f9d37<br><br></code></pre></td></tr></table></figure><p>创建成功后根据提示进行操作，记录最下面的链接语句，以备其他节点接入。</p><h2 id="安装Helm"><a href="#安装Helm" class="headerlink" title="安装Helm"></a>安装Helm</h2><p>先去<a href="https://github.com/helm/helm/releases">Helm</a>的releases页面查看当前最高的版本号，目前最高的是2.14.1</p><h3 id="下载并安装"><a href="#下载并安装" class="headerlink" title="下载并安装"></a>下载并安装</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">curl -O -L https://get.helm.sh/helm-v2.14.1-linux-amd64.tar.gz<br>tar -zxvf helm-v2.14.1-linux-amd64.tar.gz<br>mv linux-amd64/helm /usr/local/bin/helm<br></code></pre></td></tr></table></figure><p>创建tiller的serviceaccount和clusterrolebinding</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl create serviceaccount --namespace kube-system tiller<br>kubectl create clusterrolebinding tiller-cluster-rule --clusterrole=cluster-admin --serviceaccount=kube-system:tiller<br>helm init --history-max 200  --service-account tiller --stable-repo-url https://kubernetes.oss-cn-hangzhou.aliyuncs.com/charts<br></code></pre></td></tr></table></figure><h2 id="安装Istio"><a href="#安装Istio" class="headerlink" title="安装Istio"></a>安装Istio</h2><p>先去<a href="https://github.com/istio/istio/releases">Istio</a>的releases页面查看当前最高的版本号，目前最高的是1.2.0</p><h3 id="下载并安装-1"><a href="#下载并安装-1" class="headerlink" title="下载并安装"></a>下载并安装</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">curl -L https://git.io/getLatestIstio | ISTIO_VERSION=1.2.0 sh -<br></code></pre></td></tr></table></figure><p>或者下载还未正式提供的版本1.2.1</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">curl -O -L https://github.com/istio/istio/archive/1.2.1.tar.gz<br>tar -zxvf 1.2.1.tar.gz<br>cd istio-1.2.1<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>DevOps</category>
      
    </categories>
    
    
    <tags>
      
      <tag>k8s</tag>
      
      <tag>debian9</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>在windows上创建kubernetes集群</title>
    <link href="/2019/05/22/kubernetes-for-minikube.html"/>
    <url>/2019/05/22/kubernetes-for-minikube.html</url>
    
    <content type="html"><![CDATA[<h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><blockquote><p>Windows 10 Pro 1903<br><a href="https://github.com/kubernetes/minikube">Minikube</a><br>代理环境（127.0.0.1:1080）</p></blockquote><h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><h2 id="下载minikube"><a href="#下载minikube" class="headerlink" title="下载minikube"></a>下载minikube</h2><p><a href="https://github.com/kubernetes/minikube/releases/tag/v1.1.0">Release</a><br>下载最新的版本，保存到F:\k8s文件夹中，并重命名为<code>mikikube</code></p><p>在小娜哪里搜索env，选择<code>编辑系统环境变量</code>,在path节点中增加<code>F:\k8s</code>；增加新的环境变量<code>MINIKUBE_HOME</code>值为<code>F:\\k8s</code>(注意是双斜杠)</p><p>打开命令提示行，推荐<a href="https://github.com/microsoft/terminal">terminal</a></p><p>对minikube进行配置:</p><p>使用hyperv创建</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">minikube config <span class="hljs-built_in">set</span> vm-driver hyperv<br></code></pre></td></tr></table></figure><ul><li>如果使用linux真机可以指定vm-driver为none，这样就不需要配置交换机</li></ul><p>hyperV的交换机</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">minikube config <span class="hljs-built_in">set</span> hyperv-virtual-switch <span class="hljs-string">&quot;Default Switch&quot;</span><br></code></pre></td></tr></table></figure><p> 有空格需要用双引号包起来</p><h2 id="创建集群"><a href="#创建集群" class="headerlink" title="创建集群"></a>创建集群</h2><p>开始创建集群</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">minikube start --profile k8s-master --image-mirror-country cn --memory 1024 --cpus 2 --registry-mirror https://*******.mirror.aliyuncs.com<br></code></pre></td></tr></table></figure><p> 带参数–image-mirror-country cn，设置成cn就贴心的将镜像拉取送google改到了杭州aliyun<br> –registry-mirror的镜像地址则会直接给docker</p><p> 可能会失败好几遍，每次失败就<code>minikube delete</code>然后重新创建就可以了</p><p> 最后成功内容如下</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash"> * minikube v1.1.0 on windows (amd64)<br>* checking main repository and mirrors <span class="hljs-keyword">for</span> images<br>* using image repository registry.cn-hangzhou.aliyuncs.com/google_containers<br>* Creating hyperv VM (CPUs=2, Memory=2048MB, Disk=20000MB) ...<br>* Configuring environment <span class="hljs-keyword">for</span> Kubernetes v1.14.2 on Docker 18.09.6<br>* Pulling images ...<br>* Launching Kubernetes ...<br>* Verifying: apiserver proxy etcd scheduler controller dns<br>* Done! kubectl is now configured to use <span class="hljs-string">&quot;minikube&quot;</span><br></code></pre></td></tr></table></figure><h1 id="控制台"><a href="#控制台" class="headerlink" title="控制台"></a>控制台</h1> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">minikube dashboard<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>DevOps</category>
      
    </categories>
    
    
    <tags>
      
      <tag>k8s</tag>
      
      <tag>hyperV</tag>
      
      <tag>minikube</tag>
      
      <tag>kubernetes</tag>
      
      <tag>windows10</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RabbitMQ.EventBus.AspNetCore</title>
    <link href="/2019/05/06/rabbitmq-eventbus-netcore.html"/>
    <url>/2019/05/06/rabbitmq-eventbus-netcore.html</url>
    
    <content type="html"><![CDATA[<p><a href="https://www.nuget.org/packages/RabbitMQ.EventBus.AspNetCore"><img src="https://img.shields.io/nuget/v/RabbitMQ.EventBus.AspNetCore.svg?style=popout" alt="NuGet"></a>  <a href="https://www.nuget.org/packages/RabbitMQ.EventBus.AspNetCore"><img src="https://img.shields.io/nuget/dt/RabbitMQ.EventBus.AspNetCore.svg?style=popout" alt="NuGet"></a></p><p><code>RabbitMQ.EventBus.AspNetCore</code>是一个基于官方<code>RabbitMQ.Client</code>的二次封装包，专门针对<code>Net Core</code>项目进行开发，在<code>微服务</code>中进行消息的传递使用起来比较方便。</p><h2 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h2><ol><li>断线重连机制</li><li>可扩展</li><li>消费失败自动打回</li></ol><h3 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h3><h4 id="1-注册"><a href="#1-注册" class="headerlink" title="1. 注册"></a>1. 注册</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ConfigureServices</span>(<span class="hljs-params">IServiceCollection services</span>)</span><br>&#123;<br>    <span class="hljs-built_in">string</span> assemblyName = <span class="hljs-keyword">typeof</span>(Startup).GetTypeInfo().Assembly.GetName().Name;<br>    services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1);<br>    services.AddRabbitMQEventBus(()=&gt;<span class="hljs-string">&quot;amqp://guest:guest@192.168.0.252:5672/&quot;</span>, eventBusOptionAction: eventBusOption =&gt;<br>    &#123;<br>        eventBusOption.ClientProvidedAssembly(assemblyName);<br>        eventBusOption.EnableRetryOnFailure(<span class="hljs-literal">true</span>, <span class="hljs-number">5000</span>, TimeSpan.FromSeconds(<span class="hljs-number">30</span>));<br>        eventBusOption.RetryOnFailure(TimeSpan.FromMilliseconds(<span class="hljs-number">100</span>));<br>        eventBusOption.AddLogging(LogLevel.Warning);<br>    &#125;);<br>    services.AddButterfly(butterfly =&gt;<br>    &#123;<br>        butterfly.CollectorUrl = <span class="hljs-string">&quot;http://192.168.0.252:6401&quot;</span>;<br>        butterfly.Service = <span class="hljs-string">&quot;RabbitMQEventBusTest&quot;</span>;<br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2-订阅消息"><a href="#2-订阅消息" class="headerlink" title="2. 订阅消息"></a>2. 订阅消息</h4><h5 id="2-1-自动订阅消息"><a href="#2-1-自动订阅消息" class="headerlink" title="2.1 自动订阅消息"></a>2.1 自动订阅消息</h5><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Configure</span>(<span class="hljs-params">IApplicationBuilder app, IHostingEnvironment env, IServiceTracer tracer</span>)</span><br>&#123;<br>    <span class="hljs-keyword">if</span> (env.IsDevelopment())<br>    &#123;<br>        app.UseDeveloperExceptionPage();<br>    &#125;<br>    app.RabbitMQEventBusAutoSubscribe();<br>    app.UseMvc();<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="2-2-手动订阅消息"><a href="#2-2-手动订阅消息" class="headerlink" title="2.2 手动订阅消息"></a>2.2 手动订阅消息</h5><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Configure</span>(<span class="hljs-params">IApplicationBuilder app, IHostingEnvironment env, IRabbitMQEventBus eventBus</span>)</span><br>&#123;<br>    <span class="hljs-keyword">if</span> (env.IsDevelopment())<br>    &#123;<br>        app.UseDeveloperExceptionPage();<br>    &#125;<br>    eventBus.Serialize&lt;EventMessage, EventMessageHandler&gt;();<br>    app.UseMvc();<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="3-发消息"><a href="#3-发消息" class="headerlink" title="3. 发消息"></a>3. 发消息</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs csharp">[<span class="hljs-meta">Route(<span class="hljs-meta-string">&quot;api/[controller]&quot;</span>)</span>]<br>[<span class="hljs-meta">ApiController</span>]<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">EventBusController</span> : <span class="hljs-title">ControllerBase</span><br>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> IRabbitMQEventBus _eventBus;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">EventBusController</span>(<span class="hljs-params">IRabbitMQEventBus eventBus</span>)</span><br>    &#123;<br>        _eventBus = eventBus ?? <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(eventBus));<br>    &#125;<br><br>    <span class="hljs-comment">// GET api/values</span><br>    [<span class="hljs-meta">HttpGet</span>]<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> IActionResult <span class="hljs-title">Send</span>(<span class="hljs-params"></span>)</span><br>    &#123;<br>        _eventBus.Publish(<span class="hljs-keyword">new</span><br>        &#123;<br>            Body = <span class="hljs-string">&quot;发送消息&quot;</span>,<br>            Time = DateTimeOffset.Now<br>        &#125;, exchange: <span class="hljs-string">&quot;RabbitMQ.EventBus.Simple&quot;</span>, routingKey: <span class="hljs-string">&quot;rabbitmq.eventbus.test&quot;</span>);<br>        <span class="hljs-keyword">return</span> Ok();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="4-订阅消息"><a href="#4-订阅消息" class="headerlink" title="4. 订阅消息"></a>4. 订阅消息</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs csharp">[<span class="hljs-meta">EventBus(Exchange = <span class="hljs-meta-string">&quot;RabbitMQ.EventBus.Simple&quot;</span>, RoutingKey = <span class="hljs-meta-string">&quot;rabbitmq.eventbus.test&quot;</span>)</span>]<br>[<span class="hljs-meta">EventBus(Exchange = <span class="hljs-meta-string">&quot;RabbitMQ.EventBus.Simple&quot;</span>, RoutingKey = <span class="hljs-meta-string">&quot;rabbitmq.eventbus.test1&quot;</span>)</span>]<br>[<span class="hljs-meta">EventBus(Exchange = <span class="hljs-meta-string">&quot;RabbitMQ.EventBus.Simple&quot;</span>, RoutingKey = <span class="hljs-meta-string">&quot;rabbitmq.eventbus.test2&quot;</span>)</span>]<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MessageBody</span> : <span class="hljs-title">IEvent</span><br>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Body &#123; <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; &#125;<br>    <span class="hljs-keyword">public</span> DateTimeOffset Time &#123; <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; &#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MessageBodyHandle</span> : <span class="hljs-title">IEventHandler</span>&lt;<span class="hljs-title">MessageBody</span>&gt;, <span class="hljs-title">IDisposable</span><br>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ILogger&lt;MessageBodyHandle&gt; _logger;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MessageBodyHandle</span>(<span class="hljs-params">ILogger&lt;MessageBodyHandle&gt; logger</span>)</span><br>    &#123;<br>        _logger = logger ?? <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(logger));<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Dispose</span>(<span class="hljs-params"></span>)</span><br>    &#123;<br>        Console.WriteLine(<span class="hljs-string">&quot;释放&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Task <span class="hljs-title">Handle</span>(<span class="hljs-params">EventHandlerArgs&lt;MessageBody1&gt; args</span>)</span><br>    &#123;<br>        _logger.Information(args.Original);<br>        _logger.Information(args.Redelivered);<br>        _logger.Information(args.Exchange);<br>        _logger.Information(args.RoutingKey);<br><br>        _logger.Information(args.Event.Body);<br>        <span class="hljs-keyword">return</span> Task.CompletedTask;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>知识储备</category>
      
    </categories>
    
    
    <tags>
      
      <tag>RabbitMQ</tag>
      
      <tag>.net core</tag>
      
      <tag>EventBus</tag>
      
      <tag>Asp.Net Core</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>开发过程中需要用到的工具以及相关知识目录</title>
    <link href="/2019/05/05/develop-tools-and-faq.html"/>
    <url>/2019/05/05/develop-tools-and-faq.html</url>
    
    <content type="html"><![CDATA[<ul><li>框架类</li><li><ul><li><a href="https://www.elastic.co/cn/products/stack/elasticsearch-sql">ElasticSearch SQL</a></li></ul></li><li><ul><li><ul><li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/sql-rest.html">文档</a></li></ul></li></ul></li><li><ul><li><a href="https://github.com/elastic/elastic-charts">Elastic Charts</a> </li></ul></li><li><ul><li><ul><li><a href="https://elastic.github.io/elastic-charts/">演示</a></li></ul></li></ul></li><li>知识类</li><li><ul><li><a href="https://github.com/kulend/Dnc.Api.Throttle">适用于Dot Net Core的WebApi接口限流框架</a></li></ul></li><li><ul><li><a href="https://harttle.land/2017/04/04/using-http-cache.html">使用 HTTP 缓存：Etag, Last-Modified 与 Cache-Control</a></li></ul></li><li><ul><li><a href="https://docs.microsoft.com/zh-cn/aspnet/core/performance/caching/distributed?view=aspnetcore-2.2">分布式缓存在 ASP.NET Core 中</a></li></ul></li><li><ul><li><a href="https://docs.microsoft.com/zh-cn/aspnet/core/security/cors?view=aspnetcore-2.2">启用 ASP.NET Core 中的跨域请求 (CORS)</a></li></ul></li><li>工具类</li><li><ul><li><a href="http://naotu.baidu.com/">百度脑图</a></li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>知识储备</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>金庸武侠编年史</title>
    <link href="/2012/08/14/jinyong.html"/>
    <url>/2012/08/14/jinyong.html</url>
    
    <content type="html"><![CDATA[<p>公元前476年 西施送入吴国；范蠡遇到阿青，阿青传越国剑士剑法。</p><p>公元前473年 越国灭掉吴国；范蠡与西施隐居，阿青离去。</p><p>526年 南北朝时期，印度高僧菩提达摩来到中国，在嵩山少林寺面壁九年，创立中国禅宗。 隋朝末年，李靖将《易筋经》中的武学奥秘，尽数领悟。</p><p>694年 明教传至中土。 唐朝末叶，嘉兴剑术名家改良越女剑法。</p><p>877年 丐帮建立。</p><p>936年—946年 少林寺法慧禅师练成了一指禅。</p><p>1030年 慕容博出生。</p><p>1047年 慕容博伤黄眉僧。</p><p>1051年 扫地僧到少林寺。</p><p>1060年 萧峰出生。</p><p>1061年 雁门关外乱石谷大战。</p><p>1062年 萧远山到少林偷研武功。</p><p>1063年 丁春秋暗算师门。</p><p>1064年 慕容复出生。</p><p>1065年 波斯“山中老人”霍山自创“乾坤大挪移”。</p><p>1069年 虚竹出生。</p><p>1071年 段誉出生。</p><p>1072年 慕容博伤崔百泉。</p><p>1074年 阿朱出生。</p><p>1077年 慕容博诈死。</p><p>1083年 萧峰接任丐帮帮主。</p><p>1090年 鸠摩智单挑天龙寺六僧。</p><p>1091年 萧峰离开丐帮。</p><p>1092年 聚贤庄大战。</p><p>1093年 无崖子去世；虚竹接任逍遥派掌门，同年被西夏招为驸马；少林寺门外混战；扫地僧讲经说法。</p><p>1094年 大理段正明禅位侄子段誉；萧峰自尽。</p><p>1110年 黄裳雕版印行万寿道藏。</p><p>1112年 王重阳出生。</p><p>1120年 黄裳向明教的高手挑战。</p><p>1127年—1130年 少林寺灵兴禅师花了三十九年练成了一指禅。</p><p>1140年 独孤求败创独孤九剑第九式破气式。</p><p>1158年 段智兴出生。</p><p>1162年 柯镇恶（江南七怪之首）出生。</p><p>1163年 周伯通出生。</p><p>1164年 黄裳完成九阴真经。洪七公出生。</p><p>1168年 欧阳锋出生。</p><p>1170年 独孤求败郁寂而终。</p><p>1171年 黄药师出生。</p><p>1173年 曲灵风出生。</p><p>1178年 裘千仞出生。</p><p>1183年 金轮法王出生。</p><p>1184年 朱子柳出生。</p><p>1186年 陈玄风 欧阳克出生。</p><p>1190年 火工头陀大开杀戒。</p><p>1196年 王重阳再入古墓，于棺上刻下部分九阴真经，并留“玉女心经，欲胜全真；重阳一生，不弱于人” 的文字，后某日无名僧与王重阳斗酒参阅九阴创九阳；宦官创葵花宝典。</p><p>1200年 第一次华山论剑。</p><p>1203年 重阳真人拜访段皇爷，废了欧阳峰20年蛤蟆功；王重阳仙逝。</p><p>1205年 郭靖出生</p><p>1206年 裘千仞伤瑛姑幼子。</p><p>1208年 黄蓉出生。</p><p>1220年 小龙女出生。 1223年 穆念慈比武招亲。</p><p>1225年 第二次华山论剑；成吉思汗去世。</p><p>1224年 杨过出生。</p><p>1244年 洪七公、欧阳峰去世。</p><p>1244年 杨过小龙女双剑合壁初试锋芒挫败金轮法王；杨过学弹指神通。</p><p>1244年 郭襄出生；杨过断臂，初入独孤求败剑冢。</p><p>1247年 张三丰出生。</p><p>1257年 明教石教主圣火令为丐帮所夺。</p><p>1259年 杨过飞石击毙蒙哥大汗；第三次华山论剑。</p><p>1262年 郭襄游少林。</p><p>1273年 一代大侠郭靖和黄蓉战死襄阳。</p><p>1296年 金毛狮王谢逊出生。</p><p>1317年 谢逊离开师父成昆，加入明教。</p><p>1318年 武当六弟子殷梨亭出生。</p><p>1323年 成昆杀谢逊一家。</p><p>1336年 谢逊及张翠山夫妇至冰火岛。</p><p>1337年 张三丰九十大寿；张无忌出生。</p><p>1338年 元兵剿灭袁州明教义军，常遇春、彭莹玉侥幸逃脱。</p><p>1339年 周芷若出生。</p><p>1340年 汝阳王女儿敏敏特穆尔出生，元帝封其“绍敏郡主”。</p><p>1341年 小昭出生。</p><p>1346年 张三丰百岁大寿；张翠山殷素素夫妇自尽。</p><p>1351年 张无忌得九阳神功。</p><p>1357年 六大派围攻光明顶；张无忌任明教教主；张三丰首创太极神功。</p><p>1358年 小昭远走波斯。 1359年 少林屠狮英雄会；白眉鹰王殷天正去世。</p><p>1360年 张无忌隐退，光明左使杨逍继任为明教第三十五代教主。</p><p>1400年 莆田少林寺得葵花宝典。</p><p>1401年 岳肃蔡子峰偷录葵花宝典；渡元禅师习辟邪剑法。</p><p>1402年 华山派分气宗剑宗。</p><p>1406年 日月神教十长老破五岳剑派剑法。</p><p>1420年 日月教袭武当山，张三丰手抄一部《太极拳经》和青年时佩带的真武剑被抢。</p><p>1458年 武当派开山祖师张三丰仙逝，享年212岁。（据《古今太极拳谱及源流阐秘》李师融先生的考证）</p><p>1479年 华山派气宗剑宗之争。</p><p>1486年 任盈盈出生。</p><p>1493年 东方不败篡日月神教教主之位；任我行被囚地牢。</p><p>1503年 余沧海灭福威镖局。</p><p>1504年 令狐冲学得独孤九剑。</p><p>1505年 任我行重夺日月神教教主。</p><p>1506年 任我行去世。</p><p>1509年 令狐冲任盈盈喜结良缘。</p><p>1610年 金蛇郎君夏雪宜惨遭灭门之祸。</p><p>1612年 金蛇郎君夏雪宜得到云南五仙教的镇教“三宝”。</p><p>1623年 袁承志出生。</p><p>1643年 袁承志被推举为七省江湖首领，同年率众人挫毁西洋红夷大炮。</p><p>1644年 袁承志助阿九挫败成王与曹化淳篡位阴谋；李自成攻入北京，明亡；吴三桂降清；李岩夫妇自杀身亡。</p><p>1645年 袁承志、夏青青避居海外。</p><p>1655年 韦小宝出生。</p><p>1669年 康熙韦小宝擒鳌拜。</p><p>1670年 韦小宝出任天地会青木堂香主。</p><p>1698年 武当派掌门陆菲青出生。</p><p>1733年 陈家洛出生。</p><p>1753年腊月，苗人凤和胡一刀决战；胡斐出生。</p><p>1780年三月十五日，苗人凤和胡斐决战。</p><p>1927年二月六日 金庸出生。</p><p>我也是网上转来的，所有有没有不对的地方，我还真不知道，毕竟金庸大师的小说没看多少，而电视剧都是改编自小说，改了很多地方的。</p>]]></content>
    
    
    <categories>
      
      <category>收集</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>回忆遐想，秋</title>
    <link href="/2012/08/13/recollect-1.html"/>
    <url>/2012/08/13/recollect-1.html</url>
    
    <content type="html"><![CDATA[<p>不知不觉的就来了。上个月热的要命，办公室不大，6个电脑开5个，空调等于没有用，那制冷的能力根本抵消不了这5个电脑的散热能力，还有四个活人身上散发的热量。天天的先开窗然后关窗开空调，可是依然热的要死的。天天中午最热的那阵子都要去外面的仓买（注：小卖店、小超市、买东西的地方）去买冰棒来凉快一下。</p><p>这几年每年都会注意一下天气的变化，总结出来就是，冬天越来越短了，夏天越来越热了，冬天越来越暖了，夏天雨越来越少了。我记得小的时候，夏天最热的时候是在8月份的时候，这个时候地里已经挂锄了，没有地里的活了，于是三五成群的小伙伴就本着村东面的大河去洗澡，说去洗澡其实就是去玩水。那时候亚布力滑雪场还没有大规模的修建，所以也没有水污染，水是清澈见底的，脚踩在河边的沙子上是烫的，然后下到水里是凉凉的，踩着河卵石的脚底痒痒的，不时有小鱼从脚边蹿过去，还记得有一次在水里扑腾着，一个小朋友“啊”的一声，站了起来，手里抓着一条鱼，他说不知道什么东西钻他手里了，一害怕就抓起来了。</p><p>以前的夏天躲避炎热的方法很多很多，如果不去下水那么随便找一棵大树下面坐着也很凉爽，或者我是个爱吓跑的，就走街串巷，农村的树多，所以很多地方走，路都是被树荫遮盖着的。即使在屋里里面，也凉爽，我现在想来，也许是农村都是低矮的平房，没有钢筋混凝土的高楼，所以也不会吸收那么大的热量，所以不热。坐着屋里，看着外面的蓝天，清澈无比。</p><p>后来随着时间的推移，农村也在变化，亚布力滑雪场大建，上游水库蓄水，然后还有开木器场的，化塑料的，修路的要在河里采河沙，一切都变了，路边的树没了。河里的水永远的都浑浊的，我想，即使是黄河，也不过如此的颜色吧。也就是在那几年我知道了一个词叫做沙尘暴，第二年纠正了这个词叫扬沙。</p><p>印象非常深刻，是在四五月份的时候，路边的草已经发芽了，但是头一年路边的花干枯的杆茎没处理，所以还在路边，那天早上出门到处都是黄澄澄的，屋里的灯从外面隔着玻璃看都是淡蓝色的光，很诡异，我就出门了，想看看外面都什么样了，走在公路上，能见度只有三五十米的样子，用手扫一下路边的花茎，一股子灰就扬了起来，不知道为什么，那时候感觉就是末日的感觉，可我竟然还挺开心的。</p><p>回家后开了电视才知道，是沙尘暴来了。原来这就是沙尘暴，自打那年之后，每一年都没落下过，每一年都会有扬沙的天气。</p><p>也是在那些年之后，炎热的夏天我也只是抱这个鱼竿到河边找个地方躲着钓鱼而不再下水了。</p><p>破坏自然环境的都是人们自己，那个小村子也是，为了微小的一次利益，遗留下来的是长久的伤害，现在可能很多地方都有小龙虾，麻辣小龙虾这道菜。小的时候我见过那东西，我们叫蝲蛄。村子那山里小河流汇集的河里就有，而且很多，随便翻个石头可能都看得到，但自打有一年，几个人想吃鱼了，于是带着一包药从最上游的地方撒下去之后，就什么都没了。那一次他们的确实惠了，但是自此，小龙虾在那里就绝迹了，知道大约五六年之后，才听说有人在河里抓到过一只。山上的树少了，河水也小了，物种也少了。</p><p>今年的秋天我感觉来的格外的早，上周开始就觉得冷了，虽然我同事还是高呼热死了，但是我已经感觉到了凉意，尤其是早晚的时候，很突然，回想一下自打有了《2012》这部电影后，很多人就没安生过，整天纠结末日来了怎么办，还有整天吵着盼着末日赶快来的。当然，也有我这样无所谓的。毕竟，若电影里那是事实，一般来说也是躲不掉的吧，所以，对于必输的结果去耗费时间琢磨他干嘛。生活中的很多事情和很多选择不也是这样吗，只是有时候明明知道了结果但是还是抱着一线的侥幸而已。这几年来，地震，海啸，从来没断过，我大中华也在经历了天灾后通过微博爆出了更多的人祸，想想这几年发生的，汶川地震、青海地震、还有各个城市的造海运动，然后去年的728，今年的启东还有四川那个什么来着。天灾人祸不断，所以末日之的是自然的末日还是其他的末日呢？</p><p>写了这么多，就如标题一样，只是遐想和回忆。</p><p>秋天来了，感觉来的太早了，如此而已。</p>]]></content>
    
    
    <categories>
      
      <category>狐说八道</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>教练终于承认，曾给叶诗文服用一种叫做一氧化二氢的液体</title>
    <link href="/2012/08/03/yeshiwen-h2o.html"/>
    <url>/2012/08/03/yeshiwen-h2o.html</url>
    
    <content type="html"><![CDATA[<p>叶诗文的教练终于承认了！曾给叶诗文服用一种叫做一氧化二氢的液体！</p><p>一氧化二氢是有危害的，是危险品，下面来列举一下一氧化二氢都有什么样的危害：</p><ol><li>又叫做“氢氧基酸”，是酸雨的主要成分；</li><li>对泥土流失有促进作用；</li><li>对温室效应有推动作用；</li><li>它是腐蚀的成因；</li><li>过多的摄取可能导致各种不适；</li><li>皮肤与其固体形式长时间的接触会导致严重的组织损伤；</li><li>被吸入肺部可以致命；</li><li>处在气体状态时，它能引起严重灼伤；</li><li>在不可救治的癌症病人肿瘤中已经发现该物质；</li><li>对此物质上瘾的人离开它168小时便会死亡；</li></ol><p>看到了吗，这是一个很可怕的东西啊！在看看一氧化二氢都被应用到什么地方：</p><ol><li>各式各样的残忍的[动物]研究；</li><li>[美国海军]有秘密的一氧化二氢的传播网；</li><li>全世界的[河流]及[湖泊]都被一氧化二氢污染；</li><li>常常配合杀虫剂使用；洗过以后，[农产品]仍然被这种物质污染；</li><li>在一些“[垃圾食品]”和其它食品中的[食品添加剂</li></ol><p>教练为什么要给叶诗文服用这么危险的东西呢？这么危险的东西在比赛中到底起到了什么作用呢？这个所谓的一氧化二氢到底是什么秘密武器呢？</p><p>其实我是知道的，因为我也服用过，而且这个东西的依赖性特别的强，我现在已经离不了了。因为依赖性太强，一旦离开这个东西不再服用，人就会死亡。</p><p>现在我就要告诉你们为什么教练要给叶诗文服用这个一氧化二氢，因为：叶诗文渴了。</p><p>为什么渴了就要服用一氧化二氢呢？因为一氧化二氢的化学方程式是这样的H2O，一个氧两个氢气，大家知道氧气和氢气都是可燃的，且燃点很低。同时服用在某些情况下可以让人精神焕发的。</p><p>但是也不可以过量的服用，副作用也是很强的。</p><p>对了这东西还有个俗名，叫做水。</p><p>大家不要喷我啊～</p><p>开个玩笑嘛～</p><p>因为今天在微博上看到了有转发教练承认曾给叶诗文服用一氧化二氢的微博，竟然真的有人去喷啊～</p><p>没文化真可怕啊～</p><p>不过，这倒是让我想起来，初中刚学化学那会发懵，讲到氧化硫，那么有没有一氧化二硫，有没有一氧化二氧气，有没有一氧化二氢，老师说，那就是水</p>]]></content>
    
    
    <categories>
      
      <category>狐说八道</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>7月1日全球增加1秒，出现7:59:60不影响日常生活</title>
    <link href="/2012/06/30/july-1-2012-1-seconds.html"/>
    <url>/2012/06/30/july-1-2012-1-seconds.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>7月1日将出现7：59：60闰秒调整对市民没影响</p></blockquote><p>据新华社电 （记者帅安宁、周润健）为了让“原子时”与“世界时”协调一致，北京时间7月1日全球将增加一秒，届时，将出现7：59：60的特殊现象。天文专家表示，感兴趣的中国公众可试着在当日7时59分59秒时将自己的电子表或是手机上的时间“拨”慢一秒。</p><p>“世界时”“原子时”要协调</p><p>我国天文教育专家、天津市天文学会理事赵之珩介绍说，为了确定时间，世界上有两种时间计量系统：基于地球自转得出的“世界时”和基于原子振荡周期确定的“原子时”。由于两种时间尺度对秒的定义不一样，随着时间的推移，这两个时间系统之间就会出现差异，所以有了“协调世界时”的概念。</p><p>“协调世界时”以原子时秒长为基础，在时刻上尽量接近于世界时。1972年，国际计量大会决定，当“世界时”与“原子时”之间时刻相差超过0.9秒时，就在协调世界时上加上或减去1秒（正闰秒或负闰秒），以尽量接近世界时，这就是“闰秒”。“闰秒”一般安排在年中或年末的最后时刻，即6月30日或12月31日的最后一分钟。</p><p>今年确定在6月30日23：59：59后面增加一秒，记为23：59：60，然后才是第二天的00：00：00。相对于北京时间，也就是7月1日7：59：59后面增加一秒，出现7：59：60的特殊现象，然后才是8：00：00。</p><p>2012年“多”出一秒，你会拿这一秒做什么？“我会对我爸妈多说一遍‘我爱你们’”“我将用这一秒来睡觉，因为是周末。”“那天是我生日，比别人多过一秒，好幸福！”“上班可以晚起一秒了。”这是网络上一些网友“晒”出的五花八门的回答。</p><p>东亚讯（助理记者 郑玉占） 为了让“原子时”与“世界时”协调一致，北京时间7月1日全球将增加1秒，到时将出现7：59：60的特殊现象。</p><p>长春人造卫星观测站天文科普基地负责人李振军介绍，世界上有两种时间计量系统“世界时”和“原子时”。由于两种时间尺度对秒的定义不一样，随着时间的推移，会出现差异，所以有了“协调世界时”的概念。</p><p>1972年，国际计量大会决定，当“世界时”与“原子时”之间时刻相差超过0.9秒时，就在“协调世界时”上加上或减去1秒，以尽量接近“世界时”，这就是“闰秒”。</p><p>今年确定在6月30日23：59：59后面增加1秒，记为23：59：60，然后才是第二天的00：00：00。而北京时间是在7月1日7：59：59后面增加1秒，出现7：59：60的特殊现象，然后才是8：00：00。</p><p>“多出的1秒钟，只对军事、航天等对时间精确到秒的行业有影响。不会对长春市民的日常生活造成任何影响，市民也不会感觉到。”李振军说。</p><p>博主说：其实我不担心这一秒，我担心的是，我们做的那些程序会不会因为这1秒出现问题？当年千年虫的影响实在是太大了。今年真是多事的一年，但是是很有意义的一年，看来世界末日的说法是真的，但并不是人们意义上的毁灭的概念，而是告别。</p>]]></content>
    
    
    <categories>
      
      <category>收集</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>梦！</title>
    <link href="/2012/06/22/dream-1.html"/>
    <url>/2012/06/22/dream-1.html</url>
    
    <content type="html"><![CDATA[<p>夢的日语发音是：有妹。我记得是这样的。在这里写这个日语发音是很喜欢《xxxxHolic》中那个女人慵懒的躺着时候嘴角上扬的说出“夢”的发音。</p><p>这阵子身体发虚，虚到不行了，我也知道怎么弄的，可是却不能说出来。</p><p>昨晚本打算好好睡一下，可是半夜的时候又被弄起来。</p><p>所以上午起的很晚，11点多才起来。上午的时候做了一个梦，梦里面回到了以前梦中出现的一个场景。当时在梦里我是清醒的，但是我却没醒过来。</p><p>那个地方冰天雪地的，只有那一个区域，在一个城市中，繁花似锦的，绿意盎然。天空也清澈澄明。本来心情极好的在路边的树下行走，但是却走到了一个小路上，一抬眼，入眼的是一座山，山上竟然有雪。瞬间意识清醒意识到在做梦，但是这个地方梦里出现过两次，第一次是高中的时候，上课睡着的，追着一个女人，要把她拉回来，至于为什么我不知道，就知道要拉她回来，回到哪也不清楚，但是没能做到，然后我独自返回，一瞬间风雪大作，感觉自己要冻僵了，但是我感觉如果不能跨过这座山，那么我就回不去了，可能就醒不过来了，风雪有如刀割一样。不过我还是回来了，走在学校的走廊中，非常的暗，犹如没有光一样的暗，摸索着走回我的班级后，听到老师在讲课，然后醒了过来。</p><p>可是这一次，依然是这个地方，但是却没有人，梦里我回头看了一眼，地面是刚下过雨的痕迹，不很泥泞，但是却湿润。</p><p>于是我义无反顾的走向满是冰雪的山中，刺骨的感觉立刻袭来，不知道为什么，周围一个人都没有，脚下却没有脚印。一下子意识到，是不是这一次，我就回不去了呢。但是也不想回头，就这么漫无目的的走在雪上，头顶有阳光，却依然冰冷的到了心里。手脚还没有冻僵，虽然清醒，但是却不知道该如何走。最后，就这么向着一片挂满雪的树林走去，但是，一瞬间却感觉到了柳暗花明的感觉，林后我回到了街道，回头看，身后依然是山，有林，却冰雪覆盖。</p><p>而前面的街道，也是雨后的痕迹，湿润却不泥泞，踏出一步，发现了自己的脚印。这是陌生的街道，却很熟悉，街道上没有人，抬头看天，却能看清天空，稀疏的云后面就是清澈的蓝天，不知道怎么就想到了以前听到的一句话，只有死人才能看清太阳。我想，我没死，因为我看不到太阳。</p><p>可是刚出去不久，有人追我，我跑不过他，于是又开始了熟悉的一幕，我开始使用四肢奔跑，重有跑进了雪地中。回头看有好多的人，我不知道都是做什么的，一个个的黑色影子，看不清楚面容。于是我继续用四肢继续奔跑，不知方向的跑。</p><p>醒来后我在想梦到底预示着什么，我不知道，也解释不了，但是重复的场景，重复的动作，到底是怎么了。</p>]]></content>
    
    
    <categories>
      
      <category>狐说八道</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>没事穷折腾：fastboot刷机</title>
    <link href="/2012/05/28/%E6%B2%A1%E4%BA%8B%E7%A9%B7%E6%8A%98%E8%85%BE%EF%BC%9Afastboot%E5%88%B7%E6%9C%BA.html"/>
    <url>/2012/05/28/%E6%B2%A1%E4%BA%8B%E7%A9%B7%E6%8A%98%E8%85%BE%EF%BC%9Afastboot%E5%88%B7%E6%9C%BA.html</url>
    
    <content type="html"><![CDATA[<p>我有个HTC G7，没事我就穷折腾，各种刷机，刷过各种第三方，刷过RUU，刷过自己用厨房定制的各种ROM，现在一直在使用CM9。</p><p>所以想用fastboot来刷机，看看怎么刷。首先启动到bootloader界面，然后输入如下命令</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cmd">fastboot +w      清除userdata和cache<br>fastboot <span class="hljs-built_in">erase</span> system<br>fastboot <span class="hljs-built_in">erase</span> boot<br></code></pre></td></tr></table></figure><p>然后使用recovery开始刷新的rom吧。当然还有其他的方式，但是我没那么用过。</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cmd">fastboot flash hboot hboot.img      刷hboot<br>fastboot flash recovery recovery.img      刷recovery<br>fastboot flash radio radio.img      刷RADIO<br>fastboot flash boot boot.img      刷BOOT<br>fastboot flash system system.img      刷system<br>fastboot flash userdata userdata.img      刷用户数据<br>fastboot reboot      重启<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>收集</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>残篇『十二』</title>
    <link href="/2012/04/30/canpian-12.html"/>
    <url>/2012/04/30/canpian-12.html</url>
    
    <content type="html"><![CDATA[<p>回想从前</p><p>只记得那个柔软的怀抱</p><p>只记得芊芊柔荑</p><p>只怪自己</p><p>没去珍惜</p><p>反倒杀了她</p><p>她会恨我吧</p><p>带着对我的恨</p><p>走过忘川奈何</p><p>我知道</p><p>她不会喝孟婆那碗汤</p><p>孟婆也不会给她喝</p><p>因为她要回来找我</p><p>没办法</p><p>不杀了她</p><p>她也没法回去</p><p>也不会回来杀我</p><p>可是</p><p>我还是错了</p><p>她回去了</p><p>却没有回来杀我</p><p>任我修行中入了妖道</p><p>遭致生灵涂炭</p><p>手里的剑是热的</p><p>沾染了赤尾的血之后</p><p>这把剑再也无法杀人</p><p>也无法让我死</p><p>今天</p><p>我也只能做这样的选择</p><p>从这里跳下去</p><p>但愿孟婆会舍碗汤给我</p><p>———————————————————–</p><p>她跳下去了</p><p>我无法杀她</p><p>所以只能看她跳下去</p><p>我愧对天下</p><p>因无法下手杀她</p><p>导致生灵涂炭</p><p>我的罪孽由我继续来偿</p><p>你跳吧</p><p>从此以往</p><p>你我再无瓜葛</p><p>下一世</p><p>你将获得重生</p><p>而我</p><p>将用以后的无限生命</p><p>每日诵经</p>]]></content>
    
    
    <categories>
      
      <category>狐说八道</category>
      
    </categories>
    
    
    <tags>
      
      <tag>残篇</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>C#方法延迟返回结果</title>
    <link href="/2012/04/13/C-%E6%96%B9%E6%B3%95%E5%BB%B6%E8%BF%9F%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C.html"/>
    <url>/2012/04/13/C-%E6%96%B9%E6%B3%95%E5%BB%B6%E8%BF%9F%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C.html</url>
    
    <content type="html"><![CDATA[<p>不知道标题恰不恰当，只不过我的需求是这个样子的：</p><p>例如一个方法A，返回值是bool类型的，但是方法执行过程中，需要另一个方法B执行结束，但是还不能直接调用B方法，可是B是等待外部信号才执行。所以需要延迟一下，等B方法执行了才返回结果。</p><p>找了些资料，找到了AutoResetEvent，可以达到我的目的，但是否是最适合的，就不知道了，由于我的项目中所谓的B方法是RS232端口读数据的，然后解析出来的返回值。并不是时时的，可能有点时间差，于是我采用了下面的方式。</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span><br><span class="hljs-comment"><span class="hljs-doctag">///</span> 标志位，用来等待返回</span><br><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span><br>AutoResetEvent are = <span class="hljs-keyword">new</span> AutoResetEvent(<span class="hljs-literal">false</span>);<br><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span><br><span class="hljs-comment"><span class="hljs-doctag">///</span> 返回结果，可以是任意需要的类型</span><br><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span><br><span class="hljs-built_in">object</span> result;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">object</span> <span class="hljs-title">A</span>(<span class="hljs-params"></span>)</span><br>&#123;<br>    <span class="hljs-comment">/****Begin**/</span><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">        * 数据的拼装</span><br><span class="hljs-comment">        * 数据的发送</span><br><span class="hljs-comment">        **/</span><br>    Send(<span class="hljs-string">&quot;要传输的数据&quot;</span>);<br>    <span class="hljs-comment">/****End****/</span><br><br>    <span class="hljs-comment">//等待信号，-1代表无限等待，可以更改为其他值，单位是毫秒，等待时间过后为超时</span><br>    are.WaitOne(<span class="hljs-number">-1</span>, <span class="hljs-literal">false</span>);<br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">B</span>(<span class="hljs-params"></span>)</span><br>&#123;<br>    <span class="hljs-built_in">byte</span>[] bytes = Read();<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">        * 此处解析bytes中的数据</span><br><span class="hljs-comment">        * 根据解析出来的数据</span><br><span class="hljs-comment">        * 得到想要的结果</span><br><span class="hljs-comment">        * */</span><br><br>    <span class="hljs-comment">//得到需要的结果</span><br>    result = Encoding.UTF8.GetString(bytes);<br>    <span class="hljs-comment">//给信号</span><br>    are.Set();<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>收集</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C#</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>毁灭童年！还原童话故事恐怖面目</title>
    <link href="/2012/03/29/%E6%AF%81%E7%81%AD%E7%AB%A5%E5%B9%B4%EF%BC%81%E8%BF%98%E5%8E%9F%E7%AB%A5%E8%AF%9D%E6%95%85%E4%BA%8B%E6%81%90%E6%80%96%E9%9D%A2%E7%9B%AE.html"/>
    <url>/2012/03/29/%E6%AF%81%E7%81%AD%E7%AB%A5%E5%B9%B4%EF%BC%81%E8%BF%98%E5%8E%9F%E7%AB%A5%E8%AF%9D%E6%95%85%E4%BA%8B%E6%81%90%E6%80%96%E9%9D%A2%E7%9B%AE.html</url>
    
    <content type="html"><![CDATA[<p>童话从诞生之日起就充满着曲折的情节和阴森的结局。如今，那些带有血腥气息的童话已不适应现代读者的口味，于是，迪斯尼等公司为迎合观众而净化了童话，到处都是大团圆结局。在此，我们对常见的一些快乐结局作出解释，还原它们本来的恐怖面目。</p><p>1、魔笛</p><p>《魔笛》的故事里，那个村庄鼠患泛滥。一个身穿七彩布衣，手持魔笛的男人前来，提出要帮村庄消除鼠害。村民同意，如果真的实现，则愿付出巨大的代价。那男人实现了。他吹奏起魔笛，驱赶了群鼠。但当他回来索要报偿时，村民反悔。笛手决定驱赶孩童。在后来很多版本中，笛手驱赶孩童进入村外的洞穴，有一位村民最终同意付出报酬，他也归还了孩童。而在阴暗的初衷里，笛手引导孩童入河，除了一个掉队的瘸腿小男孩，其他都淹死了。</p><p>2、小红帽</p><p>我们熟知的这则故事的结局是一名樵夫杀死了凶恶的大灰狼，救出了小红帽。其实，最初的法语版本里，夏尔·佩罗笔下的结局并不美满。其中，那个富家姑娘询问大灰狼去她外婆家的路，狼给她指了条错误的道路，最后她不幸被吃。故事结束了，没有樵夫，没有外婆，只有大灰狼和小红帽。故事的寓意便是不要和陌生人讲话。</p><p>3、海的女儿</p><p>迪士尼版本的“海的女儿”是个不折不扣的弥天大谎：爱丽尔人鱼变成了人，和艾利克王子结婚，奇妙的婚礼还在人和鱼族里进行。但是，在安徒生的最初版本里，人鱼目睹王子和公主结合，绝望地离开。魔咒中，只有用剪刀刺死王子，她才能获救。她没有照做，而是跃进大海，变成了泡沫。后来，安徒生对童话稍稍做了温和地修改，新的结尾中，她没有变成泡沫，而是成为了上帝的女儿，在天堂安息。可无论如何，她依然是死去了的。</p><p>4、白雪公主</p><p>众所周知，在白雪公主的故事中，皇后要求猎人杀害她，并将她的心脏带回作证。而猎人不忍心这么做，于是带回了熊的心脏。此处，迪士尼版本没做多大修改，不过还是遗漏了一段很重要的情节：原始的童话版本中，皇后要求当晚食用白雪公主的肝脏！另外，白雪公主并没有因为一个充满法力的吻醒来，她被带回了城堡。至于白雪公主“尸体”的用途并没有交代，留给人们想象的空间。在格林兄弟的版本中，故事结尾，皇后被迫穿上铁靴，跳舞至死。</p><p>5、睡美人</p><p>在我们熟知的睡美人故事里，优雅的公主是由于手触纺锤而沉睡，直到百年之后王子前来吻醒她。他们恋爱、结婚，从此幸福地生活在一起，一切都让人很惊奇且欣喜。但是原始的故事并不甜蜜，只有亲身读过才能相信其悲哀：最初，一名年轻女子由于一种预言（非诅咒）而沉睡。一位国王见状，渴望得到她，并遭强制啪啪了她。九个月后，她在沉睡中生下两个孩子。其中一个孩子吮吸她的手指，活跃了她的神经纤维，她苏醒过来，发现了自己已经遭强制啪啪啪还生了孩子。这可比王子的吻恐怖得多。</p><p>6、侏儒怪</p><p>这则童话和前几则的不同之处在于，修改版本不是处于净化丑恶的初衷，而是将其修改得更加恐怖。在原始故事里，侏儒怪帮助一名面临死亡的女孩，将稻草变成金子供她看病，使她痊愈直至能工作。相应地，他要求女孩交出她生的第一个孩子作为报偿。当这天来临，女孩不愿交出孩子，侏儒怪告诉她，如果能猜出他的名字，也能放了女孩。女孩记起了以前在火堆边无意中听到侏儒怪的呻吟，顺利答出了他的名字。侏儒怪火冒三丈地走掉了。在改编后的版本里，一切更糟糕：侏儒怪肆意践踏和撕扯自己的左右臂膀而死。</p><p>7、金凤花和三只熊的故事</p><p>在这个温馨的故事里，可爱的女孩金凤花发现了三只熊的屋子，她溜进屋子，偷吃食物，坐在椅子上，最后竟然在小熊的床上睡着了。当小熊们回家时，她醒过来，惊愕地从窗户逃走了。原始的故事（可追溯到1837年）有两个不同之处：一是熊发现了女孩之后，撕碎并吞咽了她。二是女孩企图逃跑时变成了老巫婆的面貌。故事的结尾告诉人们，金凤花要不就是缺胳膊断腿，要不就是由于她的恶行被抓去感化所了，总之不是好事儿。</p><p>8、奇幻森林历险记</p><p>从奇幻森林历险记的流行版本里，我们知道两个在森林里迷路的孩子最终找到了一间华美的屋子。屋子里居住着一名女巫，她要求他们为他做劳役。在一次准备美餐的过程中，他们结束了奴役生活：他们发现来路，将女巫扔进火炉，逃走了。在更早的法语版本里（名为《迷路的孩子》），没有女巫，而是魔鬼。一开始坏心肠的老魔鬼被孩子愚弄（和后来的故事一样），但是后来他摆脱了孩子，将锯木架整合起来，要把其中一个孩子榨成肉酱。孩子们假装不懂怎么上架，请魔鬼的妻子来做示范。当她躺倒，孩子扼住她的喉咙威胁魔鬼，才逃出了森林。</p><p>9、没有手的姑娘</p><p>说实话，这个故事的所有版本都很残忍（不管是圣经故事还是原始的故事），尽管情节变化各有不同。最新版本里，魔鬼承诺一个穷人，如果他允许自己拿走任何磨坊后的物什，就让他变富。穷人只知道屋后面有一棵与自己毫不相干的苹果树，就答应了，其实那正是他的爱女。女儿太纯洁了，魔鬼无法带走她，于是魔鬼又要挟女儿，除非女儿允许自己父亲剁碎自己双手，否则将带走父亲。女儿同意了，而他父亲也做了，悲剧就这样酿成了。尽管这不太雅观，但早先的其他一些变体版本更令人发指：女孩剁碎自己的手臂，使自己变得丑陋，以免去强暴之苦。另一种变体是父亲剁碎女儿的双手，因为她拒绝和父亲交媾。</p><p>10、灰姑娘</p><p>现代的灰姑娘故事里，美丽的灰姑娘与王子结合，后母的两个女儿也嫁给了两名伯爵，从此以后，大家相安无事地生活在一起。这个故事的雏形可以追溯到公元一世纪，是关于斯特拉博（古希腊地理学家）的女人罗德庇斯（并不叫仙度瑞拉）。这两个故事除了水晶鞋和南瓜车，其他都很类似。而格林兄弟将美好的寓言转变成阴森的罪恶：在这个版本里，后母的两个女儿削足适履，以哄骗王子她们才是要所要寻找的。鸽子啄出她们的眼睛来警示王子。后半生中，后母的女儿成为瞎乞丐，而灰姑娘在宫廷里庸碌地消遣着时光。</p>]]></content>
    
    
    <categories>
      
      <category>收集</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2011年10月14日下午14点哈尔滨地震</title>
    <link href="/2011/10/14/2011%E5%B9%B410%E6%9C%8814%E6%97%A5%E4%B8%8B%E5%8D%8814%E7%82%B9%E5%93%88%E5%B0%94%E6%BB%A8%E5%9C%B0%E9%9C%87.html"/>
    <url>/2011/10/14/2011%E5%B9%B410%E6%9C%8814%E6%97%A5%E4%B8%8B%E5%8D%8814%E7%82%B9%E5%93%88%E5%B0%94%E6%BB%A8%E5%9C%B0%E9%9C%87.html</url>
    
    <content type="html"><![CDATA[<p>就在刚才，不到1个小时，中午吃完饭和同事打了一局Dota，很久没玩了，而且昨晚开始有雾，今天的雾更大，之后我坐着，感觉身体不由自主的左右轻微晃，头稍微有点晕，我以为是昨晚没睡好，想着ProcessMap还没画完呢，打算开小差睡一下，然后同时在群里问</p><blockquote><p>××× 14:28:08</p><p>感觉不感觉 脑袋晕？</p><p>× 14:28:23</p><p>感觉了</p><p>× 14:28:42</p><p>刚才我觉得我有点轻微的晃，我以为昨晚没睡好</p></blockquote><p>然后他出来说群里那边有个感觉到地震了，感觉晃，问是不是晕，说不是，是东西晃，有个人从25楼已经跑下去了。</p><p>原来是地震了，我还真是平静，我们几个就讨论，原来只有我和我们领导有感觉，剩下那四个人没感觉到。</p><p>微博的效应真快，我打开微博就看到有说这个的了，据说是俄罗斯6.6级地震，黑龙江这边几个城市有震感。</p><blockquote><p>××× 14:42:23</p><p>俄罗斯这一带 城镇还挺多呢</p><p>×××× 14:45:11</p><p>今天还这是个“好”日子</p><p>××× 14:46:55</p><p>我朋友在交银大厦22楼 整栋大楼都疏散了</p><p>。。。</p><p>说是友谊路那全都是人</p><p>&amp;&amp; 14:47:18</p><p>++14:47:34</p><p>会展那的高层没事</p><p>××× 14:47:54</p><p>有趣</p><p>×××× 14:48:26</p><p>没事，算命的说我能活到死</p></blockquote><p>不过，知道地震了，我还是可以很平静，不知道为什么。没有害怕，没有兴奋，我发现，只要是大事，我都可以很平静的接受，可是一件很小的事情，我反倒可以兴奋一下，高兴一下。</p><p>该来的总会来，不来的，也等不到，心放宽些，才比较快乐，来了什么，欣然接受就好，也许，前面就是柳暗花明呢。</p><p>记于二?一一年十月十四日下午14:14分</p>]]></content>
    
    
    <categories>
      
      <category>狐说八道</category>
      
    </categories>
    
    
    <tags>
      
      <tag>地震</tag>
      
      <tag>哈尔滨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MBTI</title>
    <link href="/2011/08/29/MBTI.html"/>
    <url>/2011/08/29/MBTI.html</url>
    
    <content type="html"><![CDATA[<p>Psytopic分析：您的性格类型是“ISTP”(内向+实感+思维+知觉)</p><p>容忍，有弹性；是冷静的观察者，但当有问题出现，便迅速行动，找出可行的解决方法。能够分析哪些东西可以使事情进行顺利，又能够从大量资料中，找出实际问题的重心。很重视事件的前因后果，能够以理性的原则把事实组织起来，重视效率。</p><p>ISTP型的人坦率、诚实、讲求实效，他们喜欢行动而非漫谈。他们很谦逊，对于完成工作的方法有很好的理解力。 ISTP型的人擅长分析，所以他们对客观含蓄的原则很有兴趣。他们对于技巧性的事物有天生的理解力，通常精于使用工具和进行手工劳动。他们往往做出有条理而保密的决定。他们仅仅是按照自己所看到的、有条理而直接地陈述事实。 ISTP型的人好奇心强，而且善于观察，只有理性、可靠的事实才能使他们信服。他们重视事实，简直就是有关他们知之甚深的知识的宝库。他们是现实主义者，所以能够很好地利用可获得的资源，同时他们擅于把握时机，这使他们变得很讲求实效。ISTP型的人平和而寡言，往往显得冷酷而清高，而且容易害羞，除了是与好朋友在一起时。他们平等、公正。他们往往受冲动的驱使，对于即刻的挑战和问题具有相当的适应性和反应能力。因为他们喜欢行动和兴奋的事情，所以他们乐于户外活动和运动。</p><p>您适合的领域有：技术领域 证券、金融业、贸易、商业领域 户外、运动、艺术等</p><p>您适合的职业有：</p><p>? 信息服务业经理</p><p>? 计算机程序员</p><p>? 警官</p><p>? 软件开发员</p><p>? 律师助理</p><p>? 消防员</p><p>? 私人侦探</p><p>? 药剂师</p><p>? 证券分析员</p><p>? 银行职员</p><p>? 管理顾问</p><p>? 财务顾问</p><p>? 电子专业人士</p><p>? 技术培训人员</p><p>? 信息服务开发人员</p><p>? 软件开发商</p><p>? 海洋生物学者</p><p>? 后勤与供应经理</p><p>? 经济学者</p><p>? 贸易商</p><p>? 商品经销商</p><p>? 产品代理商（有形产品）</p><p>? 警察</p><p>? 侦探</p><p>? 体育工作者</p><p>? 赛车手</p><p>? 飞行员</p><p>? 雕塑家</p><p>? 手工制作</p><p>? 画家</p>]]></content>
    
    
    <categories>
      
      <category>狐说八道</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>C#字符串算式直接运算结果</title>
    <link href="/2011/08/19/C-%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%AE%97%E5%BC%8F%E7%9B%B4%E6%8E%A5%E8%BF%90%E7%AE%97%E7%BB%93%E6%9E%9C.html"/>
    <url>/2011/08/19/C-%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%AE%97%E5%BC%8F%E7%9B%B4%E6%8E%A5%E8%BF%90%E7%AE%97%E7%BB%93%E6%9E%9C.html</url>
    
    <content type="html"><![CDATA[<p>有些似乎后会遇到一种情况，就是要求，一个字符串形式的四则运算，直接求出结果，以前在C#中使用js反射实现，现在发现了一种新的方法，更方便：</p><p>界面上的元素</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs csharp">Label :name=result;<span class="hljs-comment">//显示表达式结果</span><br><br>TextBox :name=expressiontext;<span class="hljs-comment">//表达式</span><br></code></pre></td></tr></table></figure><p>代码只有一句：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp">result.Text = <span class="hljs-keyword">new</span> DataTable().Compute(expressiontext.Text, <span class="hljs-built_in">string</span>.Empty).ToString();<br></code></pre></td></tr></table></figure><p>测试了一下，正常的+-/*都可以的，支持带括号运算方式，不支持%运算，其他未测试。</p>]]></content>
    
    
    <categories>
      
      <category>收集</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C#</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>程序员的午夜一秒谜案：1927年12月31日</title>
    <link href="/2011/08/12/19271231.html"/>
    <url>/2011/08/12/19271231.html</url>
    
    <content type="html"><![CDATA[<p>这真是一个特殊的日子啊。</p><p>1927年12月31日。</p><p>StackOverflow是一个程序员向的问答网站，广大程序员们在上面交流经验、提问答疑，三天前，一位名叫Freewind的用户发布了一个问题<code>1927年12月31日，一秒谜案</code></p><blockquote><p>我在用Java编写一段比较两个字符串时间间隔的程序，然而当我比较“1927-12-31 23:54:07”和“1927-12-31 23:54:08”这两个时间时，输出结果却不是1……而是353。</p><p>当我把两个时间分别往后调整1秒，变成“1927-12-31 23:54:08”和“1927-12-31 23:54:09”，结果就又是1了！—-可为什么那两个时间的结果，却是353呢？</p></blockquote><p>面对这一诡异的问题，网友们很快追问，“你的区域（Locale）设置是什么？这可能是个区域问题/和当地夏令时之类的东西有关。”</p><p>楼主很快附上了Java版本号和区域设置：</p><blockquote><p>sun.util.calendar.ZoneInfo[id=”Asia/Shanghai”,</p><p>offset=28800000,dstSavings=0,</p><p>useDaylight=false,</p><p>transitions=19,</p><p>lastRule=null]</p></blockquote><p>（……没错，Freewind君，似乎是一位魔都死程。不知道这里有没有人认识这位老兄？）</p><p>在这份追加信息出现仅仅两分钟之后，StackOverflow站上的问答狂人Jon Skeet给出了如下答复</p><blockquote><p>这是因为上海的时区在12月31日发生了变化。</p><p>请看<a href="https://www.timeanddate.com/time/change/china/shanghai?year=1927">这里</a></p><p>为什么时间往回拨了5分52秒？</p><p>（1928年1月1日0点0分，当地时间由地方平时（Local Mean Time） 改为北京时间/中国标准时间）</p><p>简单地说，在1927年末的最后那一个午夜，时钟被往回拨了5分52秒。所以“1927-12-31 23:54:08”这一秒，事实上，发生了两次，而看起来在计算当地时间时，Java将其视为了后面那一个时间点，于是就产生了这一差别。</p><p>这正是时区世界的奇妙与不可思议啊。</p></blockquote><p>在StackFlow网民们纷纷膜拜Jon Skeet的神速之时，其他程序员也以测试的方式验证了这一结果的正确—-美国时间木有这个问题。看来，当一枚程序员，有时真的需要上通天文、下知地理啊……</p><hr><p>ps：我刚刚用C#做了一下，一下是我的测试代码：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-built_in">double</span> t1 = (DateTime.Parse(<span class="hljs-string">&quot;1927/12/31 23:54:07&quot;</span>) - Convert.ToDateTime(<span class="hljs-string">&quot;1970/01/01 00:00:00&quot;</span>)).TotalMilliseconds / <span class="hljs-number">1000</span>;<span class="hljs-comment">// -8 * 3600;</span><br><span class="hljs-built_in">double</span> t2 = (DateTime.Parse(<span class="hljs-string">&quot;1927/12/31 23:54:08&quot;</span>) - Convert.ToDateTime(<span class="hljs-string">&quot;1970/01/01 00:00:00&quot;</span>)).TotalMilliseconds / <span class="hljs-number">1000</span>;<span class="hljs-comment">// -8 * 3600;</span><br>MessageBox.Show(<span class="hljs-built_in">string</span>.Format(<span class="hljs-string">&quot;[&#123;0&#125;]  [&#123;1&#125;] : &#123;2&#125;&quot;</span>, t1, t2, t2 - t1));<br></code></pre></td></tr></table></figure><p>我并没有遇到上面的问题，无论是235408-235407或者235409-235408，我的结果都是1。因为C#没有从1970年1月1日开始获取时间的方法。</p><p>所以我换了js，如下代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> d = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();<br>d.setFullYear(<span class="hljs-number">1927</span>,<span class="hljs-number">12</span>,<span class="hljs-number">31</span>);<br>d.setHours(<span class="hljs-number">23</span>);<br>d.setMinutes(<span class="hljs-number">54</span>);<br>d.setSeconds(<span class="hljs-number">7</span>);<br><br><span class="hljs-keyword">var</span> a = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();<br>a.setFullYear(<span class="hljs-number">1927</span>,<span class="hljs-number">12</span>,<span class="hljs-number">31</span>);<br>a.setHours(<span class="hljs-number">23</span>);<br>a.setMinutes(<span class="hljs-number">54</span>);<br>a.setSeconds(<span class="hljs-number">8</span>);<br><span class="hljs-keyword">var</span> t1=d.getTime()/<span class="hljs-number">1000</span>;<br><span class="hljs-keyword">var</span> t2=a.getTime()/<span class="hljs-number">1000</span>;<br>alert(t1);<br>alert(t2);<br>alert(t2-t1);<br></code></pre></td></tr></table></figure><p>答案依旧，都是1的结果，那么，是不是我的测试代码不正确呢？还是这个问题已经解决了？活着。。是不是只有java有这样的问题？</p><p>我依然没有得到答案。</p><p>201108130035:上面提到一个东西，叫做地方平时，我在网上搜到一个对地方平时的解释：</p><blockquote><p>local mean time</p><p>地方时的一种，地方平太阳时的简称。</p><p>体现平太阳的周日视运动。它没有季节性的快慢变化，因而不同于地方视时。</p><p>由于地区间的联系日益频繁，它在实用上已被标准时(区时或法定时)所代替。</p><p>通常根据标准时和地方经度进行推算，也可根据太阳的地方时角和时差进行推算。</p></blockquote><p>地方平太阳时：<a href="http://baike.baidu.com/view/37435.htm">http://baike.baidu.com/view/37435.htm</a></p><p>上面这个是百度百科对地方平太阳时的解释。</p><p>大家都知道，在java中gettime方法获取的时间是自1970年1月1日开始至此地毫秒数。而上面用的时间是1927年12月31日。早于1970年，所以，流传着一种说法，就是1928年的1月1日开始，当地的时间计时更改为格林威治标准时间，而格林威治标准时间与当地的地方平时正好相差了5分52秒。至于我用C#没有得出353或许是因为C#中获取的时间戳是从0001年1月1日开始的。</p><p>也许是jdk的关系造成这样的结果吧。</p>]]></content>
    
    
    <categories>
      
      <category>收集</category>
      
    </categories>
    
    
    <tags>
      
      <tag>谜案</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>C#与盗梦空间-我们要进入下一层梦境</title>
    <link href="/2011/07/10/C-%E4%B8%8E%E7%9B%97%E6%A2%A6%E7%A9%BA%E9%97%B4-%E6%88%91%E4%BB%AC%E8%A6%81%E8%BF%9B%E5%85%A5%E4%B8%8B%E4%B8%80%E5%B1%82%E6%A2%A6%E5%A2%83.html"/>
    <url>/2011/07/10/C-%E4%B8%8E%E7%9B%97%E6%A2%A6%E7%A9%BA%E9%97%B4-%E6%88%91%E4%BB%AC%E8%A6%81%E8%BF%9B%E5%85%A5%E4%B8%8B%E4%B8%80%E5%B1%82%E6%A2%A6%E5%A2%83.html</url>
    
    <content type="html"><![CDATA[<p>刚才突然想起去年10月份在CSDN上看到的一个帖子。</p><p>题目是：完成如下代码，使其输出“Hello World!”</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span>(补全这里) printf(<span class="hljs-string">&quot;Hello&quot;</span>);<br><span class="hljs-keyword">else</span> printf(<span class="hljs-string">&quot; World!&quot;</span>);<br></code></pre></td></tr></table></figure><p>不过是C++的。</p><p>问到是用C#如何实现：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">using</span> System;<br><span class="hljs-keyword">using</span> System.Collections.Generic;<br><span class="hljs-keyword">using</span> System.Linq;<br><span class="hljs-keyword">using</span> System.Text;<br><br><span class="hljs-keyword">namespace</span> <span class="hljs-title">HelloWorld</span><br>&#123;<br>    <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span><br>    &#123;<br>        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span><br>        &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-comment">/* 补充这里 */</span>)<br>                Console.Write(<span class="hljs-string">&quot;Hello&quot;</span>);<br>            <span class="hljs-keyword">else</span><br>                Console.Write(<span class="hljs-string">&quot; World!&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>下面的回答千奇百怪。</p><p>确实C++我已经六七年没动过了，所以都没概念了。不过一直做C#的开发，确实可以用很多种方法。</p><p>但是！下面的回帖中出现了两个让我眼前一亮的内容，一个是27楼的：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">using</span> System;<br><span class="hljs-keyword">using</span> System.Collections.Generic;<br><span class="hljs-keyword">using</span> System.Linq;<br><span class="hljs-keyword">using</span> System.Text;<br><br><span class="hljs-keyword">namespace</span> <span class="hljs-title">HelloWorld</span><br>&#123;<br>    <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span><br>    &#123;<br>        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span><br>        &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-literal">true</span>)Console.Write(<span class="hljs-string">&quot;Hello World!&quot;</span>);<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-literal">false</span>)<br>                Console.Write(<span class="hljs-string">&quot;Hello&quot;</span>);<br>            <span class="hljs-keyword">else</span><br>                Console.Write(<span class="hljs-string">&quot; World!&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>另一个就是42楼的：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span><br>&#123;<br>    <span class="hljs-keyword">if</span> ((args == <span class="hljs-literal">null</span>||Main(<span class="hljs-literal">null</span>) <span class="hljs-keyword">is</span> <span class="hljs-built_in">object</span>))<br>        Console.Write(<span class="hljs-string">&quot;Hello&quot;</span>);<br>    <span class="hljs-keyword">else</span><br>        Console.Write(<span class="hljs-string">&quot; World!&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>27楼的就是代码注入，42楼的很有意思。</p><p>遂记录一下，有时候开发的过程总换个思路，就有不同的天空啊。</p>]]></content>
    
    
    <categories>
      
      <category>收集</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C#</tag>
      
      <tag>盗梦</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LINQ优化：将GroupBy换做Distinct</title>
    <link href="/2011/05/06/LINQ%E4%BC%98%E5%8C%96%EF%BC%9A%E5%B0%86GroupBy%E6%8D%A2%E5%81%9ADistinct.html"/>
    <url>/2011/05/06/LINQ%E4%BC%98%E5%8C%96%EF%BC%9A%E5%B0%86GroupBy%E6%8D%A2%E5%81%9ADistinct.html</url>
    
    <content type="html"><![CDATA[<p>这样做也是没有办法的，我之前项目中，查询中这样写的分组</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs csharp">form t <span class="hljs-keyword">in</span> db.Table<br><span class="hljs-keyword">where</span> t.state==<span class="hljs-literal">true</span><br><span class="hljs-keyword">group</span> t <span class="hljs-keyword">by</span> <span class="hljs-keyword">new</span><br>&#123;<br>   t.A,<br>   t.B,<br>   t.C<br>&#125;<br><span class="hljs-keyword">into</span> p<br><span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span>&#123;<br>   ...<br>&#125;<br></code></pre></td></tr></table></figure><p>导致的就是，数据表中不到1W行数据，经过分组后是752行，但是第一次查询要将近10秒。</p><p>这太不能容忍了，所以思来想去，只有更换为Distinct来解决。</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs csharp">(form t <span class="hljs-keyword">in</span> db.Table<br><span class="hljs-keyword">where</span> t.state==<span class="hljs-literal">true</span><br><span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span>&#123;<br>   ...<br>&#125;).Distinct();<br></code></pre></td></tr></table></figure><p>感觉很好，不到1秒，只是微软对Distinct的支持不是很好，因为这个去重靠的是每个对象的比对，对象相同则去重，而无法对某一个字段去重，很遗憾。</p>]]></content>
    
    
    <categories>
      
      <category>收集</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LINQ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>关于数据容量</title>
    <link href="/2011/04/06/%E5%85%B3%E4%BA%8E%E6%95%B0%E6%8D%AE%E5%AE%B9%E9%87%8F.html"/>
    <url>/2011/04/06/%E5%85%B3%E4%BA%8E%E6%95%B0%E6%8D%AE%E5%AE%B9%E9%87%8F.html</url>
    
    <content type="html"><![CDATA[<p>bit(比特)是binary digit的英文缩写，量度信息的单位，也是表示信息量的最小单位，只有0、1两种二进制状态。8个bit组成一个Byte(字节)，能够容纳一个英文字符，而一个汉字需要两个字节的存储空间，普通英文单词则需要十个左右的字节。</p><p>从字节开始往上按照千分位递进，分别就是KiloByte(KB)、MegaByte(MB)、GigaByte(GB)、 TeraByte(TB)、PetaByte(PB)、ExaByte(EB)、ZettaByte(ZB)、YottaByte(YB)。1KB就是 1024个字节，或者说2的10次方、大约10的3次方；1YB已经是2的80次方、大约10的24次方个字节，完整地写下来就是 1208925819614629174706176。</p>]]></content>
    
    
    <categories>
      
      <category>收集</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>asp.net后台执行js造成样式失效</title>
    <link href="/2011/01/12/asp-net%E5%90%8E%E5%8F%B0%E6%89%A7%E8%A1%8Cjs%E9%80%A0%E6%88%90%E6%A0%B7%E5%BC%8F%E5%A4%B1%E6%95%88.html"/>
    <url>/2011/01/12/asp-net%E5%90%8E%E5%8F%B0%E6%89%A7%E8%A1%8Cjs%E9%80%A0%E6%88%90%E6%A0%B7%E5%BC%8F%E5%A4%B1%E6%95%88.html</url>
    
    <content type="html"><![CDATA[<p>在asp.net中后台执行js时，比如使用Response.Write弹出一个alert</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp">Response.Write(<span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;确定。&#x27;)&lt;/script&gt;&quot;</span>);<br></code></pre></td></tr></table></figure><p>这样做有时候会造成页面的css样式表错位或者失效</p><p>为了避免这样的情况，使用下面的方法</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">this</span>.ClientScript.RegisterStartupScript(<span class="hljs-keyword">this</span>.GetType(), <span class="hljs-string">&quot;alter&quot;</span>, <span class="hljs-string">&quot;alert(&#x27;确定。&#x27;);&quot;</span>, <span class="hljs-literal">true</span>);<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>asp.net</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【花语】-菖蒲</title>
    <link href="/2010/11/13/cloves-changpu.html"/>
    <url>/2010/11/13/cloves-changpu.html</url>
    
    <content type="html"><![CDATA[<h2 id="妖"><a href="#妖" class="headerlink" title="妖"></a>妖</h2><p>菖蒲，相信者的幸福。</p><p>一丛丛的狗尾草无限的延伸。我也不知疲倦的一直走，连疲累的感觉都没有。</p><p>忘记了时间，忘记了回忆。</p><p>就这样。直到我走进了一片蓝紫色的花海。</p><p>又是无边无际的地方，很远的地方，有一个模糊的人影。不知方向的我，便朝向那个模糊的人影走去。</p><p>近了，是一个短发的女孩。耳朵上插着一朵精致的蓝紫色小花，与这片花海相互呼应。</p><p>女子轻轻偏转精致的面孔看向我，嘴角轻浅的笑，只是看着我，却不说话。</p><p>于是我问：我该如何走？</p><p>大人到此不需要歇息一下吗？</p><p>我在世间行走，依然习惯。</p><p>大人，可知菖蒲花语，相信者的幸福？</p><p>嗯，知道，相信着，就会幸福。若去怀疑，那么，徒增痛苦。</p><p>可是大人，如今还相信什么？</p><p>不知道，如今无所谓相信，而是要知道一切。</p><p>大人，下雪了。</p><p>我抬头，确实下雪了，这雪下的突然。</p><p>为何会下雪？我问道。</p><p>那花妖便告诉我，天地间有异动，有不合常理之事发生，五行错乱，才生了这异象。</p><p>我不解的看看她。何为异象?</p><p>大人你可能不记得，大人世间行走已经几千年，那之前因为异象频生，导致整个人间都乱了。</p><p>因为我？</p><p>确是与大人有原因，但也是大人结束了动荡，还了人间一个平静。</p><p>我摇摇头，表示没有任何印象。</p><p>大人，天生异象，妖星当道，大人，您，也应该回复真身了。</p><p>我的真身？</p><p>这不也正是大人一直追寻要知道的吗？</p><p>我点点头。</p><p>大人，相信着，便是幸福的，大人，菖蒲渡您一途。</p><p>只见那女子双手扬起，周围细碎的紫色花瓣聚拢在我身下，御风而起，而我，也跟着塌风而走。</p><p>之后，再没听到那女子说话。</p><p>下一处，我将到什么地方？</p><h2 id="花"><a href="#花" class="headerlink" title="花"></a>花</h2><p>我是修行七百年的花妖，说是修行，确是拜一妖所赐，乌鸦，传说她是三足乌的本相，数千年前为了一个人，留在人间。</p><p>她助我，确也是为了一个人。</p><p>天空中黑羽降下。</p><p>她来了。</p><p>身后传来细碎的声响，想必是翅膀收拢的声音。</p><p>而她却低头不语。</p><p>我继续坐在地上，摘面前的紫色小花在手里编织。</p><p>展翅的声音，翅膀挥动的声音，她走了。</p><p>我抬头，看到天空中，宽大的黑色翅膀，随风而动的长发，原本长及脚踝的黑色长发，不知为何，有白色掺杂其中。</p><p>世间，大乱降至！</p>]]></content>
    
    
    <categories>
      
      <category>狐说八道</category>
      
    </categories>
    
    
    <tags>
      
      <tag>花语</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>被遗忘的运算符(??)</title>
    <link href="/2010/07/20/%E8%A2%AB%E9%81%97%E5%BF%98%E7%9A%84%E8%BF%90%E7%AE%97%E7%AC%A6.html"/>
    <url>/2010/07/20/%E8%A2%AB%E9%81%97%E5%BF%98%E7%9A%84%E8%BF%90%E7%AE%97%E7%AC%A6.html</url>
    
    <content type="html"><![CDATA[<p>今天发看到一个条件判断</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">if</span>( <span class="hljs-keyword">value</span> = ( config ?? <span class="hljs-string">&quot;&quot;</span> ) )<br>    config ?? <span class="hljs-string">&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>等同于</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp">config=<span class="hljs-literal">null</span>?<span class="hljs-string">&quot;&quot;</span>:config;<br></code></pre></td></tr></table></figure><p>意思是如果config为null那么就赋值””否则保持原值不变</p><p>举个例子：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-built_in">int</span>? i;<br><span class="hljs-built_in">int</span> x=i??<span class="hljs-number">5</span>;<span class="hljs-comment">// 如果i值为null那么给x赋值5，否则x值等于i的值</span><br></code></pre></td></tr></table></figure><p>这个运算符只支持引用类型和Nullable类型。</p>]]></content>
    
    
    <categories>
      
      <category>收集</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>【花语】-狗尾巴草</title>
    <link href="/2010/04/26/cloves-gouweiba.html"/>
    <url>/2010/04/26/cloves-gouweiba.html</url>
    
    <content type="html"><![CDATA[<p>狗尾巴草，暗恋。</p><p>我不知道忘川的路。太久了，已经忘记了。所以，我只能一如从前，朝向一个方向，不停的走，不知道要去的地方，也没有停下的理由。</p><p>于是，我走到了这个地方，到处都是齐膝的狗尾草，我察觉了什么。</p><p>是的，每当一个地方只生长一种植物的时候，我就会遇到花妖。</p><p>那么这次，是狗尾花妖？感觉这么叫，嗯，失了文雅呢。可是，什么才是文雅呢。</p><p>我躺下来，看着天空，然后在记忆中摸索，却什么都是模糊的。索性，闭上眼，睡一觉吧。</p><p>梦中依然是残破不堪的片段，无法衔接的记忆，无法衔接到一起的梦。以至于我醒来后几乎不记得梦里的内容。</p><p>我依然在草原中，不同的是，我的身边坐着的人，多了一个人，眼角带媚，却睿智的深邃；唇角微笑，却看得出并不是刻意的笑。眉如柳叶，指如春葱，乌黑的长发散落在周围。</p><p>狐妖！</p><p>“大人睡的可好。”那女子先开了口。我却不知如何回答。狐妖，有正有邪。狐妖，是万妖之中最无法分辨善恶的。</p><p>“大人怕我？”那女子嘻嘻的笑，然后站了起来，我看到她的手环和脚环，碰在一起叮当作响，那声音，不是魅惑的邪音，而是破除魔障的净化之声，这声音，来自仙界。</p><p>于是我问道：“你师傅。。。”</p><p>“六千年前了吧。大人您曾经也认得的。”</p><p>“可我现在什么都不记得了。”</p><p>“师傅明了，所以让我来找您，师傅说您无法找到去忘川的路。”</p><p>“是的，我不知道。”我想，也许是我故意忘了吧。</p><p>“大人可知这附近的花妖。”</p><p>“以往遇到这样的情形，都会遇到花妖，丁香，红豆，而此地，该是狗尾花。”</p><p>“此地却有一花妖，修三百有七十年。”</p><p>“那为何不见我？”</p><p>“大人习惯了与花妖相见？”</p><p>“相见的话，或许可以给我解脱。”</p><p>“大人所指的解脱是？”</p><p>“让我想起我应该去做什么，或者，让我去轮回。”</p><p>这时，四周响起清脆的声音：“大人，小妖名为梦鸢。”</p><p>“梦鸢？”</p><p>“正是，小妖正是狗尾花苦修三百有七十年。小妖法力低微，尚未凝成人形，所以恐无法帮助大人，不过，狐仙姐姐在这里，尚可为大人指出忘川的路。”</p><p>我看着那狐妖“你可以？”</p><p>“尚需梦鸢相助。”</p><p>“梦鸢愿助两位大人一臂之力。”</p><p>那狐妖继续说道：“这梦鸢为狗尾花妖，寓意暗恋，大人忘了曾经的事情，可是大人的事却有些流传了下来。大人来到这里也绝非偶然，冥冥之中自有定数，大人当年获得长生，却也是为了心中的女子，而大人的长生则是灵魂的长生，而非肉身，所以大人如今肉身早在千年前已化为尘，以致灵魂出离，无****回，所以大人忘了所有，只剩下这灵魂对千年前的执念，记忆，便是星星点点。”</p><p>“我都忘记了，我只是一丝游魂。”</p><p>“狗尾草可以带你去下一处花妖修炼的地方，希望，她可以助你。”</p><p>“你们为何不直接带我去忘川？”</p><p>“其实，忘川虽然只有一个，但是每个人的去忘川的路是不一样的，一如人的一生，无有相同。”</p><p>“梦鸢。”</p><p>“是大人，大人您顺着狗尾草的方向一直走，就到了下一处花妖所在，那位姐姐会继续助您。”</p><p>言毕，我周围的狗尾草瞬间朝着一个方向移去，逐渐铺成了一条路，不知道终点。</p><p>那狐妖看路已铺完，便说：“大人，可以上路了。”</p><p>“告辞。”于是，我朝?狗尾草铺成的方向，继续前行。</p><p>狗尾巴草，暗恋。</p><p>暗恋，那个女子。</p><p>花。</p><p>我是拥有六千年修行的狐妖，也行了六千年的善，但却未入仙籍。是仙是妖，又如何呢。远处传来挥翅的声音，大人路过的地方，身后一定跟着乌鸦。</p><p>“小狐，它能否找到忘川。”</p><p>“不知道呢，据传说，它尚有一魄封在忘川河畔。”</p><p>“是的，那一魄中，恰好封着它所有的记忆，当年，它已料到回来的事。那是唯一的方法。”</p><p>“忘川畔，彼岸双生。”</p><p>“大人，您还是去寻它吧，毕竟只有一魂，免得被吞噬。”</p><p>“告辞。”</p>]]></content>
    
    
    <categories>
      
      <category>狐说八道</category>
      
    </categories>
    
    
    <tags>
      
      <tag>花语</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>残篇『十』</title>
    <link href="/2010/04/16/canpian-10.html"/>
    <url>/2010/04/16/canpian-10.html</url>
    
    <content type="html"><![CDATA[<p>记忆中只有一条河</p><p>左岸的花洁白胜雪</p><p>风吹过</p><p>花瓣似羽纷纷扬起</p><p>无暇的美</p><p>而右岸</p><p>遍地火红</p><p>无边无际</p><p>映的天也成了绯色的红</p><p>右岸</p><p>无风</p><p>风吹告诉我</p><p>她说记忆中的景色或许就是三途川</p><p>彼岸的红</p><p>应该就是蔓珠沙华</p><p>是通往地狱的死亡之花</p><p>可左岸</p><p>我当年走过三途川时</p><p>那边我什么也看不到</p><p>只是有微弱的洞箫声断断续续</p><p>辞了风吹</p><p>我决定重回三途去看一看</p><p>记忆中的场景是不是三途川</p><p>轮回道的景色似曾相识</p><p>越向深处越清晰</p><p>往事一幕幕回来</p><p>一千五百年前我助周寻人</p><p>后来为了阻止乌鸦成魔所以让她吃了我的身体</p><p>回归三足乌本相</p><p>而我</p><p>用残余在三途川左岸的一魂与右岸的一魄</p><p>又修了一千三百年</p><p>才重修回肉身</p><p>却没了一身灵力</p><p>也忘了前尘</p><p>所以我会知道三途川两岸的景色</p><p>三途川上依然停着渡人的那叶无底小舟</p><p>三途河里也不再有无法轮回的水鬼</p><p>而都化做两岸的彼岸花</p><p>我想</p><p>我终于知道我的真身是谁了</p><p>只有这样才能解释我身后毛茸茸的尾巴和头上的耳朵</p><p>可我是</p><p>妲姬?</p><p>还是</p><p>与祝融相斗的</p><p>上古赤尾?</p>]]></content>
    
    
    <categories>
      
      <category>狐说八道</category>
      
    </categories>
    
    
    <tags>
      
      <tag>残篇</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>残篇『九』</title>
    <link href="/2010/04/08/canpian-9.html"/>
    <url>/2010/04/08/canpian-9.html</url>
    
    <content type="html"><![CDATA[<p>三途河岸-</p><p>血黄色的河水</p><p>看不出流动</p><p>却是汹涌的</p><p>因为那里尽是不得投胎的孤魂野鬼</p><p>我</p><p>是否也要下去呢</p><p>河岸两边</p><p>彼岸花开成两种颜色</p><p>血色的</p><p>白色的</p><p>不知道别人眼里是什么颜色呢</p><p>那个人说</p><p>红色的</p><p>是魂魄</p><p>白色的</p><p>是回忆</p><p>走不过三途的人</p><p>只有两个选择</p><p>成为河里不得投胎的鬼魂</p><p>或者</p><p>剥离回忆与魂魄</p><p>成为分别开在两岸的曼珠沙华</p><p>看来</p><p>要渡过忘川河</p><p>很难呢</p><p>无边无际的</p><p>听说过这河</p><p>是要付船费的</p><p>可我什么都没有呢</p><p>也许</p><p>要在这河里做个鬼魂</p><p>或者</p><p>做那花叶不同株的曼珠沙华吧</p><p>————————————————————</p><p>把手给我</p><p>你</p><p>可以渡我过河</p><p>沉默</p><p>为何不回答</p><p>还是沉默</p><p>那么</p><p>至少告诉我</p><p>为何是你来摆渡</p><p>明明</p><p>死在你的手里</p><p>当时的你</p><p>已入魔</p><p>我不得不</p><p>那当初为何让我吃掉你的身体得到你的灵力</p><p>不愿看你继续痛苦</p><p>成</p><p>我将成佛</p><p>而你</p><p>亦可回复人身</p><p>败</p><p>我将永守三途</p><p>渡这过往孤魂</p><p>——————————————————–</p><p>将我的魂魄与回忆剥离开吧</p><p>我</p><p>将留在忘川彼岸</p><p>做花叶不同株的</p><p>曼珠沙华</p><p>开一千年</p><p>落一千年</p><p>花叶永不相见</p><p>情不为因果</p><p>缘注定生死</p><p>———————————————————</p><p>佛曰</p><p>梵语波罗蜜</p><p>此云到彼岸</p><p>解义离生灭</p><p>著境生灭起</p><p>如水有波浪</p><p>即名为此岸</p><p>离境无生灭</p><p>如水常流通</p><p>即名为彼岸</p><p>有生有死的境界</p><p>谓之此岸</p><p>超脱生死的境界</p><p>谓之彼岸</p><p>是涅盘的彼岸</p><p>佛说彼岸</p><p>无生无死</p><p>无若无悲</p><p>无欲无求</p><p>是个忘记一切悲苦的及乐世界</p><p>而有种花</p><p>超出三界之外</p><p>不在五行之中</p><p>生于弱水彼岸</p><p>无茎无叶</p><p>绚灿绯红</p><p>佛说那是彼岸花</p>]]></content>
    
    
    <categories>
      
      <category>狐说八道</category>
      
    </categories>
    
    
    <tags>
      
      <tag>残篇</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>残篇『八』</title>
    <link href="/2010/04/02/canpian-8.html"/>
    <url>/2010/04/02/canpian-8.html</url>
    
    <content type="html"><![CDATA[<p>此生，宁负天下不负卿！</p><p>————————</p><p>我，走了。</p><p>去那？</p><p>去该去的地方。</p><p>那里是该去的地方？这里不好么？为什么不留下来？</p><p>呵呵，我有我该做的事的。我，会回来的。</p><p>真的不可以留下来么？</p><p>不，留下来也总是要离开的。我走了。</p><p>—————–</p><p>前面就是三涂了吧。</p><p>我，还是回到这里了。</p><p>—————–</p><p>我找了你这么多年，还是找不到你。</p><p>直到现在，我也上油尽灯枯，在也没有力气找你了。</p><p>以致于，当我回头的时候，都可以看到我自己，躺在那菩提老树之下，与苦涩的嘴角。</p><p>我想，我该去三途了，那里，或许有你的影子。</p><p>——————</p><p>忘川河畔</p><p>奈何桥头</p><p>三生石边</p><p>孟婆站在那里，看着你，说了句</p><p>你终于来了</p><p>上仙知道她在那里是么</p><p>是的，她，已经走过了奈何</p><p>是么</p><p>这一路上，你都见到了什么呢</p><p>生离，死别，无缘，无份，还有那彼岸之花，与，那个在三涂河上渡我的人</p><p>何苦呢，喝了汤就过桥吧</p><p>上仙，容我看下前世吧</p><p>你自便，但是，不喝忘川水煮，你是走不上奈何桥的</p><p>我知道</p><p>还有，那边的望乡台，不在看一眼了么</p><p>谢上仙，不看了，徒增伤心</p><p>———————</p><p>我看到了三生石上我的前世</p><p>原来如此</p><p>我笑了笑，拿起石桌上的忘川水，一饮而尽</p><p>希望，下一世，还是你渡我</p><p>放下石碗，向孟婆见礼，然后走上奈何桥</p><p>记得，下一世，你还要渡我</p>]]></content>
    
    
    <categories>
      
      <category>狐说八道</category>
      
    </categories>
    
    
    <tags>
      
      <tag>残篇</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>残篇『七』</title>
    <link href="/2010/04/02/canpian-7.html"/>
    <url>/2010/04/02/canpian-7.html</url>
    
    <content type="html"><![CDATA[<p>呵呵，我要出嫁了哦。</p><p>…………</p><p>看你那么高兴，我也替你高兴，可是为什么心里却在痛着？我，要走了。</p><p>在你身边这么多年，爱慕你却不敢告诉你，只能这样默默的陪着你。看着你哭就陪你哭，看着你笑就陪你笑。我从来不安慰你，因为我知道，只有自己心里真正释怀才可以不留下伤害。</p><p>那么，我该如何释怀呢？</p><p>你要出嫁了，我就必须离开。喜堂我就不去了，因为我要离开。</p><p>爱上你，不是我的错，可是我要承担这后果，这不能相守的痛，希望下一世，我可以不再需要承受这样的煎熬。明天起，你享受今生的爱吧，我要开始为下一世祈祷了，祈祷下辈子，可以和你真正的厮守，不用在乎世俗，不用在乎其他人。</p><p>…………</p><p>那一抹红艳如此美丽，我却只能在这远远看着。</p><p>一拜天地</p><p>二拜高堂</p><p>夫妻交拜</p><p>……</p><p>刺痛了我的眼，也刺痛了我的心，可我没有恨，有的是在被刺痛了的心里面最忠诚的祝福……</p><p>转身，微笑着离开，不再回头……</p><p>…………</p><p>相公，我好久没看到她了。连我出嫁那天所有人都说在也没见过她。</p><p>娘子，她到底什么样子啊？</p><p>哦，相公，我那有她一张画像。她很漂亮。</p><p>哦？带相公我一看。</p><p>…………</p><p>展开那画卷，如此美丽惊艳……</p><p>…………</p><p>娘子，此人真的如此惊艳！</p><p>是啊，相公，可是她突然就消失了呢。</p><p>娘子，这人，我见过。</p><p>在哪？</p><p>迎你进门那天，门外树下有一惊艳女子，一袭白衣。犹如天仙，在交拜后，她就离开了。</p><p>…………</p><p>走了么。</p><p>是啊。</p><p>我伤了你，我知道你对我的感情。</p><p>只是，我没有勇气啊！没有勇气面对。</p><p>…………</p><p>一失足成千古恨</p><p>再回首已是百年身</p><p>…………</p><p>深山中</p><p>一处入世外桃源般的依山傍水而建的阁楼</p><p>楼前一棵不知几百年的菩提老树</p><p>树下</p><p>盘膝而坐一个如仙般清雅却又惊艳的女子</p><p>双目清晰无一丝尘世的杂陈</p><p>却在颂着：</p><p>观自在菩萨。行深般若波罗密多时。</p><p>照见五蕴皆空。度一切苦厄。舍利子。</p><p>色不异空。空不异色。色即是空。</p><p>空即是色。受想行识。亦复如是。</p><p>舍利子。是诸法空相。</p><p>不生不灭。不垢不净。不增不减。</p><p>是故空中无色。</p><p>无受想行识。</p><p>无眼耳鼻舌身意。</p><p>无色声香味触法。</p><p>无眼界乃至无意识界。</p><p>无无明。亦无无明尽。</p><p>乃至无老死。亦无老死尽。</p><p>无苦集灭道。</p><p>无智亦无得。以无所得故。</p><p>菩提萨?。依般若波罗密多故。</p><p>心无挂碍。无挂碍故。</p><p>无有恐怖。远离颠倒梦想。</p><p>究竟涅?。三世诸佛。</p><p>依般若波罗密多故。</p><p>……</p>]]></content>
    
    
    <categories>
      
      <category>狐说八道</category>
      
    </categories>
    
    
    <tags>
      
      <tag>残篇</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>残篇『六』</title>
    <link href="/2010/03/31/canpian-6.html"/>
    <url>/2010/03/31/canpian-6.html</url>
    
    <content type="html"><![CDATA[<p>我问你可不可以不要走了，我知道我错了，我不敢面对，现在，我有那个勇气了，我可以面对了，而且我等了你这么多年了，看在等待的份上，原谅我好么？不要在离开了好么？算我求你好么？</p><p>可是，为什么你说放手好么？放手，让我走，其实我只是回来看看，既然一切安好我也要走了，放手吧。</p><p>我抱着你不放手，不断重复着不要走不要走！</p><p>你说你放手让我走，你这个样子我走的很辛苦！</p><p>为什么？</p><p>为什么？</p><p>我等了这么多年，终于等到你回来，为什么你的表情好象在承受极大的痛苦？</p><p>猛然间惊醒，发现是在沉睡的梦中。</p><p>也发现，你已经离开好多年。</p><p>也发现，你已经死了好多年。</p><p>那么高的山崖，怎么可能还能生还？</p><p>下面是滔滔江水，为什么你要落个尸骨无存的下场？为了我，值么？那个时候我那样对你，值么？</p><p>…………………………</p><p>她一切都好么？</p><p>回大人，一切安好，就是想你想的很憔悴，她……</p><p>好了，只要一切安好就好，我这副身体，已经无法在给她什么了。</p><p>大人，其实，只要你陪在她身边就好。</p><p>是么？可是她要的很多，我无法给了，而且看到我这个样子，她也许会内疚，也许。但是我不要她不快乐。还是让她以为我已经死了吧，时间久了，总会忘掉我的。</p><p>大人，这样，真的好么？对你来说真的好么？对她，也，真的好么。</p><p>我累了，今天的阳光真好，送我走吧。</p><p>大人，你真的决定了么？</p><p>决定？这是一定的，这样可以减轻我们的罪。</p><p>大人，以后都不见了么？</p><p>不见了，只要这玉陪在我身边就好了。我就记得她了，就永远不会忘了她。这玉，有我们的一切。</p><p>大人，遵命。</p><p>…………………………</p><p>施主，你真的要在此落发？</p><p>大师成全。</p><p>可是，施主的尘缘……</p><p>大师，缘起缘散，都不重要了，尘世中谁又能脱离这缘呢？萍水相逢是缘，朝夕相伴是缘，我与大师亦是缘，皈依，是我与佛的缘。</p><p>罢了。从今日起，你就在我这庙里和我吃斋念佛吧。尘缘，断了又如何，不断有如何呢。</p><p>谢师傅。</p><p>不过，你这身体，还是要留个人照顾你的。</p><p>大师，随我来的人，自然可以照顾我，从此，她亦随我一切，在此出家。</p><p>大人，这玉？</p><p>…………………………</p>]]></content>
    
    
    <categories>
      
      <category>狐说八道</category>
      
    </categories>
    
    
    <tags>
      
      <tag>残篇</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>残篇『五』</title>
    <link href="/2010/03/31/canpian-5.html"/>
    <url>/2010/03/31/canpian-5.html</url>
    
    <content type="html"><![CDATA[<p>你不挽留我了</p><p>那好吧</p><p>我走了</p><p>…………</p><p>真的好么，曾经那么相依相偎的在一起，我真的让她走了，连一句挽留都吝啬，真的是我想要的么，真的不爱了么？我不知道，头好痛，可是这都是别人说的，我什么都不记得了啊，曾经的一点一滴，我都不记得了，说有人都说我失忆了，但很奇怪的独独忘了她，怎么会有这样的失忆？一定是开玩笑的，况且，我对她一点感觉都没有啊，真的爱？我怀疑。<br>可是为什么她的走，还上让我感觉有什么不对的地方，心里开始空落落的，遗失了什么呢？</p><p>…………</p><p>半年了</p><p>我还是什么都想不起来啊。</p><p>…………</p><p>除夕，团圆，为什么你们都不理我？</p><p>我是真的没有想起来啊。</p><p>既然你们都不理我，那好，我不要你们了，我走了。</p><p>然后我真的一个人走了，我也不知道要去那，反正我的心很痛就是了，你们都不理我，为了那个人都不理我了。</p><p>走着走着感觉好累，才想起，一年下来，几乎天天没断过药，那次受伤留下了后遗症啊，今天光生气了，忘记了药。</p><p>好累好累，好想睡，在我倒下去之前我看到了一张脸，一张美伦美奂的脸，那么美。</p><p>然后我睡了，无法在清醒了吧。</p><p>…………</p><p>这是个冗长的梦，梦中我梦见我被人追，好多人好多人，我筋疲力尽的终于倒下，可我看到了一个人，她有着一张美伦美奂的脸，犹如天神的站在我面前，我一下就安心了，有一种感觉，即使就这样和她死在这里也没有关系了。</p><p>最后她受伤了，伤的很重，脸上身上全是血……</p><p>…………</p><p>我记起来了，是她，她为了救我受了伤，伤口中毒了，然后她的脸，她的脸毁了，然后我失忆了，然后我残忍的把她赶走了，她什么也没说，什么也没解释。</p><p>我要找到她，我要找她回来，留在我身边，从前都是她保护我，从现在起，让我来保护她吧。</p><p>可是茫茫人海我要去那里找她，为其他人，他们只说她把我送回来后就消失了，我问他们她为什么回来，他们告诉我，你忘了，是为了给你送东西，今年是最后一年了，却发现你昏倒在路边，就把你送回来了，留下东西就消失了。消失，你说消失而不是走了？是啊，谁也没看到她是怎么走的，只是在我们回头看你的刹那就不见了。之后在也没与人见过她。那她的脸，带着面具。那她……别问了，她已经不是从前的她了，在也看不到她的笑，在也看不到她的一切，面具黑披风。她留下一件给你的东西。</p><p>找到那个盒子，打开，我的泪止不住，你真的离我而去了。</p><p>那盒子里是我给她的信物，信物在人在，信物不在了，人也在也找不到了。</p><p>…………</p><p>我找寻了多少年了，韶光易老，可是你在那里，我怕是在也坚持不到找到你了，见我一面不好么？你恨我了么？</p><p>我大限将至，我将带着这份遗憾走了。见我一面好么？</p>]]></content>
    
    
    <categories>
      
      <category>狐说八道</category>
      
    </categories>
    
    
    <tags>
      
      <tag>残篇</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>残篇『四』</title>
    <link href="/2010/03/30/canpian-4.html"/>
    <url>/2010/03/30/canpian-4.html</url>
    
    <content type="html"><![CDATA[<p>不要拒绝我</p><p>让我抱一下</p><p>一下就好</p><p>然后我就可以走了</p><p>不会在见你了</p><p>所以请不要拒绝</p><p>算是我最后的一点小小的要求好吗</p><p>…………………………………………</p><p>真的走了</p><p>那么决绝的走了</p><p>似乎没有一点留恋似的</p><p>真的就这么走了</p><p>即使回头看我一眼也好</p><p>其实我心里还是不希望你走了</p><p>我只是想让你哄哄我</p><p>只是想让你更宠我</p><p>可你真的走了</p><p>你走了</p><p>在不会有人在我伤心的时候做好吃的东西哄我了</p><p>在不会有人在我生气的时候任我打骂之后还将我抱在怀中让我感受温暖了</p><p>在不会有人在我睡不着的时候给我唱歌哄我入睡了</p><p>在不会有人在我梦中惊醒后揽我入怀轻声细语的说不要怕有我在我会一直保护你的</p><p>你骗我</p><p>你走了</p><p>这些你都做不到了</p><p>我其实并不想说“我们缘分尽了，你走吧，履行你当初的诺言去吧”</p><p>我后悔了</p><p>……………………………………………………………………</p><p>你知道我多想回头看你一眼</p><p>可是我不敢</p><p>我怕你见到我眼角的泪</p><p>我怕我回头后在也无法这样走开</p><p>当初的承诺</p><p>我说“如果那天你不喜欢我了，那么我就离开，只要你说一句让我履行诺言，我就走，不会在出现在你面前”</p><p>今天</p><p>果然这一天到来了</p><p>针刺般的心痛</p><p>好像被撕碎一样的痛</p><p>让我快无法呼吸了</p><p>可我却无法留下来</p><p>为了我的诺言</p><p>为了你</p><p>我走了</p><p>在也不会回来了</p><p>我会找一个安静的地方</p><p>从此</p><p>生活在那里</p><p>想念我们曾在一起的一点一滴</p><p>直到老去</p><p>……………………………………………………<br>……………………………………………………</p><p>我看到了</p><p>那棵高大的梧桐树下你盘膝而坐</p><p>那么安详宁静</p><p>却没有一丝生的气息</p><p>我走过去</p><p>发现你的嘴角擎着笑意</p><p>如此温暖</p><p>可是为什么</p><p>无论我如何叫你唤你你都没有一丝一毫的反应</p><p>是对我的惩罚</p><p>还是我永远的失去你了</p><p>你看看我</p><p>睁开眼睛看看我</p><p>我来找你了</p><p>我来向你认错</p><p>我来告诉你我不能没有你</p><p>我的生活不能没有你</p><p>我的整个世界都不能没有你啊</p><p>你醒醒醒醒啊</p><p>不要不理我</p><p>难道我现在哭成这个样子你有不哄我了么</p><p>你看我的眼睛</p><p>早已成灰色</p><p>这么多年</p><p>它都快看不清东西了</p><p>你还是不回来么</p><p>你在不回来我永远到看不到你了</p><p>回来啊</p><p>……………………………………………………</p><p>已经过了多少年了</p><p>忘记了</p><p>只记得我一遍一遍的回忆我们在一起的一点一滴</p><p>然后我觉得至少我还是幸福的</p><p>因为我还有回忆</p><p>然后我笑了</p><p>我知道</p><p>那是一种很幸福的笑</p><p>然后继续回忆</p><p>我知道</p><p>她来了</p><p>是她来找我来了</p><p>我好高兴</p><p>可是</p><p>我却在也不能动了</p><p>在也不能看她一眼了</p><p>在也不能宠她了</p><p>在也不能哄她了</p><p>在也不能在她身边了</p><p>我</p><p>走了</p><p>这次是真的走了</p><p>这个世界上只剩下我的身体</p><p>在也没有意识的身体了</p><p>这个世界在也没有我的存在了</p><p>…………</p>]]></content>
    
    
    <categories>
      
      <category>狐说八道</category>
      
    </categories>
    
    
    <tags>
      
      <tag>残篇</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>残篇『三』</title>
    <link href="/2010/03/30/canpian-3.html"/>
    <url>/2010/03/30/canpian-3.html</url>
    
    <content type="html"><![CDATA[<p>她一直重复着说不要哭不要哭，我离开就是了，我在也不惹你生气了。不要哭了，我这就走了，你继续拜堂成亲，好了好了。</p><p>然后她就转身走了，走到门口，回眸，一笑，释然的笑。好像给人的感觉是，绝望？放弃？</p><p>人们都看到了，她离开的方向是，忘川奈河！</p><p>这样的成亲，被她搅了这一下，似乎谁都不把心思放在这婚礼上了，人们互相看了看，然后齐齐的喊了声“糟了，不好！！她去了忘川奈河！”</p><p>然后所有人都疯了一样的朝向她离去的方向飞奔，妄想在她喝下那位婆婆的茶之前将她追回来。可是，一心想忘却的人，真的追的回来么。</p><p>那新娘突然生出一种感觉！感觉失去了什么在也找不回来的感觉，可以给她带来这种感觉的人只有一个，就是刚刚搅她拜堂，抱着她说爱她无法放开她的那个人，可是她后来走了，说她离开不回来了。为什么感觉欠了她什么？</p><p>她不要这样了，掀了盖头，不顾一切的也朝着那个方向追去。</p><p>……</p><p>忘川的对岸开着洁白的花，有时能看到花，但有花的时候绝不会有叶子，有叶子的时候绝没有花，那，也许就是彼岸花了吧，其实这只是我眼中的彼岸花，其实那花，每个人看到的颜色样子都是不同的，每一次看到的样子也是不同的，但是，那花始终不会花叶同在。为什么？</p><p>“婆婆”</p><p>“你终于还是来了”</p><p>“是啊，我来了，当初你说我终是会来找你的，原想，是在我那大去之期的，却不想是现在这种情况下”</p><p>“你，当真要放下么”</p><p>“不放又如何”</p><p>“哎”</p><p>“婆婆，茶好了么？也许忘却才是最好的吧”</p><p>“好了，你真的决定了么”</p><p>端起那杯看似滚烫其实冰冷的茶，一口饮尽，没有一丝味道。</p><p>没有一点感觉。</p><p>然后，将茶杯轻轻放到身边的几上，轻扬唇角，回头最后一眼看下刺目的阳光。</p><p>当人们都感到的时候，只看到了这一幕，她说“我是个容易绝望和放弃的人，她放手了，我就不会在去争取了”</p><p>她说“也许我忘却了才是最好的”</p><p>那个一身红衣喜服的女子赶到的时候只听到这句话，当她不顾一切的冲到她的身边的时候，她知道，一切都晚了，她欠她的，永远也还不清了。</p><p>笑，渐渐凝固在脸上，她想在抬手摸摸她的脸，却感觉眼睛沉重的没有一丝力气，她只能强撑着说“要……幸福，带着我的那一份……”</p><p>……</p><p>也许，千年，只在一瞬间。也许，爱恋，只在一念间……</p>]]></content>
    
    
    <categories>
      
      <category>狐说八道</category>
      
    </categories>
    
    
    <tags>
      
      <tag>残篇</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>残篇『二』</title>
    <link href="/2010/03/30/canpian-2.html"/>
    <url>/2010/03/30/canpian-2.html</url>
    
    <content type="html"><![CDATA[<p>我倚在树干上，疲累的没了知觉，我不知道我还能坚持多久，或许下一秒我就要灰飞烟灭了。</p><p>我苦笑。</p><p>只能苦笑。</p><p>生命中最后的一瞬时，竟连她最后的一面都见不到。</p><p>树上的花又落了，很美啊，美的眩目，为什么我看不到那花瓣背后的太阳，那刺目的光芒，让我想流泪。</p><p>生死由命，许是真的大限将至了吧，我却觉得我突然间释怀了呢。</p><p>太阳，太阳背后有什么呢？是不是在那背后就是幸福呢，不会有生离，也不会有死别，更不会有痛彻心扉的无奈。</p><p>十年生死两茫茫，自难忘，不思量……</p><p>是惩罚么？</p><p>我不过是想见她而已，又不是犯了什么天大的罪孽，老天你何苦这样给我惩罚？</p><p>这许多年，我只是想在她旁边看着她而已。</p><p>大人，我，走了，再也不会回来了。</p><p>……</p><p>狐，原谅我，原谅我不能陪在你身边。</p>]]></content>
    
    
    <categories>
      
      <category>狐说八道</category>
      
    </categories>
    
    
    <tags>
      
      <tag>残篇</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【花语】-红豆</title>
    <link href="/2010/03/28/cloves-hongdou.html"/>
    <url>/2010/03/28/cloves-hongdou.html</url>
    
    <content type="html"><![CDATA[<p>红豆，相思。</p><p>醒来，已是早晨，不知道昨天走了多久，只记得，丁香，到处都是丁香，每一片花瓣上，都有一小块记忆，却不连贯。但是，心里，却痛苦的无以复加，所以，我是逃开的，开始我可以很镇定的走，然后，我开始奔跑。</p><p>身上沾了露水，凉凉的。</p><p>丁香，那个花妖。</p><p>我是长生的。所以我是痛苦的，因为我无法记得所有的事情，那是，锥心刺骨的痛苦。</p><p>起身，朝着前方，不知名的地方，继续走。</p><p>我不知道我的长生有什么意义，我只记得，我一直这样，一直走一直走，走了很久了。</p><p>“请留步。”</p><p>软软的声音，却不知道人在那，我环顾四周，没有发现有人。</p><p>“大人，丁香可好？”</p><p>我一震！丁香，那个回忆的花妖。</p><p>我的前方，闪起一缕红色的光辉，然后光辉中站起一个美丽的女子，红色眼眸，及腰黑丝。头上，红豆攒成的发卡，耳上，精致的红豆耳饰。</p><p>“红豆”</p><p>“相思红豆”那女子这样说到。</p><p>“那么，你也是花妖。”</p><p>那女子掩面轻笑“大人，吾已列仙班”</p><p>“那么，是花仙”</p><p>“仙又如何，妖又如何”</p><p>“上仙喊住我，有何事？”</p><p>“问大人，那丁香，现今如何？”</p><p>“调皮的女子”</p><p>我苦笑着说，如何，我不知道呢，那女子让我看到了什么，让我心痛，我，只想着如何逃脱了。</p><p>“红豆是相思的，丁香是回忆的，如果丁香冒犯了大人，红豆在此替丁香给大人道歉，望大人海涵”</p><p>“不怪”</p><p>“大人可知忘川三途？”</p><p>“相传有一条路叫黄泉路.有一条河叫忘川.河上有一座桥叫奈何桥.走过奈何桥有一个土台叫望乡台.望乡台边有个老妇人在卖孟婆汤.忘川边有一块石头叫三生石.孟婆汤让你忘了一切.三生石记载着你的前世今生.我们走过奈何桥.在望乡台上看最后一眼人间.喝杯忘川水煮.”今生有缘无份”又何必强求？ ”</p><p>“上仙何意？”</p><p>“大人莫怪，小仙想说，大人，既然累心的无法拼凑出完整的回忆，那么，何不去见见望乡石旁那位老妇人？”</p><p>“是啊，忘记了，都忘记了呢。”</p><p>“大人可还记得，行走世间是为了什么？”</p><p>“不记得了。流逝了千年，已然忘却。”</p><p>“既已忘却，何必在寻？”</p><p>我笑笑，不知如何与这花仙继续。转身走开，我，也许是应该去忘川了。</p><p>相思，何处寻？</p><p>花。</p><p>那位大人，可否放下呢？一个人在世间行走千年，由印刻心底，然后逐渐忘却，然后，一切都破碎掉。</p><p>却因为残存的碎片无法忘却。</p><p>殊不知，生命是循环往复的。你固执的不肯去忘川而行走世间，却不知，那个人，已在你身边擦身而过了几千年，因为你只记得曾经的那个她而忽略了重新走到你身边的那个人，还是她。</p><p>身后有翅膀收拢的声音，乌鸦吗？</p><p>“大人”</p><p>“去忘川了吗？”</p><p>“是呢，大人呢？也去吗？”</p><p>“不”</p><p>清浅的微笑“大人，为何也放不开呢？”</p><p>“吾有何放不开？”</p><p>“大人自知。”</p><p>展翅，飞向天空，那黑色的羽翼，和长及脚裸的黑发。犹如她的心一样落寞。</p>]]></content>
    
    
    <categories>
      
      <category>狐说八道</category>
      
    </categories>
    
    
    <tags>
      
      <tag>花语</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>残篇『一』</title>
    <link href="/2010/03/20/canpian-1.html"/>
    <url>/2010/03/20/canpian-1.html</url>
    
    <content type="html"><![CDATA[<p>穿着那一身红衣，那样的美艳不可芳物。从早上她离开等到现在，星星都挤满了深邃的天空，为什么你依然没有回来。</p><p>我这身红衣还穿给谁看？</p><p>观星空，数着星星。</p><p>一颗；</p><p>二颗；</p><p>三颗；</p><p>四颗；</p><p>五颗；</p><p>六颗；</p><p>七颗；</p><p>八颗；</p><p>九颗；</p><p>十颗；</p><p>……</p><p>一万七千八百九十五；</p><p>一万七千八百九十六；</p><p>……</p><p>三万九千一百一十一；</p><p>……</p><p>“别数了，启明星都现了，别数了！”</p><p>“不要在数了，不要！”哭了，为了那个数着星星等待的人。</p><p>可依然阻止不了那让人看了都心碎的行为。</p><p>哐啷一声，所有人都愣住，那个，数星星的人一直等待的人，回来了。</p><p>刺骨的剑掉在地上。</p><p>“我回来了”</p><p>“是我，我回来了。”</p><p>轻轻偏过头，身子在也站立不住，颓然倒下，似乎已经不带一丝的眷恋一样。</p><p>“不，不要”</p><p>冲过去抱起那个身子，绵软无力的身体，逐渐冷了下去，在也没有一丝温度，可嘴角依然带着笑，幸福的笑。</p><p>……</p><p>终于还是没能嫁给你，是天意，还是被捉弄。</p><p>为什么我什么都感觉不到了，只听到一个声音不停的叫着我的名字，对那个声音我是那样的眷恋，可我实在是在也没有力气睁开眼睛看一眼那个人，那个让我眷恋一生的人……</p>]]></content>
    
    
    <categories>
      
      <category>狐说八道</category>
      
    </categories>
    
    
    <tags>
      
      <tag>残篇</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【花语】-丁香</title>
    <link href="/2010/02/05/cloves-dingxiang.html"/>
    <url>/2010/02/05/cloves-dingxiang.html</url>
    
    <content type="html"><![CDATA[<p>丁香，回忆；</p><p>我起身，望着头上满树盛放的丁香花。感觉很熟悉，却想不起什么，我知道，我所拥有的。只是残缺不全的记忆。</p><p>在尘世游荡，已经忘记了计算年份，一世，轮回，麻木的看着世间百态，本可以离开的，却因为眷恋着什么不肯走，看到丁香，想起，似乎有一份回忆，不知多久，模糊不清，只是感觉，似乎也有同样的花，也有同样的晴空，模糊的记忆中还有一双温暖的手。</p><p>“没了那双紧握的手，我会迷失方向，找不到我应该去那里，那个人的气息，那个人手心的温暖”。</p><p>“你要去哪？”</p><p>杂乱的思考被打断，我回头。发现树下站着一个美丽的女子。华发紫眸，眉清目秀。</p><p>“姑娘认得我？”</p><p>“自然知道，游荡尘世之人。”女子脸上现出淡淡的忧伤“所有的花神花妖都知道你，还有与你一起的人，或者其他的什么。”</p><p>我走向她，想从她的眼神中看到什么，却只看到深邃的紫眸，那种深邃直透内心，让我突然想起很久很久以前的事情，一瞬间心痛！如针刺一般，一瞬间，流水模糊眼眶。</p><p>“你说过，眼是人的灵，透过眼睛，可以看到一个人的所有，我是花妖，丁香花妖，透过我的眼睛，却可以看到你的回忆，你深藏在心底无法忘却却有不敢触碰的回忆。”</p><p>丁香花，回忆，内心深处，无法忘却又不敢触碰的回忆。</p><p>“我游荡尘世已经不知道多少年了”</p><p>“你是长生的,却是痛苦的。”</p><p>“你问我去那？”</p><p>“这个世界上，每一种花代表一种语言，你能遇到多少种？今后你还会遇到更多的花。我不知道我为什么叫住你，也许，是因为那个女子。是她告诉我，你是孤独的，流转于世间，不得解脱。”</p><p>“女子？她们，还好吧。”</p><p>“你知道，与你相同，得了长生，并不一定幸福。”</p><p>我转身，朝向一个方向走，我是游荡的人，所以不会停留在一个地方，丁香花妖，回忆的妖。</p><p>眼前遍开的丁香，簌簌纷飞的花瓣，犹如破碎的记忆，虽然无法抓在手里，但却从眼前不断的划过。偏头，依然看到不远的地方，落下那碎片，触手可及，却无法去抓在手里，那是心底的痛，无法拼凑。却不凋零。</p><p>无法回头，因为后面是那只让我陷入回忆的妖，前方，是纷飞的丁香，记忆的碎片，我，也许可以走出记忆的碎片，但我知道我是无法走出深邃的记忆。</p><p>踏着一地丁香，走出破碎的记忆。</p><p>花</p><p>那个人走了，在从我的眼睛里看到他内心深处不敢碰触却无法忘却的记忆之后走了。</p><p>孤独，落寞。</p><p>一个人得了长生，却不一定幸福，无尽的岁月会将他的记忆逐渐撕裂成碎片。</p><p>他会记得很多事，但是时间久了，会变得残缺不全。无法拼凑在一起，那是一种痛苦。因为有着无限的回忆，却没有完整的回忆。而那些完整的回忆，却不敢触碰，一碰到，泪流满面，锥心刺骨。</p><p>所以，他不断的行走，忘了时间忘了方向忘了岁月忘了自己为什么行走。</p><p>天上掉下一根黑羽，乌鸦来了。乌鸦，与他一样，长生的，孤独的。</p><p>收拢黑色的翅膀，站在我身后。</p><p>许久。</p><p>“他走了？”</p><p>“我是回忆的花妖，我将他残缺的记忆补全。他看到了自己内心深处的记忆，带着眼泪，离开。”</p><p>“自己折磨自己”</p><p>“你又何尝不是”</p><p>“丁香，别让我看到我的记忆”</p><p>“那就不要看我的眼睛”</p><p>“丁香，后会有期”</p><p>“这就走了？”</p><p>“我也是游荡的”</p><p>展开黑色的翅膀，飞向天际。</p><p>回忆，长留心底。</p>]]></content>
    
    
    <categories>
      
      <category>狐说八道</category>
      
    </categories>
    
    
    <tags>
      
      <tag>花语</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
